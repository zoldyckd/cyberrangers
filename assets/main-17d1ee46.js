class pe{constructor(t){this.properties=t??[]}get(t){const o=this.properties.filter(n=>n.name===t).map(n=>n.value);if(o.length>1)throw new Error('Expected only one property to be named "'+t+'"');if(o.length!==0)return o[0]}getString(t){return this.getByType(t,"string")}getNumber(t){return this.getByType(t,"number")}getBoolean(t){return this.getByType(t,"boolean")}getByType(t,o){const n=this.get(t);if(n!==void 0){if(o!=="json"&&typeof n!==o)throw new Error('Expected property "'+t+'" to have type "'+o+'"');return n}}mustGetString(t){return this.mustGetByType(t,"string")}mustGetNumber(t){return this.mustGetByType(t,"number")}mustGetBoolean(t){return this.mustGetByType(t,"boolean")}mustGetByType(t,o){const n=this.get(t);if(n===void 0)throw new Error('Property "'+t+'" is missing');if(o!=="json"&&typeof n!==o)throw new Error('Expected property "'+t+'" to have type "'+o+'"');return n}getType(t){const o=this.properties.filter(n=>n.name===t).map(n=>n.type);if(o.length>1)throw new Error('Expected only one property to be named "'+t+'"');if(o.length!==0)return o[0]}}const jt="https://unpkg.com/@workadventure/scripting-api-extra@1.9.10/dist";class Kt{constructor(t){this.name=t.name,this.x=t.x,this.y=t.y,this.properties=new pe(t.properties)}get isReadable(){const t=this.properties.getString("readableBy");return t?WA.player.tags.includes(t):!0}get isWritable(){const t=this.properties.getString("writableBy");return t?WA.player.tags.includes(t):!0}}function ut(e){const t=e?"#"+e.join():"";WA.nav.openCoWebSite(jt+"/configuration.html"+t,!0)}async function Xt(e,t){const o=await WA.room.getTiledMap(),n=new Map;return Dt(o.layers,n,e,t),n}function Dt(e,t,o,n){for(const r of e)if(r.type==="objectgroup"){for(const s of r.objects)if(s.type==="variable"||s.class==="variable"){if(o&&r.name!==o||n&&!n.includes(s.name))continue;t.set(s.name,new Kt(s))}}else r.type==="group"&&Dt(r.layers,t,o,n)}let Ee;async function Ae(){return Ee===void 0&&(Ee=Jt()),Ee}async function Jt(){return Zt(await WA.room.getTiledMap())}function Zt(e){const t=new Map;return Ft(e.layers,"",t),t}function Ft(e,t,o){for(const n of e)n.type==="group"?Ft(n.layers,t+n.name+"/",o):(n.name=t+n.name,o.set(n.name,n))}async function Ut(){const e=await Ae(),t=[];for(const o of e.values())if(o.type==="objectgroup")for(const n of o.objects)(n.type==="area"||n.class==="area")&&t.push(n);return t}function eo(e){let t=1/0,o=1/0,n=0,r=0;const s=e.data;if(typeof s=="string")throw new Error("Unsupported tile layer data stored as string instead of CSV");for(let a=0;a<e.height;a++)for(let i=0;i<e.width;i++)s[i+a*e.width]!==0&&(t=Math.min(t,i),r=Math.max(r,i),o=Math.min(o,a),n=Math.max(n,a));return{top:o,left:t,right:r+1,bottom:n+1}}function Yt(e){let t=1/0,o=1/0,n=0,r=0;for(const s of e){const a=eo(s);a.left<t&&(t=a.left),a.top<o&&(o=a.top),a.right>r&&(r=a.right),a.bottom>n&&(n=a.bottom)}return{top:o,left:t,right:r,bottom:n}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var to=Object.prototype.toString,he=Array.isArray||function(t){return to.call(t)==="[object Array]"};function at(e){return typeof e=="function"}function oo(e){return he(e)?"array":typeof e}function _e(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function pt(e,t){return e!=null&&typeof e=="object"&&t in e}function no(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var ro=RegExp.prototype.test;function so(e,t){return ro.call(e,t)}var ao=/\S/;function io(e){return!so(ao,e)}var co={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function lo(e){return String(e).replace(/[&<>"'`=\/]/g,function(o){return co[o]})}var uo=/\s*/,po=/\s+/,ft=/\s*=/,fo=/\s*\}/,ho=/#|\^|\/|>|\{|&|=|!/;function yo(e,t){if(!e)return[];var o=!1,n=[],r=[],s=[],a=!1,i=!1,c="",u=0;function f(){if(a&&!i)for(;s.length;)delete r[s.pop()];else s=[];a=!1,i=!1}var h,W,We;function de(P){if(typeof P=="string"&&(P=P.split(po,2)),!he(P)||P.length!==2)throw new Error("Invalid tags: "+P);h=new RegExp(_e(P[0])+"\\s*"),W=new RegExp("\\s*"+_e(P[1])),We=new RegExp("\\s*"+_e("}"+P[1]))}de(t||y.tags);for(var p=new we(e),v,l,g,ye,ve,S;!p.eos();){if(v=p.pos,g=p.scanUntil(h),g)for(var Ce=0,Qt=g.length;Ce<Qt;++Ce)ye=g.charAt(Ce),io(ye)?(s.push(r.length),c+=ye):(i=!0,o=!0,c+=" "),r.push(["text",ye,v,v+1]),v+=1,ye===`
`&&(f(),c="",u=0,o=!1);if(!p.scan(h))break;if(a=!0,l=p.scan(ho)||"name",p.scan(uo),l==="="?(g=p.scanUntil(ft),p.scan(ft),p.scanUntil(W)):l==="{"?(g=p.scanUntil(We),p.scan(fo),p.scanUntil(W),l="&"):g=p.scanUntil(W),!p.scan(W))throw new Error("Unclosed tag at "+p.pos);if(l==">"?ve=[l,g,v,p.pos,c,u,o]:ve=[l,g,v,p.pos],u++,r.push(ve),l==="#"||l==="^")n.push(ve);else if(l==="/"){if(S=n.pop(),!S)throw new Error('Unopened section "'+g+'" at '+v);if(S[1]!==g)throw new Error('Unclosed section "'+S[1]+'" at '+v)}else l==="name"||l==="{"||l==="&"?i=!0:l==="="&&de(g)}if(f(),S=n.pop(),S)throw new Error('Unclosed section "'+S[1]+'" at '+p.pos);return mo(go(r))}function go(e){for(var t=[],o,n,r=0,s=e.length;r<s;++r)o=e[r],o&&(o[0]==="text"&&n&&n[0]==="text"?(n[1]+=o[1],n[3]=o[3]):(t.push(o),n=o));return t}function mo(e){for(var t=[],o=t,n=[],r,s,a=0,i=e.length;a<i;++a)switch(r=e[a],r[0]){case"#":case"^":o.push(r),n.push(r),o=r[4]=[];break;case"/":s=n.pop(),s[5]=r[2],o=n.length>0?n[n.length-1][4]:t;break;default:o.push(r)}return t}function we(e){this.string=e,this.tail=e,this.pos=0}we.prototype.eos=function(){return this.tail===""};we.prototype.scan=function(t){var o=this.tail.match(t);if(!o||o.index!==0)return"";var n=o[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n};we.prototype.scanUntil=function(t){var o=this.tail.search(t),n;switch(o){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,o),this.tail=this.tail.substring(o)}return this.pos+=n.length,n};function fe(e,t){this.view=e,this.cache={".":this.view},this.parent=t}fe.prototype.push=function(t){return new fe(t,this)};fe.prototype.lookup=function(t){var o=this.cache,n;if(o.hasOwnProperty(t))n=o[t];else{for(var r=this,s,a,i,c=!1;r;){if(t.indexOf(".")>0)for(s=r.view,a=t.split("."),i=0;s!=null&&i<a.length;)i===a.length-1&&(c=pt(s,a[i])||no(s,a[i])),s=s[a[i++]];else s=r.view[t],c=pt(r.view,t);if(c){n=s;break}r=r.parent}o[t]=n}return at(n)&&(n=n.call(this.view)),n};function d(){this.templateCache={_cache:{},set:function(t,o){this._cache[t]=o},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}d.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};d.prototype.parse=function(t,o){var n=this.templateCache,r=t+":"+(o||y.tags).join(":"),s=typeof n<"u",a=s?n.get(r):void 0;return a==null&&(a=yo(t,o),s&&n.set(r,a)),a};d.prototype.render=function(t,o,n,r){var s=this.getConfigTags(r),a=this.parse(t,s),i=o instanceof fe?o:new fe(o,void 0);return this.renderTokens(a,i,n,t,r)};d.prototype.renderTokens=function(t,o,n,r,s){for(var a="",i,c,u,f=0,h=t.length;f<h;++f)u=void 0,i=t[f],c=i[0],c==="#"?u=this.renderSection(i,o,n,r,s):c==="^"?u=this.renderInverted(i,o,n,r,s):c===">"?u=this.renderPartial(i,o,n,s):c==="&"?u=this.unescapedValue(i,o):c==="name"?u=this.escapedValue(i,o,s):c==="text"&&(u=this.rawValue(i)),u!==void 0&&(a+=u);return a};d.prototype.renderSection=function(t,o,n,r,s){var a=this,i="",c=o.lookup(t[1]);function u(W){return a.render(W,o,n,s)}if(c){if(he(c))for(var f=0,h=c.length;f<h;++f)i+=this.renderTokens(t[4],o.push(c[f]),n,r,s);else if(typeof c=="object"||typeof c=="string"||typeof c=="number")i+=this.renderTokens(t[4],o.push(c),n,r,s);else if(at(c)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");c=c.call(o.view,r.slice(t[3],t[5]),u),c!=null&&(i+=c)}else i+=this.renderTokens(t[4],o,n,r,s);return i}};d.prototype.renderInverted=function(t,o,n,r,s){var a=o.lookup(t[1]);if(!a||he(a)&&a.length===0)return this.renderTokens(t[4],o,n,r,s)};d.prototype.indentPartial=function(t,o,n){for(var r=o.replace(/[^ \t]/g,""),s=t.split(`
`),a=0;a<s.length;a++)s[a].length&&(a>0||!n)&&(s[a]=r+s[a]);return s.join(`
`)};d.prototype.renderPartial=function(t,o,n,r){if(n){var s=this.getConfigTags(r),a=at(n)?n(t[1]):n[t[1]];if(a!=null){var i=t[6],c=t[5],u=t[4],f=a;c==0&&u&&(f=this.indentPartial(a,u,i));var h=this.parse(f,s);return this.renderTokens(h,o,n,f,r)}}};d.prototype.unescapedValue=function(t,o){var n=o.lookup(t[1]);if(n!=null)return n};d.prototype.escapedValue=function(t,o,n){var r=this.getConfigEscape(n)||y.escape,s=o.lookup(t[1]);if(s!=null)return typeof s=="number"&&r===y.escape?String(s):r(s)};d.prototype.rawValue=function(t){return t[1]};d.prototype.getConfigTags=function(t){return he(t)?t:t&&typeof t=="object"?t.tags:void 0};d.prototype.getConfigEscape=function(t){if(t&&typeof t=="object"&&!he(t))return t.escape};var y={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){be.templateCache=e},get templateCache(){return be.templateCache}},be=new d;y.clearCache=function(){return be.clearCache()};y.parse=function(t,o){return be.parse(t,o)};y.render=function(t,o,n,r){if(typeof t!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+oo(t)+'" was given as the first argument for mustache#render(template, view, partials)');return be.render(t,o,n,r)};y.escape=lo;y.Scanner=we;y.Context=fe;y.Writer=d;class Ht{constructor(t,o){this.template=t,this.state=o,this.ast=y.parse(t)}getValue(){return this.value===void 0&&(this.value=y.render(this.template,this.state)),this.value}onChange(t){const o=[];for(const n of this.getUsedVariables().values())o.push(this.state.onVariableChange(n).subscribe(()=>{const r=y.render(this.template,this.state);r!==this.value&&(this.value=r,t(this.value))}));return{unsubscribe:()=>{for(const n of o)n.unsubscribe()}}}isPureString(){return this.ast.length===0||this.ast.length===1&&this.ast[0][0]==="text"}getUsedVariables(){const t=new Set;return this.recursiveGetUsedVariables(this.ast,t),t}recursiveGetUsedVariables(t,o){for(const n of t){const r=n[0],s=n[1],a=n[4];["name","&","#","^"].includes(r)&&o.add(s),a!==void 0&&typeof a!="string"&&this.recursiveGetUsedVariables(a,o)}}}async function bo(){var e;const t=await Ut();for(const o of t){const n=(e=o.properties)!==null&&e!==void 0?e:[];for(const r of n){if(r.type==="int"||r.type==="bool"||r.type==="object"||typeof r.value!="string")continue;const s=new Ht(r.value,WA.state);if(s.isPureString())continue;const a=s.getValue();await ht(o.name,r.name,a),s.onChange(async i=>{await ht(o.name,r.name,i)})}}}async function Ao(){var e;const t=await Ae();for(const[o,n]of t.entries())if(n.type!=="objectgroup"){const r=(e=n.properties)!==null&&e!==void 0?e:[];for(const s of r){if(s.type==="int"||s.type==="bool"||s.type==="object"||typeof s.value!="string")continue;const a=new Ht(s.value,WA.state);if(a.isPureString())continue;const i=a.getValue();dt(o,s.name,i),a.onChange(c=>{dt(o,s.name,c)})}}}async function ht(e,t,o){console.log(e),(await WA.room.area.get(e)).setProperty(t,o)}function dt(e,t,o){WA.room.setProperty(e,t,o),t==="visible"&&(o?WA.room.showLayer(e):WA.room.hideLayer(e))}const wo="https://admin.workadventu.re/html";let Oe,it=0,ct=0;function yt(e){if(WA.state[e.name]){let t=e.properties.mustGetString("openLayer");for(const o of t.split(`
`))WA.room.showLayer(o);t=e.properties.mustGetString("closeLayer");for(const o of t.split(`
`))WA.room.hideLayer(o)}else{let t=e.properties.mustGetString("openLayer");for(const o of t.split(`
`))WA.room.hideLayer(o);t=e.properties.mustGetString("closeLayer");for(const o of t.split(`
`))WA.room.showLayer(o)}}function Wo(e){const t=e.properties.getString("openSound"),o=e.properties.getNumber("soundRadius");let n=1;if(o){const r=$t(e.properties.mustGetString("openLayer").split(`
`));if(r>o)return;n=1-r/o}t&&WA.sound.loadSound(t).play({volume:n})}function vo(e){const t=e.properties.getString("closeSound"),o=e.properties.getNumber("soundRadius");let n=1;if(o){const r=$t(e.properties.mustGetString("closeLayer").split(`
`));if(r>o)return;n=1-r/o}t&&WA.sound.loadSound(t).play({volume:n})}function Vt(e){return e.map(t=>Oe.get(t)).filter(t=>(t==null?void 0:t.type)==="tilelayer")}function $t(e){const t=Vt(e),o=Yt(t),n=((o.right-o.left)/2+o.left)*32,r=((o.bottom-o.top)/2+o.top)*32;return Math.sqrt(Math.pow(it-n,2)+Math.pow(ct-r,2))}function Po(e){WA.state.onVariableChange(e.name).subscribe(()=>{WA.state[e.name]?Wo(e):vo(e),yt(e)}),yt(e)}function gt(e,t,o,n){const r=e.name;let s,a,i=!1;const c=o.getString("tag");let u=!0;c&&!WA.player.tags.includes(c)&&(u=!1);const f=!!c;function h(){var l;s&&s.remove(),s=WA.ui.displayActionMessage({message:(l=o.getString("closeTriggerMessage"))!==null&&l!==void 0?l:"Press SPACE to close the door",callback:()=>{WA.state[t.name]=!1,W()}})}function W(){var l;s&&s.remove(),s=WA.ui.displayActionMessage({message:(l=o.getString("openTriggerMessage"))!==null&&l!==void 0?l:"Press SPACE to open the door",callback:()=>{WA.state[t.name]=!0,h()}})}function We(){let l;if(e.type==="tilelayer")l=Yt(Vt(t.properties.mustGetString("closeLayer").split(`
`)));else{if(e.x===void 0||e.y===void 0||e.width===void 0||e.height===void 0)throw new Error(`Doorstep zone "${e.name}" is missing x, y, width or height`);l={top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}a=WA.room.website.create({name:"doorKeypad"+r,url:n+"/keypad.html#"+encodeURIComponent(r),position:{x:l.right*32,y:l.top*32,width:32*3,height:32*4},allowApi:!0})}function de(){a&&(WA.room.website.delete(a.name),a=void 0)}function p(){if(i=!0,o.getBoolean("autoOpen")&&u){WA.state[t.name]=!0;return}if(!WA.state[t.name]&&(f&&!u||!f)&&(o.getString("code")||o.getString("codeVariable"))){We();return}u&&(WA.state[t.name]?h():W())}function v(){i=!1,o.getBoolean("autoClose")&&(WA.state[t.name]=!1),s&&s.remove(),de()}e.type==="tilelayer"?(WA.room.onEnterLayer(r).subscribe(p),WA.room.onLeaveLayer(r).subscribe(v)):(WA.room.area.onEnter(r).subscribe(p),WA.room.area.onLeave(r).subscribe(v)),WA.state.onVariableChange(t.name).subscribe(()=>{i&&(!o.getBoolean("autoClose")&&WA.state[t.name]===!0&&h(),a&&WA.state[t.name]===!0&&de(),!o.getBoolean("autoOpen")&&WA.state[t.name]===!1&&W())})}function So(e){const t=e.properties.mustGetString("bellSound"),o=e.properties.getNumber("soundRadius");let n=1;if(o){const r=Math.sqrt(Math.pow(e.x-it,2)+Math.pow(e.y-ct,2));if(r>o)return;n=1-r/o}WA.sound.loadSound(t).play({volume:n})}function ko(e){WA.state[e.name]===void 0&&(WA.state[e.name]=0),WA.state.onVariableChange(e.name).subscribe(()=>{WA.state[e.name]&&So(e)})}function mt(e,t,o){let n;const r=t.getString("bellPopup");if(o.type==="tilelayer"){const s=o.name;WA.room.onEnterLayer(s).subscribe(()=>{var a;r?n=WA.ui.openPopup(r,"",[{label:(a=t.getString("bellButtonText"))!==null&&a!==void 0?a:"Ring",callback:()=>{WA.state[e]=WA.state[e]+1}}]):WA.state[e]=WA.state[e]+1}),WA.room.onLeaveLayer(s).subscribe(()=>{n&&(n.close(),n=void 0)})}else{const s=o.name;WA.room.area.onEnter(s).subscribe(()=>{var a;r?n=WA.ui.openPopup(r,"",[{label:(a=t.getString("bellButtonText"))!==null&&a!==void 0?a:"Ring",callback:()=>{WA.state[e]=WA.state[e]+1}}]):WA.state[e]=WA.state[e]+1}),WA.room.area.onLeave(s).subscribe(()=>{n&&(n.close(),n=void 0)})}}async function Co(e){e=e??wo;const t=await Xt();Oe=await Ae();for(const o of t.values())o.properties.get("door")&&Po(o),o.properties.get("bell")&&ko(o);for(const o of Oe.values()){const n=new pe(o.properties),r=n.getString("doorVariable");if(r&&o.type==="tilelayer"){const a=t.get(r);if(a===void 0)throw new Error('Cannot find variable "'+r+'" referred in the "doorVariable" property of layer "'+o.name+'"');gt(o,a,n,e)}const s=n.getString("bellVariable");s&&o.type==="tilelayer"&&mt(s,n,o)}for(const o of await Ut()){const n=new pe(o.properties),r=n.getString("doorVariable");if(r){const a=t.get(r);if(a===void 0)throw new Error('Cannot find variable "'+r+'" referred in the "doorVariable" property of object "'+o.name+'"');gt(o,a,n,e)}const s=n.getString("bellVariable");s&&mt(s,n,o)}WA.player.onPlayerMove(o=>{it=o.x,ct=o.y})}function Eo(e,t){const o=e.getString("bindVariable");if(o){const n=e.get("enterValue"),r=e.get("leaveValue"),s=e.getString("triggerMessage"),a=e.getString("tag");_o(o,t,n,r,s,a)}}let Pe;function _o(e,t,o,n,r,s){s&&!WA.player.tags.includes(s)||(o!==void 0&&WA.room.onEnterLayer(t).subscribe(()=>{r?Pe=WA.ui.displayActionMessage({type:"message",message:r,callback:()=>{WA.state[e]=o}}):WA.state[e]=o}),n!==void 0&&WA.room.onLeaveLayer(t).subscribe(()=>{WA.state[e]=n,Pe&&(Pe.remove().catch(a=>{console.error(a)}),Pe=void 0)}))}async function Io(){const e=await Ae();for(const t of e.values()){const o=new pe(t.properties);Eo(o,t.name)}}let bt;async function Mo(e){const t=await WA.room.getTiledMap();e=e??jt,bt=await Ae();const o=t.layers.find(n=>n.name==="configuration");if(o){const r=new pe(o.properties).getString("tag");(!r||WA.player.tags.includes(r))&&WA.ui.registerMenuCommand("Configure the room",()=>{WA.nav.openCoWebSite(e+"/configuration.html",!0)});for(const s of bt.values()){const a=new pe(s.properties),i=a.getString("openConfig");i&&s.type==="tilelayer"&&Lo(i.split(","),s.name,a)}}}function Lo(e,t,o){let n;const r=o.getString("openConfigAdminTag");let s=!0;r&&!WA.player.tags.includes(r)&&(s=!1);function a(){var c;n&&n.remove(),n=WA.ui.displayActionMessage({message:(c=o.getString("openConfigTriggerMessage"))!==null&&c!==void 0?c:"Press SPACE or touch here to configure",callback:()=>ut(e)})}function i(){WA.nav.closeCoWebSite()}WA.room.onEnterLayer(t).subscribe(()=>{const c=o.getString("openConfigTrigger");s&&(c&&c==="onaction"?a():ut(e))}),WA.room.onLeaveLayer(t).subscribe(()=>{n&&n.remove(),i()})}function To(){return WA.onInit().then(()=>{Co().catch(e=>console.error(e)),Io().catch(e=>console.error(e)),Mo().catch(e=>console.error(e)),Ao().catch(e=>console.error(e)),bo().catch(e=>console.error(e))}).catch(e=>console.error(e))}let D;function xo(){WA.room.area.onEnter("clock").subscribe(()=>{const e=new Date,t=String(e.getHours()).padStart(2,"0"),o=String(e.getMinutes()).padStart(2,"0");D&&D.close(),D=WA.ui.openPopup("clockPopup",`It's ${t}:${o}`,[])}),WA.room.area.onLeave("clock").subscribe(()=>{D&&(D.close(),D=void 0)})}let Se;function No(){const e=()=>{Se&&(Se.close(),Se=void 0)};WA.room.area.onEnter("board").subscribe(()=>{e();const t="The bulletin board hums with strange energy. Five portals shimmer before youâ€”choose your path: ðŸ’œ Malware â€” malicious code that corrupts, spies, and destroys â€¢ ðŸ”µ Phishing/Quishing â€” fake messages or QR Codes that trick you into giving secrets â€¢ ðŸ”´ Identity Theft â€” criminals using your identity â€¢ ðŸŸ¡ xxxxxxxxxxxx â€¢ ðŸ’š Password Security â€” strong, unique passwords and MFA to protect your accounts.";Se=WA.ui.openPopup("boardPopup",t,[])}),WA.room.area.onLeave("board").subscribe(e)}let z;function Ie(){var e;if(z){try{(e=z.close)==null||e.call(z)}catch{}z=void 0}}function Go(){var e,t;try{const o=(t=(e=WA.room.object)==null?void 0:e.get)==null?void 0:t.call(e,"MarvieZone");if(o&&o.properties){const n=o.properties;if(Array.isArray(n)){const r=n.find(s=>s.name==="marvieMessage"||s.name==="marviePopup");if(r!=null&&r.value)return String(r.value)}else if(n.marvieMessage)return String(n.marvieMessage)}}catch{}return["ðŸ‘‹ Hi â€” I'm Marvie.","","Welcome to the Room of Malware.","Do you think you can find the 3 easter eggs around the map?","Tip: Check the walls, the chairs or the floor for suspicious objects."].join(`
`)}function Ro(){console.log("[Marvie] init"),WA.room.area.onEnter("MarvieZone").subscribe(()=>{Ie();const e=Go();z=WA.ui.openPopup("marviePopup",e,[{label:"Got it",callback:()=>Ie()}])}),WA.room.area.onLeave("MarvieZone").subscribe(()=>{Ie()})}const Bo={library:{tasks:[{key:"phishing_SMSphishing",label:"SMS",area:"phishing_SMSphishing"},{key:"phishing_MurdochEmail",label:"MurdochEmail",area:"phishing_MurdochEmail"},{key:"phishing_QRcode",label:"QRcode",area:"phishing_QRcode"},{key:"phishing_instructions",label:"PPT Slides",area:"phishing_instructions"}],exitGate:{area:"to-canteen",nextRoom:"canteen.tmj#from-library",warnAnchorId:"phishing_gate_popup"}}},Oo={canteen:{tasks:[{key:"malware_instructions",label:"Slides",area:"malware_instructions"},{key:"malware_discord",label:"Discord",area:"malware_discord"},{key:"malware_usbdrive",label:"USB",area:"malware_usbdrive"},{key:"malware_trojan",label:"Trojan",area:"malware_trojan"}],exitGate:{area:"to-classroom",nextRoom:"classroom.tmj#from-canteen",warnAnchorId:"malware_gate_popup"}}},jo={classroom:{tasks:[{key:"passwordsecurity_instructions",label:"Slides",area:"passwordsecurity_instructions"},{key:"passwordsecurity_lmsaccount",label:"LMS Account",area:"passwordsecurity_lmsaccount"},{key:"passwordsecurity_lmspasswordexpired",label:"Password Expired",area:"passwordsecurity_lmspasswordexpired"},{key:"passwordsecurity_unlockedpc",label:"Unlocked PC",area:"passwordsecurity_unlockedpc"}],exitGate:{area:"to-hall",nextRoom:"hall.tmj#from-classroom",warnAnchorId:"passwordsecurity_gate_popup"}}},Do={computerlab:{tasks:[{key:"idtheft_instructions",label:"Slides",area:"idtheft_instructions"},{key:"idtheft_sensitivepapers",label:"Sensitive Papers",area:"idtheft_sensitivepapers"},{key:"idtheft_customerservicecall",label:"Customer Service Call",area:"idtheft_customerservicecall"},{key:"idtheft_celebration",label:"Celebration",area:"idtheft_celebration"}],exitGate:{area:"to-office",nextRoom:"office.tmj#from-computerlab",warnAnchorId:"idtheft_gate_popup"}}},Fo={hall:{tasks:[{key:"safeinternetpractices_instructions",label:"Slides",area:"safeinternetpractices_instructions"},{key:"safeinternetpractices_freewifi",label:"Free Wi-Fi",area:"safeinternetpractices_freewifi"},{key:"safeinternetpractices_fileuploads",label:"File Uploads",area:"safeinternetpractices_fileuploads"},{key:"safeinternetpractices_outdatedsoftware",label:"Outdated Software",area:"safeinternetpractices_outdatedsoftware"}],exitGate:{area:"to-computerlab",nextRoom:"computerlab.tmj#from-hall",warnAnchorId:"safeinternetpractices_gate_popup"}}},Uo={office:{tasks:[{key:"finalboss",label:"Face CipherX",area:"finalboss_cipherx"}]}},Yo={...Bo,...Oo,...jo,...Do,...Fo,...Uo},zt="cr:goals:",lt=e=>`${zt}${e}`;function Ho(e,t){try{localStorage.setItem(lt(e),JSON.stringify(t))}catch{}}function Vo(e){try{const t=localStorage.getItem(lt(e));return t?JSON.parse(t):null}catch{return null}}function $o(e){try{const t=[];for(let o=0;o<localStorage.length;o++){const n=localStorage.key(o);n&&n.startsWith(zt)&&!n.endsWith(e)&&t.push(n)}t.forEach(o=>localStorage.removeItem(o))}catch{}}let j={},ue=[],At=0,k,Me=0,q=!1,wt="";function zo(){WA.onInit().then(async()=>{const e=await Qo()||"";if(!e){console.log("[ProgressChecker] No mapId resolved.");return}if(wt===e)return;wt=e;const t=Yo[e];if(Le(),$o(e),!t){console.log("[ProgressChecker] No config for map:",e);return}console.log("[ProgressChecker] Init for map:",e),ue=t.tasks;const o=Vo(e);if(j={...Object.fromEntries(ue.map(r=>[r.key,!1])),...o??{}},window.addEventListener("beforeunload",()=>Le(),{passive:!0}),ue.forEach(r=>{try{WA.room.area.onEnter(r.area).subscribe(()=>{q||j[r.key]||(j[r.key]=!0,Ho(e,j),vt(),Wt()&&WA.ui.displayActionMessage({message:"âœ… All tasks done! You may proceed to the exit.",callback:()=>{}}))})}catch(s){console.warn(`[ProgressChecker] area '${r.area}' not found on this map`,s)}}),t.exitGate){const{area:r,nextRoom:s,warnAnchorId:a}=t.exitGate;WA.room.area.onEnter(r).subscribe(()=>{if(q)return;if(Wt()){q=!0,Le();try{WA.controls.disablePlayerControls()}catch{}try{localStorage.removeItem(lt(e))}catch{}setTimeout(()=>WA.nav.goToRoom(s),40);return}const i=Date.now();if(i-Me<500)return;Me=i;const c=qo();if(a)try{ke(),k=WA.ui.openPopup(a,`ðŸš§ Hold up!

You still need to complete:
â€¢ ${c.join(`
â€¢ `)}

Find all tasks in this room before leaving.`,[{label:"Close",className:"primary",callback:()=>ke()}]);return}catch{}WA.ui.displayActionMessage({message:`ðŸš§ Hold up! Missing: ${c.join(", ")}`,callback:()=>{}})}),WA.room.area.onLeave(r).subscribe(()=>{ke(),q||(Me=0)})}setTimeout(()=>{q||vt()},300)})}function Wt(){return ue.every(e=>j[e.key])}function qo(){return ue.filter(e=>!j[e.key]).map(e=>e.label)}function vt(){if(q)return;const e=Date.now();if(e-At<150)return;At=e;const t=ue.map(o=>j[o.key]?`âœ… ${o.label}`:`â¬œ ${o.label}`).join("   ");WA.ui.displayActionMessage({message:`Progress:  ${t}`,callback:()=>{}})}function ke(){var e;try{(e=k==null?void 0:k.close)==null||e.call(k)}catch{}k=void 0}function Le(){ke()}async function Qo(){var e,t,o;try{const n=decodeURIComponent(location.href).match(/\/([^\/?#]+)\.tmj/i);if(n!=null&&n[1])return n[1].toLowerCase()}catch{}try{const n=await((t=(e=WA.room).getTiledMap)==null?void 0:t.call(e)),r=n==null?void 0:n.properties,s=(o=r==null?void 0:r.find(a=>(a==null?void 0:a.name)==="mapId"))==null?void 0:o.value;if(typeof s=="string"&&s.trim())return s.trim().toLowerCase()}catch{}return""}let C;const Pt="phishing_QRcode",Ko="phishing_QRcodePopup";function Xo(){WA.onInit().then(()=>{WA.room.area.onEnter(Pt).subscribe(()=>{Te(),C=WA.ui.openPopup(Ko,"ðŸ— You spot a poster in the library:â€œFREE NUGGETS FOR LIFE â€“ Scan Me!â€ Your friend insists it looks real, but scanning random QR codes can lead to fake websites or data theft. What would you do? Press SPACE to help!",[{label:"Got it",callback:()=>Te()}])}),WA.room.area.onLeave(Pt).subscribe(()=>{Te()})})}function Te(){var e;try{C&&((e=C.close)==null||e.call(C),C=void 0)}catch{C=void 0}}let E;const St="phishing_MurdochEmail",Jo="phishing_MurdochEmailPopup";function Zo(){WA.onInit().then(()=>{WA.room.area.onEnter(St).subscribe(()=>{xe(),E=WA.ui.openPopup(Jo,`ðŸ“§ You received an email: â€œYour university fees are overdue. Click here to pay immediately.â€

âš ï¸ This looks suspicious... What would you do? Press SPACE to help!`,[{label:"Got it",callback:()=>xe()}])}),WA.room.area.onLeave(St).subscribe(()=>{xe()})})}function xe(){var e;try{E&&((e=E.close)==null||e.call(E),E=void 0)}catch{E=void 0}}let _;const kt="phishing_SMSphishing",en="phishing_SMSphishingPopup";function tn(){WA.onInit().then(()=>{WA.room.area.onEnter(kt).subscribe(()=>{Ne(),_=WA.ui.openPopup(en,"ðŸ”— You received a message: â€œYour Murdoch account needs verification! Click here: https://tinyurl.com/murdoch-reset. Shortened links can hide where they actually lead. Always check the real destination before clicking! What would you do? Press SPACE to help!",[{label:"Got it",callback:()=>Ne()}])}),WA.room.area.onLeave(kt).subscribe(()=>{Ne()})})}function Ne(){var e;try{_&&((e=_.close)==null||e.call(_),_=void 0)}catch{_=void 0}}let Q;function on(){WA.onInit().then(()=>{console.log("[WA] Phishing sign instructions ready"),WA.room.area.onEnter("phishing_instructions").subscribe(()=>{nn()}),WA.room.area.onLeave("phishing_instructions").subscribe(()=>{je()})})}function nn(){je(),Q=WA.ui.openPopup("phishing_instructionsPopup","ðŸ§‘â€ðŸ’» Quick! We saw one of the hackers going through this room! They are using phishing emails and dodgy QR codes to endanger students on campus! Before you chase after him, you should read these slides to learn how you can defend against Phishing.  ",[{label:"Got it!",className:"primary",callback:()=>je()}])}function je(){var e;Q&&((e=Q.close)==null||e.call(Q),Q=void 0)}let m,b;function Ge(){var e,t;try{(e=m==null?void 0:m.close)==null||e.call(m)}catch{}m=void 0;try{(t=b==null?void 0:b.unsubscribe)==null||t.call(b)}catch{}b=void 0}function Ct(){var e,t;try{(e=m==null?void 0:m.close)==null||e.call(m)}catch{}m=WA.ui.openPopup("phishing_librarySpawnPopup","ðŸ“Œ Please proceed and talk to Professor Byte.",[{label:"OK",callback:Ge}]);try{(t=b==null?void 0:b.unsubscribe)==null||t.call(b)}catch{}b=WA.room.area.onLeave("from-garden").subscribe(Ge),setTimeout(()=>{Ge()},5e3)}function rn(){WA.onInit().then(()=>{WA.room.area.onEnter("from-garden").subscribe(Ct),setTimeout(()=>{WA.player.getPosition().then(()=>Ct())},250)})}let I,F,U,Et=!1;const _t="billboard",sn="billboardPopup";function ge(){var e;try{(e=I==null?void 0:I.close)==null||e.call(I)}catch{}I=void 0}function an(){Et||(Et=!0,WA.onInit().then(()=>{var e,t,o,n,r,s;try{(e=F==null?void 0:F.unsubscribe)==null||e.call(F)}catch{}try{(t=U==null?void 0:U.unsubscribe)==null||t.call(U)}catch{}F=WA.room.area.onEnter(_t).subscribe(()=>{console.log("[billboard] enter"),ge(),I=WA.ui.openPopup(sn,"ðŸ“œ The community billboard âž¡ï¸ Move towards the ladder on the right and begin your adventure!",[{label:"Close",className:"primary",callback:()=>ge()}])}),U=WA.room.area.onLeave(_t).subscribe(()=>{console.log("[billboard] leave"),ge()}),(s=(n=(o=WA.room).onLeaveLayer)==null?void 0:(r=n.call(o,"**")).subscribe)==null||s.call(r,()=>ge()),window.addEventListener("blur",ge)}))}let K;function cn(){WA.onInit().then(()=>{setTimeout(ln,50)})}function ln(){It(),K=WA.ui.openPopup("spawnIntroPopup","ðŸ‘‹ Welcome! Use the Arrow Keys or WASD to move. Explore the map and look for Professor Byte for guidance. Tip: Walk close to objects (signs, boards, NPCs) to interact with them.",[{label:"Got it",className:"primary",callback:e=>{var t;try{(t=e.close)==null||t.call(e)}catch{}It()}}])}function It(){var e;if(K){try{(e=K.close)==null||e.call(K)}catch{}K=void 0}}let M,Y,H,Mt=!1;const Lt="instructions",un="instructionsPopup";function pn(){Mt||(Mt=!0,WA.onInit().then(()=>{var e,t;try{(e=Y==null?void 0:Y.unsubscribe)==null||e.call(Y)}catch{}try{(t=H==null?void 0:H.unsubscribe)==null||t.call(H)}catch{}Y=WA.room.area.onEnter(Lt).subscribe(()=>{Re();const o=WA.player.name||"Cyber Ranger";M=WA.ui.openPopup(un,`ðŸ« Thank the heavens you're here, ${o}!  
Murdoch University is under a Cyber Attack! We need your help to protect the school against evildoers who wish us harm.  
Please proceed through the school and learn about how you can help us!`,[{label:"Got it!",className:"primary",callback:()=>Re()}])}),H=WA.room.area.onLeave(Lt).subscribe(()=>{Re()})}))}function Re(){var e;try{(e=M==null?void 0:M.close)==null||e.call(M)}catch{}M=void 0}let L,V,$,Tt=!1;const xt="credits",fn="creditsPopup";function me(){var e;try{(e=L==null?void 0:L.close)==null||e.call(L)}catch{}L=void 0}function hn(){Tt||(Tt=!0,WA.onInit().then(()=>{var e,t,o,n,r,s;try{(e=V==null?void 0:V.unsubscribe)==null||e.call(V)}catch{}try{(t=$==null?void 0:$.unsubscribe)==null||t.call($)}catch{}V=WA.room.area.onEnter(xt).subscribe(()=>{console.log("[credits] enter"),me(),L=WA.ui.openPopup(fn,"Team Credits (Cyber Rangers): Joyce Boey Yoke Leng, Rudolph Benjamin Maxwell, Tan Eng Kai, Alvin Teng You Rong, Seet He Ren",[{label:"Close",className:"primary",callback:()=>me()}])}),$=WA.room.area.onLeave(xt).subscribe(()=>{console.log("[credits] leave"),me()}),(s=(n=(o=WA.room).onLeaveLayer)==null?void 0:(r=n.call(o,"**")).subscribe)==null||s.call(r,()=>me()),window.addEventListener("blur",me)}))}let X;function dn(){WA.onInit().then(()=>{console.log("[WA] Malware instructions ready"),WA.room.area.onEnter("malware_instructions").subscribe(()=>{yn()}),WA.room.area.onLeave("malware_instructions").subscribe(()=>{De()})})}function yn(){De(),X=WA.ui.openPopup("malware_instructionsPopup","ðŸ§‘â€ðŸ’» Congratulations on clearing the first room! But we have a long way to go before weâ€™re ready to really protect Murdoch... In this room, youâ€™ll learn more about Malware and the best ways to protect against it. To begin, go through the slides by pressing SPACE.",[{label:"Got it!",className:"primary",callback:()=>De()}])}function De(){var e;if(X){try{(e=X.close)==null||e.call(X)}catch{}X=void 0}}let T;const Nt="malware_discord",gn="malware_discordPopup";function mn(){WA.onInit().then(()=>{console.log("[WA] Malware Discord popup ready"),WA.room.area.onEnter(Nt).subscribe(()=>{bn()}),WA.room.area.onLeave(Nt).subscribe(()=>{Fe()})})}function bn(){Fe(),T=WA.ui.openPopup(gn,`ðŸ’¬ Your friend DMs you on Discord about a program that â€œunlocks Discord Nitro Premium for lifeâ€ and says itâ€™s safe because they used it.

What would you do? Press SPACE to help!`,[{label:"Got it!",className:"primary",callback:()=>Fe()}])}function Fe(){var e;try{(e=T==null?void 0:T.close)==null||e.call(T)}catch{}T=void 0}let x;const Gt="malware_usbdrive",An="malware_usbdrivePopup";function wn(){WA.onInit().then(()=>{console.log("[WA] Malware USB Drive popup ready"),WA.room.area.onEnter(Gt).subscribe(()=>{Wn()}),WA.room.area.onLeave(Gt).subscribe(()=>{Ue()})})}function Wn(){Ue(),x=WA.ui.openPopup(An,"ðŸ’¾ You spot a USB drive on the canteen floor. You are curious about whatâ€™s inside. What would you do? Press SPACE to help!",[{label:"Got it!",className:"primary",callback:()=>Ue()}])}function Ue(){var e;try{(e=x==null?void 0:x.close)==null||e.call(x)}catch{}x=void 0}let N;const Rt="malware_trojan",vn="malware_trojanPopup";function Pn(){WA.onInit().then(()=>{console.log("[WA] Malware Trojan popup ready"),WA.room.area.onEnter(Rt).subscribe(()=>{Sn()}),WA.room.area.onLeave(Rt).subscribe(()=>{Ye()})})}function Sn(){Ye(),N=WA.ui.openPopup(vn,"ðŸ›¡ï¸ A system alert appears: â€œWindows Defender Virus Protection found an unwanted app (type: Trojan).â€ What would you do? Press SPACE to help!",[{label:"Got it!",className:"primary",callback:()=>Ye()}])}function Ye(){var e;try{(e=N==null?void 0:N.close)==null||e.call(N)}catch{}N=void 0}let J;function kn(){WA.onInit().then(()=>{console.log("[WA] Password Security instructions ready"),WA.room.area.onEnter("passwordsecurity_instructions").subscribe(()=>{Cn()}),WA.room.area.onLeave("passwordsecurity_instructions").subscribe(()=>{He()})})}function Cn(){He(),J=WA.ui.openPopup("passwordsecurity_instructionsPopup","ðŸ§‘â€ðŸ« Thank goodness youâ€™re here! The hackers are after our passwords, and we need your help to secure them! âž¡ï¸ To begin, go through the slides to learn more about Passsword Security by pressing SPACE. Afterwards, help us defend the school!",[{label:"Got it!",className:"primary",callback:()=>He()}])}function He(){var e;if(J){try{(e=J.close)==null||e.call(J)}catch{}J=void 0}}let Z;function En(){WA.onInit().then(()=>{console.log("[WA] Password Security - LMS Account scenario ready"),WA.room.area.onEnter("passwordsecurity_lmsaccount").subscribe(()=>{_n()}),WA.room.area.onLeave("passwordsecurity_lmsaccount").subscribe(()=>{Ve()})})}function _n(){Ve(),Z=WA.ui.openPopup("passwordsecurity_lmsaccountPopup","ðŸ‘©â€ðŸ’» Your classmate Joyce says she forgot her LMS login and asks to borrow your account to check the quiz questions. What would you do? Press SPACE to help!",[{label:"Let's decide!",className:"primary",callback:()=>Ve()}])}function Ve(){var e;if(Z){try{(e=Z.close)==null||e.call(Z)}catch{}Z=void 0}}let ee;function In(){WA.onInit().then(()=>{console.log("[WA] Password Security - LMS Password Expired scenario ready"),WA.room.area.onEnter("passwordsecurity_lmspasswordexpired").subscribe(()=>{Mn()}),WA.room.area.onLeave("passwordsecurity_lmspasswordexpired").subscribe(()=>{$e()})})}function Mn(){$e(),ee=WA.ui.openPopup("passwordsecurity_lmspasswordexpiredPopup","ðŸ”‘ Your LMS password has just expired! The system is asking you to create a new one. How will you choose your new password? Press SPACE to help!",[{label:"Let's find out!",className:"primary",callback:()=>$e()}])}function $e(){var e;if(ee){try{(e=ee.close)==null||e.call(ee)}catch{}ee=void 0}}let te;function Ln(){WA.onInit().then(()=>{console.log("[WA] Password Security - Unlocked PC scenario ready"),WA.room.area.onEnter("passwordsecurity_unlockedpc").subscribe(()=>{Tn()}),WA.room.area.onLeave("passwordsecurity_unlockedpc").subscribe(()=>{ze()})})}function Tn(){ze(),te=WA.ui.openPopup("passwordsecurity_unlockedpcPopup","ðŸ’» You notice an unlocked PC with a teacherâ€™s account signed in â€” an Excel sheet is open showing login details! What should you do? Press SPACE to help!",[{label:"I'll check!",className:"primary",callback:()=>ze()}])}function ze(){var e;if(te){try{(e=te.close)==null||e.call(te)}catch{}te=void 0}}let G;function xn(){WA.onInit().then(()=>{console.log("[WA] Safe Internet Practices â€“ Free Wi-Fi ready"),WA.room.area.onEnter("safeinternetpractices_freewifi").subscribe(()=>Nn()),WA.room.area.onLeave("safeinternetpractices_freewifi").subscribe(()=>qe())})}function Nn(){qe(),G=WA.ui.openPopup("safeinternetpractices_freewifiPopup","ðŸ“¶ In the hall, you spot a wall sign offering **Free Wi-Fi**. Nearby, you see open networks like â€œHallGuestâ€ and â€œCampusFreeâ€. How would you get online safely? Press SPACE to help!",[{label:"Got it",className:"primary",callback:()=>qe()}])}function qe(){var e;try{(e=G==null?void 0:G.close)==null||e.call(G)}catch{}G=void 0}let R;function Gn(){WA.onInit().then(()=>{console.log("[WA] Safe Internet Practices â€“ File Uploads ready"),WA.room.area.onEnter("safeinternetpractices_fileuploads").subscribe(()=>Rn()),WA.room.area.onLeave("safeinternetpractices_fileuploads").subscribe(()=>Qe())})}function Rn(){Qe(),R=WA.ui.openPopup("safeinternetpractices_fileuploadsPopup","ðŸ’¬ Hey! Can you help me edit this PDF file? I found some free online tools that lets you upload and edit PDFs easily! What would you do? Press SPACE to help!",[{label:"Letâ€™s see!",className:"primary",callback:()=>Qe()}])}function Qe(){var e;try{(e=R==null?void 0:R.close)==null||e.call(R)}catch{}R=void 0}let B;function Bn(){WA.onInit().then(()=>{console.log("[WA] Safe Internet Practices â€“ Outdated Software ready"),WA.room.area.onEnter("safeinternetpractices_outdatedsoftware").subscribe(()=>On()),WA.room.area.onLeave("safeinternetpractices_outdatedsoftware").subscribe(()=>Ke())})}function On(){Ke(),B=WA.ui.openPopup("safeinternetpractices_outdatedsoftwarePopup","ðŸ§‘â€ðŸ’» You saw a laptop on the floor, you picked it up and open your browser to check your bank account, but a message appears saying your browser needs an update. What will you do? Press SPACE to help!",[{label:"Letâ€™s decide!",className:"primary",callback:()=>Ke()}])}function Ke(){var e;try{(e=B==null?void 0:B.close)==null||e.call(B)}catch{}B=void 0}let O;function jn(){WA.onInit().then(()=>{console.log("[WA] Safe Internet Practices instructions ready"),WA.room.area.onEnter("safeinternetpractices_instructions").subscribe(()=>Dn()),WA.room.area.onLeave("safeinternetpractices_instructions").subscribe(()=>Xe())})}function Dn(){Xe(),O=WA.ui.openPopup("safeinternetpractices_instructionsPopup","ðŸ« Youâ€™ve made it through 3 of the topics, well done! But thereâ€™s more we need to learn before weâ€™re truly ready to defeat the malicious actors. Please press SPACE to talk to me before you explore the room!",[{label:"Got it!",className:"primary",callback:()=>Xe()}])}function Xe(){var e;try{(e=O==null?void 0:O.close)==null||e.call(O)}catch{}O=void 0}let oe;function Fn(){WA.onInit().then(()=>{console.log("[WA] ID Theft instructions ready"),WA.room.area.onEnter("idtheft_instructions").subscribe(()=>{Un()}),WA.room.area.onLeave("idtheft_instructions").subscribe(()=>{Je()})})}function Un(){Je(),oe=WA.ui.openPopup("idtheft_instructionsPopup","ðŸ§‘â€ðŸ« Itâ€™s hard to believe it but we seem to be in the last topic! Weâ€™re almost ready to face the hackers and help defend the school! One of the students recently fell victim to ID Theft via a phishing email, and theyâ€™re now being impersonated online! Press SPACE to read the slides on the basics you need to learn first. Afterwards, please check the PC nearby to see if you can help.",[{label:"Got it!",className:"primary",callback:()=>Je()}])}function Je(){var e;if(oe){try{(e=oe.close)==null||e.call(oe)}catch{}oe=void 0}}let ne;function Yn(){WA.onInit().then(()=>{console.log("[WA] ID Theft - Sensitive Papers ready"),WA.room.area.onEnter("idtheft_sensitivepapers").subscribe(()=>{Hn()}),WA.room.area.onLeave("idtheft_sensitivepapers").subscribe(()=>{Ze()})})}function Hn(){Ze(),ne=WA.ui.openPopup("idtheft_sensitivepapersPopup","ðŸ“„ While cleaning out some old documents from your locker, you notice a pile of old bank statements. They might contain sensitive information â€” how you handle them could determine whether your data stays safe! Press SPACE to investigate what happens next.",[{label:"Got it!",className:"primary",callback:()=>Ze()}])}function Ze(){var e;if(ne){try{(e=ne.close)==null||e.call(ne)}catch{}ne=void 0}}let re;function Vn(){WA.onInit().then(()=>{console.log("[WA] ID Theft - Customer Service Call ready"),WA.room.area.onEnter("idtheft_customerservicecall").subscribe(()=>{$n()}),WA.room.area.onLeave("idtheft_customerservicecall").subscribe(()=>{et()})})}function $n(){et(),re=WA.ui.openPopup("idtheft_customerservicecallPopup","ðŸ“ž You notice a phone lying on the floor and decide to pick it up. As soon as you do, you receive a call â€” the person on the other end claims to be a bank representative who somehow knows your name and partial account number. Press SPACE to find out what happens next!",[{label:"Got it!",className:"primary",callback:()=>et()}])}function et(){var e;if(re){try{(e=re.close)==null||e.call(re)}catch{}re=void 0}}let se;function zn(){WA.onInit().then(()=>{console.log("[WA] ID Theft - Celebration ready"),WA.room.area.onEnter("idtheft_celebration").subscribe(()=>{qn()}),WA.room.area.onLeave("idtheft_celebration").subscribe(()=>{tt()})})}function qn(){tt(),se=WA.ui.openPopup("idtheft_celebrationPopup","ðŸ“¸ Youâ€™ve just passed your driving test and gotten your new license! Excited, you picked up your phone from the bench and took a selfie with it in hand to celebrate your big achievement. But should you post it online? Press SPACE to see what happens next!",[{label:"Got it!",className:"primary",callback:()=>tt()}])}function tt(){var e;if(se){try{(e=se.close)==null||e.call(se)}catch{}se=void 0}}let A,w,Bt=!1;const qt="from-computerlab",Qn="finalboss_spawnPopup";function Be(){var e,t;try{(e=A==null?void 0:A.close)==null||e.call(A)}catch{}A=void 0;try{(t=w==null?void 0:w.unsubscribe)==null||t.call(w)}catch{}w=void 0}function Ot(){var e,t;if(!Bt){Bt=!0;try{(e=A==null?void 0:A.close)==null||e.call(A)}catch{}A=WA.ui.openPopup(Qn,"ðŸ¢ Youâ€™ve entered the main officeâ€¦ it feels quiet, too quiet. Somethingâ€™s off â€” the source of all the attacks must be here. Move forward carefully.",[{label:"Got it!",className:"primary",callback:Be}]);try{(t=w==null?void 0:w.unsubscribe)==null||t.call(w)}catch{}w=WA.room.area.onLeave(qt).subscribe(Be),setTimeout(()=>Be(),6e3)}}function Kn(){WA.onInit().then(()=>{console.log("[WA] Final Boss spawn ready"),WA.room.area.onEnter(qt).subscribe(Ot),setTimeout(()=>{WA.player.getPosition().then(()=>Ot())},250)})}let ae;function Xn(){WA.onInit().then(()=>{console.log("[WA] Final Boss CipherX ready"),WA.room.area.onEnter("finalboss_cipherx").subscribe(()=>{Jn()}),WA.room.area.onLeave("finalboss_cipherx").subscribe(()=>{ot()})})}function Jn(){ot(),ae=WA.ui.openPopup("finalboss_cipherxPopup","ðŸ‘¾ So... youâ€™ve made it through every challenge â€” phishing, malware, weak passwords, stolen identities. Youâ€™ve been a thorn in my plans for far too long! Press SPACE to face CipherX in the final showdown quiz!",[{label:"Iâ€™m ready!",className:"primary",callback:()=>ot()}])}function ot(){var e;if(ae){try{(e=ae.close)==null||e.call(ae)}catch{}ae=void 0}}let ie;function Zn(){WA.onInit().then(()=>{console.log("[WA] Ending message ready"),WA.room.area.onEnter("endingmessage").subscribe(()=>{er()}),WA.room.area.onLeave("endingmessage").subscribe(()=>{nt()})})}function er(){nt(),ie=WA.ui.openPopup("endingmessagePopup","ðŸ† Congratulations, Cyber Ranger! Youâ€™ve defeated CipherX and restored peace to Murdoch University. Thanks to your actions, students can now browse, click, and share safely once again. Please move to the right towards the stairs and complete the survey. ",[{label:"Finish!",className:"primary",callback:()=>nt()}])}function nt(){var e;if(ie){try{(e=ie.close)==null||e.call(ie)}catch{}ie=void 0}}let ce;function tr(){WA.onInit().then(()=>{console.log("[WA] Survey area ready"),WA.room.area.onEnter("survey").subscribe(()=>{or()}),WA.room.area.onLeave("survey").subscribe(()=>{rt()})})}function or(){rt(),ce=WA.ui.openPopup("surveyPopup","ðŸ“ Final Step: Please proceed to complete the post-game survey to help us improve Cyber Rangers! Press SPACE to begin.",[{label:"Open Survey",className:"primary",callback:()=>rt()}])}function rt(){var e;if(ce){try{(e=ce.close)==null||e.call(ce)}catch{}ce=void 0}}let le;function nr(){WA.onInit().then(()=>{console.log("[WA] Final Boss instructions ready"),WA.room.area.onEnter("finalboss_instructions").subscribe(()=>{rr()}),WA.room.area.onLeave("finalboss_instructions").subscribe(()=>{st()})})}function rr(){st();const e=WA.player.name||"Cyber Ranger";le=WA.ui.openPopup("finalboss_instructionsPopup",`ðŸ§‘â€ðŸ« Welcome to the Final Challenge, ${e}!
Your mission in this room is simple: Find CipherX, defeat him and proceed to the stairs to finish. Good luck! This is where everything you've learned comes together!`,[{label:"Got it!",className:"primary",callback:()=>st()}])}function st(){var e;if(le){try{(e=le.close)==null||e.call(le)}catch{}le=void 0}}console.log("Script started");WA.onInit().then(async()=>{var t,o,n,r,s,a,i,c,u,f;console.log("Scripting API ready"),await To();try{(o=(t=WA.controls).turnOffWebcam)==null||o.call(t),(r=(n=WA.controls).turnOffMicrophone)==null||r.call(n),(a=(s=WA.controls).disableWebcam)==null||a.call(s),(c=(i=WA.controls).disableMicrophone)==null||c.call(i),(f=(u=WA.controls).disablePlayerProximityMeeting)==null||f.call(u)}catch(h){console.warn("[WA] Could not disable A/V overlay:",h)}xo(),No(),Ro(),zo();const e=await sr();console.log("[Router] mapId =",e||"(unknown)"),e==="garden"?(console.log("[Router] Initializing GARDEN featuresâ€¦"),an(),cn(),pn(),hn()):e==="library"?(console.log("[Router] Initializing LIBRARY (Phishing) featuresâ€¦"),Xo(),Zo(),tn(),on(),rn()):e==="canteen"?(console.log("[Router] Initializing CANTEEN (Malware) featuresâ€¦"),dn(),mn(),wn(),Pn()):e==="classroom"?(console.log("[Router] Initializing CLASSROOM (Password Security) featuresâ€¦"),kn(),En(),In(),Ln()):e==="computerlab"?(console.log("[Router] Initializing COMPUTER LAB (ID Theft) featuresâ€¦"),Fn(),Yn(),Vn(),zn()):e==="hall"?(console.log("[Router] Initializing HALL (Safe Internet Practices) featuresâ€¦"),xn(),Gn(),Bn(),jn()):e==="office"?(console.log("[Router] Initializing OFFICE (Final Boss) featuresâ€¦"),Kn(),Xn(),Zn(),tr(),nr()):console.warn("[Router] Unknown map; only common features started. Set a Tiled Map Property `mapId` (string) to enable map-specific inits.")});async function sr(){var e,t,o;try{const r=decodeURIComponent(window.location.href).match(/\/([^\/?#]+)\.tmj/i);if(r!=null&&r[1])return r[1].toLowerCase()}catch{}try{const n=await((t=(e=WA.room).getTiledMap)==null?void 0:t.call(e)),r=((n==null?void 0:n.url)??(n==null?void 0:n.name)??"").toString();if(r){const i=(r.split("/").pop()||r).toLowerCase();return i.endsWith(".tmj")?i.replace(/\.tmj$/,""):i}const s=n==null?void 0:n.properties,a=(o=s==null?void 0:s.find(i=>(i==null?void 0:i.name)==="mapId"))==null?void 0:o.value;if(typeof a=="string"&&a.trim())return a.trim().toLowerCase()}catch{}return""}
//# sourceMappingURL=main-17d1ee46.js.map
