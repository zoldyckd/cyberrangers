class R{constructor(e){this.properties=e??[]}get(e){const n=this.properties.filter(o=>o.name===e).map(o=>o.value);if(n.length>1)throw new Error('Expected only one property to be named "'+e+'"');if(n.length!==0)return n[0]}getString(e){return this.getByType(e,"string")}getNumber(e){return this.getByType(e,"number")}getBoolean(e){return this.getByType(e,"boolean")}getByType(e,n){const o=this.get(e);if(o!==void 0){if(n!=="json"&&typeof o!==n)throw new Error('Expected property "'+e+'" to have type "'+n+'"');return o}}mustGetString(e){return this.mustGetByType(e,"string")}mustGetNumber(e){return this.mustGetByType(e,"number")}mustGetBoolean(e){return this.mustGetByType(e,"boolean")}mustGetByType(e,n){const o=this.get(e);if(o===void 0)throw new Error('Property "'+e+'" is missing');if(n!=="json"&&typeof o!==n)throw new Error('Expected property "'+e+'" to have type "'+n+'"');return o}getType(e){const n=this.properties.filter(o=>o.name===e).map(o=>o.type);if(n.length>1)throw new Error('Expected only one property to be named "'+e+'"');if(n.length!==0)return n[0]}}const Ae="https://unpkg.com/@workadventure/scripting-api-extra@1.9.10/dist";class Te{constructor(e){this.name=e.name,this.x=e.x,this.y=e.y,this.properties=new R(e.properties)}get isReadable(){const e=this.properties.getString("readableBy");return e?WA.player.tags.includes(e):!0}get isWritable(){const e=this.properties.getString("writableBy");return e?WA.player.tags.includes(e):!0}}function ce(t){const e=t?"#"+t.join():"";WA.nav.openCoWebSite(Ae+"/configuration.html"+e,!0)}async function xe(t,e){const n=await WA.room.getTiledMap(),o=new Map;return we(n.layers,o,t,e),o}function we(t,e,n,o){for(const r of t)if(r.type==="objectgroup"){for(const a of r.objects)if(a.type==="variable"||a.class==="variable"){if(n&&r.name!==n||o&&!o.includes(a.name))continue;e.set(a.name,new Te(a))}}else r.type==="group"&&we(r.layers,e,n,o)}let X;async function O(){return X===void 0&&(X=Ie()),X}async function Ie(){return Oe(await WA.room.getTiledMap())}function Oe(t){const e=new Map;return ke(t.layers,"",e),e}function ke(t,e,n){for(const o of t)o.type==="group"?ke(o.layers,e+o.name+"/",n):(o.name=e+o.name,n.set(o.name,o))}async function We(){const t=await O(),e=[];for(const n of t.values())if(n.type==="objectgroup")for(const o of n.objects)(o.type==="area"||o.class==="area")&&e.push(o);return e}function je(t){let e=1/0,n=1/0,o=0,r=0;const a=t.data;if(typeof a=="string")throw new Error("Unsupported tile layer data stored as string instead of CSV");for(let s=0;s<t.height;s++)for(let i=0;i<t.width;i++)a[i+s*t.width]!==0&&(e=Math.min(e,i),r=Math.max(r,i),n=Math.min(n,s),o=Math.max(o,s));return{top:n,left:e,right:r+1,bottom:o+1}}function Pe(t){let e=1/0,n=1/0,o=0,r=0;for(const a of t){const s=je(a);s.left<e&&(e=s.left),s.top<n&&(n=s.top),s.right>r&&(r=s.right),s.bottom>o&&(o=s.bottom)}return{top:n,left:e,right:r,bottom:o}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var _e=Object.prototype.toString,B=Array.isArray||function(e){return _e.call(e)==="[object Array]"};function oe(t){return typeof t=="function"}function Qe(t){return B(t)?"array":typeof t}function z(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function le(t,e){return t!=null&&typeof t=="object"&&e in t}function Ge(t,e){return t!=null&&typeof t!="object"&&t.hasOwnProperty&&t.hasOwnProperty(e)}var Ve=RegExp.prototype.test;function Ne(t,e){return Ve.call(t,e)}var Ue=/\S/;function De(t){return!Ne(Ue,t)}var He={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function Ke(t){return String(t).replace(/[&<>"'`=\/]/g,function(n){return He[n]})}var qe=/\s*/,Fe=/\s+/,ue=/\s*=/,$e=/\s*\}/,Ye=/#|\^|\/|>|\{|&|=|!/;function Xe(t,e){if(!t)return[];var n=!1,o=[],r=[],a=[],s=!1,i=!1,c="",u=0;function f(){if(s&&!i)for(;a.length;)delete r[a.pop()];else a=[];s=!1,i=!1}var y,v,Q;function T(k){if(typeof k=="string"&&(k=k.split(Fe,2)),!B(k)||k.length!==2)throw new Error("Invalid tags: "+k);y=new RegExp(z(k[0])+"\\s*"),v=new RegExp("\\s*"+z(k[1])),Q=new RegExp("\\s*"+z("}"+k[1]))}T(e||g.tags);for(var p=new j(t),A,l,b,x,G,W;!p.eos();){if(A=p.pos,b=p.scanUntil(y),b)for(var Y=0,Be=b.length;Y<Be;++Y)x=b.charAt(Y),De(x)?(a.push(r.length),c+=x):(i=!0,n=!0,c+=" "),r.push(["text",x,A,A+1]),A+=1,x===`
`&&(f(),c="",u=0,n=!1);if(!p.scan(y))break;if(s=!0,l=p.scan(Ye)||"name",p.scan(qe),l==="="?(b=p.scanUntil(ue),p.scan(ue),p.scanUntil(v)):l==="{"?(b=p.scanUntil(Q),p.scan($e),p.scanUntil(v),l="&"):b=p.scanUntil(v),!p.scan(v))throw new Error("Unclosed tag at "+p.pos);if(l==">"?G=[l,b,A,p.pos,c,u,n]:G=[l,b,A,p.pos],u++,r.push(G),l==="#"||l==="^")o.push(G);else if(l==="/"){if(W=o.pop(),!W)throw new Error('Unopened section "'+b+'" at '+A);if(W[1]!==b)throw new Error('Unclosed section "'+W[1]+'" at '+A)}else l==="name"||l==="{"||l==="&"?i=!0:l==="="&&T(b)}if(f(),W=o.pop(),W)throw new Error('Unclosed section "'+W[1]+'" at '+p.pos);return Ze(ze(r))}function ze(t){for(var e=[],n,o,r=0,a=t.length;r<a;++r)n=t[r],n&&(n[0]==="text"&&o&&o[0]==="text"?(o[1]+=n[1],o[3]=n[3]):(e.push(n),o=n));return e}function Ze(t){for(var e=[],n=e,o=[],r,a,s=0,i=t.length;s<i;++s)switch(r=t[s],r[0]){case"#":case"^":n.push(r),o.push(r),n=r[4]=[];break;case"/":a=o.pop(),a[5]=r[2],n=o.length>0?o[o.length-1][4]:e;break;default:n.push(r)}return e}function j(t){this.string=t,this.tail=t,this.pos=0}j.prototype.eos=function(){return this.tail===""};j.prototype.scan=function(e){var n=this.tail.match(e);if(!n||n.index!==0)return"";var o=n[0];return this.tail=this.tail.substring(o.length),this.pos+=o.length,o};j.prototype.scanUntil=function(e){var n=this.tail.search(e),o;switch(n){case-1:o=this.tail,this.tail="";break;case 0:o="";break;default:o=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=o.length,o};function L(t,e){this.view=t,this.cache={".":this.view},this.parent=e}L.prototype.push=function(e){return new L(e,this)};L.prototype.lookup=function(e){var n=this.cache,o;if(n.hasOwnProperty(e))o=n[e];else{for(var r=this,a,s,i,c=!1;r;){if(e.indexOf(".")>0)for(a=r.view,s=e.split("."),i=0;a!=null&&i<s.length;)i===s.length-1&&(c=le(a,s[i])||Ge(a,s[i])),a=a[s[i++]];else a=r.view[e],c=le(r.view,e);if(c){o=a;break}r=r.parent}n[e]=o}return oe(o)&&(o=o.call(this.view)),o};function d(){this.templateCache={_cache:{},set:function(e,n){this._cache[e]=n},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}d.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};d.prototype.parse=function(e,n){var o=this.templateCache,r=e+":"+(n||g.tags).join(":"),a=typeof o<"u",s=a?o.get(r):void 0;return s==null&&(s=Xe(e,n),a&&o.set(r,s)),s};d.prototype.render=function(e,n,o,r){var a=this.getConfigTags(r),s=this.parse(e,a),i=n instanceof L?n:new L(n,void 0);return this.renderTokens(s,i,o,e,r)};d.prototype.renderTokens=function(e,n,o,r,a){for(var s="",i,c,u,f=0,y=e.length;f<y;++f)u=void 0,i=e[f],c=i[0],c==="#"?u=this.renderSection(i,n,o,r,a):c==="^"?u=this.renderInverted(i,n,o,r,a):c===">"?u=this.renderPartial(i,n,o,a):c==="&"?u=this.unescapedValue(i,n):c==="name"?u=this.escapedValue(i,n,a):c==="text"&&(u=this.rawValue(i)),u!==void 0&&(s+=u);return s};d.prototype.renderSection=function(e,n,o,r,a){var s=this,i="",c=n.lookup(e[1]);function u(v){return s.render(v,n,o,a)}if(c){if(B(c))for(var f=0,y=c.length;f<y;++f)i+=this.renderTokens(e[4],n.push(c[f]),o,r,a);else if(typeof c=="object"||typeof c=="string"||typeof c=="number")i+=this.renderTokens(e[4],n.push(c),o,r,a);else if(oe(c)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");c=c.call(n.view,r.slice(e[3],e[5]),u),c!=null&&(i+=c)}else i+=this.renderTokens(e[4],n,o,r,a);return i}};d.prototype.renderInverted=function(e,n,o,r,a){var s=n.lookup(e[1]);if(!s||B(s)&&s.length===0)return this.renderTokens(e[4],n,o,r,a)};d.prototype.indentPartial=function(e,n,o){for(var r=n.replace(/[^ \t]/g,""),a=e.split(`
`),s=0;s<a.length;s++)a[s].length&&(s>0||!o)&&(a[s]=r+a[s]);return a.join(`
`)};d.prototype.renderPartial=function(e,n,o,r){if(o){var a=this.getConfigTags(r),s=oe(o)?o(e[1]):o[e[1]];if(s!=null){var i=e[6],c=e[5],u=e[4],f=s;c==0&&u&&(f=this.indentPartial(s,u,i));var y=this.parse(f,a);return this.renderTokens(y,n,o,f,r)}}};d.prototype.unescapedValue=function(e,n){var o=n.lookup(e[1]);if(o!=null)return o};d.prototype.escapedValue=function(e,n,o){var r=this.getConfigEscape(o)||g.escape,a=n.lookup(e[1]);if(a!=null)return typeof a=="number"&&r===g.escape?String(a):r(a)};d.prototype.rawValue=function(e){return e[1]};d.prototype.getConfigTags=function(e){return B(e)?e:e&&typeof e=="object"?e.tags:void 0};d.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!B(e))return e.escape};var g={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(t){I.templateCache=t},get templateCache(){return I.templateCache}},I=new d;g.clearCache=function(){return I.clearCache()};g.parse=function(e,n){return I.parse(e,n)};g.render=function(e,n,o,r){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+Qe(e)+'" was given as the first argument for mustache#render(template, view, partials)');return I.render(e,n,o,r)};g.escape=Ke;g.Scanner=j;g.Context=L;g.Writer=d;class Ee{constructor(e,n){this.template=e,this.state=n,this.ast=g.parse(e)}getValue(){return this.value===void 0&&(this.value=g.render(this.template,this.state)),this.value}onChange(e){const n=[];for(const o of this.getUsedVariables().values())n.push(this.state.onVariableChange(o).subscribe(()=>{const r=g.render(this.template,this.state);r!==this.value&&(this.value=r,e(this.value))}));return{unsubscribe:()=>{for(const o of n)o.unsubscribe()}}}isPureString(){return this.ast.length===0||this.ast.length===1&&this.ast[0][0]==="text"}getUsedVariables(){const e=new Set;return this.recursiveGetUsedVariables(this.ast,e),e}recursiveGetUsedVariables(e,n){for(const o of e){const r=o[0],a=o[1],s=o[4];["name","&","#","^"].includes(r)&&n.add(a),s!==void 0&&typeof s!="string"&&this.recursiveGetUsedVariables(s,n)}}}async function Je(){var t;const e=await We();for(const n of e){const o=(t=n.properties)!==null&&t!==void 0?t:[];for(const r of o){if(r.type==="int"||r.type==="bool"||r.type==="object"||typeof r.value!="string")continue;const a=new Ee(r.value,WA.state);if(a.isPureString())continue;const s=a.getValue();await pe(n.name,r.name,s),a.onChange(async i=>{await pe(n.name,r.name,i)})}}}async function et(){var t;const e=await O();for(const[n,o]of e.entries())if(o.type!=="objectgroup"){const r=(t=o.properties)!==null&&t!==void 0?t:[];for(const a of r){if(a.type==="int"||a.type==="bool"||a.type==="object"||typeof a.value!="string")continue;const s=new Ee(a.value,WA.state);if(s.isPureString())continue;const i=s.getValue();fe(n,a.name,i),s.onChange(c=>{fe(n,a.name,c)})}}}async function pe(t,e,n){console.log(t),(await WA.room.area.get(t)).setProperty(e,n)}function fe(t,e,n){WA.room.setProperty(t,e,n),e==="visible"&&(n?WA.room.showLayer(t):WA.room.hideLayer(t))}const tt="https://admin.workadventu.re/html";let te,re=0,ae=0;function he(t){if(WA.state[t.name]){let e=t.properties.mustGetString("openLayer");for(const n of e.split(`
`))WA.room.showLayer(n);e=t.properties.mustGetString("closeLayer");for(const n of e.split(`
`))WA.room.hideLayer(n)}else{let e=t.properties.mustGetString("openLayer");for(const n of e.split(`
`))WA.room.hideLayer(n);e=t.properties.mustGetString("closeLayer");for(const n of e.split(`
`))WA.room.showLayer(n)}}function nt(t){const e=t.properties.getString("openSound"),n=t.properties.getNumber("soundRadius");let o=1;if(n){const r=Ce(t.properties.mustGetString("openLayer").split(`
`));if(r>n)return;o=1-r/n}e&&WA.sound.loadSound(e).play({volume:o})}function ot(t){const e=t.properties.getString("closeSound"),n=t.properties.getNumber("soundRadius");let o=1;if(n){const r=Ce(t.properties.mustGetString("closeLayer").split(`
`));if(r>n)return;o=1-r/n}e&&WA.sound.loadSound(e).play({volume:o})}function Se(t){return t.map(e=>te.get(e)).filter(e=>(e==null?void 0:e.type)==="tilelayer")}function Ce(t){const e=Se(t),n=Pe(e),o=((n.right-n.left)/2+n.left)*32,r=((n.bottom-n.top)/2+n.top)*32;return Math.sqrt(Math.pow(re-o,2)+Math.pow(ae-r,2))}function rt(t){WA.state.onVariableChange(t.name).subscribe(()=>{WA.state[t.name]?nt(t):ot(t),he(t)}),he(t)}function de(t,e,n,o){const r=t.name;let a,s,i=!1;const c=n.getString("tag");let u=!0;c&&!WA.player.tags.includes(c)&&(u=!1);const f=!!c;function y(){var l;a&&a.remove(),a=WA.ui.displayActionMessage({message:(l=n.getString("closeTriggerMessage"))!==null&&l!==void 0?l:"Press SPACE to close the door",callback:()=>{WA.state[e.name]=!1,v()}})}function v(){var l;a&&a.remove(),a=WA.ui.displayActionMessage({message:(l=n.getString("openTriggerMessage"))!==null&&l!==void 0?l:"Press SPACE to open the door",callback:()=>{WA.state[e.name]=!0,y()}})}function Q(){let l;if(t.type==="tilelayer")l=Pe(Se(e.properties.mustGetString("closeLayer").split(`
`)));else{if(t.x===void 0||t.y===void 0||t.width===void 0||t.height===void 0)throw new Error(`Doorstep zone "${t.name}" is missing x, y, width or height`);l={top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}s=WA.room.website.create({name:"doorKeypad"+r,url:o+"/keypad.html#"+encodeURIComponent(r),position:{x:l.right*32,y:l.top*32,width:32*3,height:32*4},allowApi:!0})}function T(){s&&(WA.room.website.delete(s.name),s=void 0)}function p(){if(i=!0,n.getBoolean("autoOpen")&&u){WA.state[e.name]=!0;return}if(!WA.state[e.name]&&(f&&!u||!f)&&(n.getString("code")||n.getString("codeVariable"))){Q();return}u&&(WA.state[e.name]?y():v())}function A(){i=!1,n.getBoolean("autoClose")&&(WA.state[e.name]=!1),a&&a.remove(),T()}t.type==="tilelayer"?(WA.room.onEnterLayer(r).subscribe(p),WA.room.onLeaveLayer(r).subscribe(A)):(WA.room.area.onEnter(r).subscribe(p),WA.room.area.onLeave(r).subscribe(A)),WA.state.onVariableChange(e.name).subscribe(()=>{i&&(!n.getBoolean("autoClose")&&WA.state[e.name]===!0&&y(),s&&WA.state[e.name]===!0&&T(),!n.getBoolean("autoOpen")&&WA.state[e.name]===!1&&v())})}function at(t){const e=t.properties.mustGetString("bellSound"),n=t.properties.getNumber("soundRadius");let o=1;if(n){const r=Math.sqrt(Math.pow(t.x-re,2)+Math.pow(t.y-ae,2));if(r>n)return;o=1-r/n}WA.sound.loadSound(e).play({volume:o})}function st(t){WA.state[t.name]===void 0&&(WA.state[t.name]=0),WA.state.onVariableChange(t.name).subscribe(()=>{WA.state[t.name]&&at(t)})}function ge(t,e,n){let o;const r=e.getString("bellPopup");if(n.type==="tilelayer"){const a=n.name;WA.room.onEnterLayer(a).subscribe(()=>{var s;r?o=WA.ui.openPopup(r,"",[{label:(s=e.getString("bellButtonText"))!==null&&s!==void 0?s:"Ring",callback:()=>{WA.state[t]=WA.state[t]+1}}]):WA.state[t]=WA.state[t]+1}),WA.room.onLeaveLayer(a).subscribe(()=>{o&&(o.close(),o=void 0)})}else{const a=n.name;WA.room.area.onEnter(a).subscribe(()=>{var s;r?o=WA.ui.openPopup(r,"",[{label:(s=e.getString("bellButtonText"))!==null&&s!==void 0?s:"Ring",callback:()=>{WA.state[t]=WA.state[t]+1}}]):WA.state[t]=WA.state[t]+1}),WA.room.area.onLeave(a).subscribe(()=>{o&&(o.close(),o=void 0)})}}async function it(t){t=t??tt;const e=await xe();te=await O();for(const n of e.values())n.properties.get("door")&&rt(n),n.properties.get("bell")&&st(n);for(const n of te.values()){const o=new R(n.properties),r=o.getString("doorVariable");if(r&&n.type==="tilelayer"){const s=e.get(r);if(s===void 0)throw new Error('Cannot find variable "'+r+'" referred in the "doorVariable" property of layer "'+n.name+'"');de(n,s,o,t)}const a=o.getString("bellVariable");a&&n.type==="tilelayer"&&ge(a,o,n)}for(const n of await We()){const o=new R(n.properties),r=o.getString("doorVariable");if(r){const s=e.get(r);if(s===void 0)throw new Error('Cannot find variable "'+r+'" referred in the "doorVariable" property of object "'+n.name+'"');de(n,s,o,t)}const a=o.getString("bellVariable");a&&ge(a,o,n)}WA.player.onPlayerMove(n=>{re=n.x,ae=n.y})}function ct(t,e){const n=t.getString("bindVariable");if(n){const o=t.get("enterValue"),r=t.get("leaveValue"),a=t.getString("triggerMessage"),s=t.getString("tag");lt(n,e,o,r,a,s)}}let V;function lt(t,e,n,o,r,a){a&&!WA.player.tags.includes(a)||(n!==void 0&&WA.room.onEnterLayer(e).subscribe(()=>{r?V=WA.ui.displayActionMessage({type:"message",message:r,callback:()=>{WA.state[t]=n}}):WA.state[t]=n}),o!==void 0&&WA.room.onLeaveLayer(e).subscribe(()=>{WA.state[t]=o,V&&(V.remove().catch(s=>{console.error(s)}),V=void 0)}))}async function ut(){const t=await O();for(const e of t.values()){const n=new R(e.properties);ct(n,e.name)}}let ye;async function pt(t){const e=await WA.room.getTiledMap();t=t??Ae,ye=await O();const n=e.layers.find(o=>o.name==="configuration");if(n){const r=new R(n.properties).getString("tag");(!r||WA.player.tags.includes(r))&&WA.ui.registerMenuCommand("Configure the room",()=>{WA.nav.openCoWebSite(t+"/configuration.html",!0)});for(const a of ye.values()){const s=new R(a.properties),i=s.getString("openConfig");i&&a.type==="tilelayer"&&ft(i.split(","),a.name,s)}}}function ft(t,e,n){let o;const r=n.getString("openConfigAdminTag");let a=!0;r&&!WA.player.tags.includes(r)&&(a=!1);function s(){var c;o&&o.remove(),o=WA.ui.displayActionMessage({message:(c=n.getString("openConfigTriggerMessage"))!==null&&c!==void 0?c:"Press SPACE or touch here to configure",callback:()=>ce(t)})}function i(){WA.nav.closeCoWebSite()}WA.room.onEnterLayer(e).subscribe(()=>{const c=n.getString("openConfigTrigger");a&&(c&&c==="onaction"?s():ce(t))}),WA.room.onLeaveLayer(e).subscribe(()=>{o&&o.remove(),i()})}function ht(){return WA.onInit().then(()=>{it().catch(t=>console.error(t)),ut().catch(t=>console.error(t)),pt().catch(t=>console.error(t)),et().catch(t=>console.error(t)),Je().catch(t=>console.error(t))}).catch(t=>console.error(t))}let S;function dt(){WA.room.area.onEnter("clock").subscribe(()=>{const t=new Date,e=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0");S&&S.close(),S=WA.ui.openPopup("clockPopup",`It's ${e}:${n}`,[])}),WA.room.area.onLeave("clock").subscribe(()=>{S&&(S.close(),S=void 0)})}let N;function gt(){const t=()=>{N&&(N.close(),N=void 0)};WA.room.area.onEnter("board").subscribe(()=>{t();const e="The bulletin board hums with strange energy. Five portals shimmer before youâ€”choose your path: ðŸ’œ Malware â€” malicious code that corrupts, spies, and destroys â€¢ ðŸ”µ Phishing/Quishing â€” fake messages or QR Codes that trick you into giving secrets â€¢ ðŸ”´ Identity Theft â€” criminals using your identity â€¢ ðŸŸ¡ xxxxxxxxxxxx â€¢ ðŸ’š Password Security â€” strong, unique passwords and MFA to protect your accounts.";N=WA.ui.openPopup("boardPopup",e,[])}),WA.room.area.onLeave("board").subscribe(t)}let C;function Z(){var t;if(C){try{(t=C.close)==null||t.call(C)}catch{}C=void 0}}function yt(){var t,e;try{const n=(e=(t=WA.room.object)==null?void 0:t.get)==null?void 0:e.call(t,"MarvieZone");if(n&&n.properties){const o=n.properties;if(Array.isArray(o)){const r=o.find(a=>a.name==="marvieMessage"||a.name==="marviePopup");if(r!=null&&r.value)return String(r.value)}else if(o.marvieMessage)return String(o.marvieMessage)}}catch{}return["ðŸ‘‹ Hi â€” I'm Marvie.","","Welcome to the Room of Malware.","Do you think you can find the 3 easter eggs around the map?","Tip: Check the walls, the chairs or the floor for suspicious objects."].join(`
`)}function bt(){console.log("[Marvie] init"),WA.room.area.onEnter("MarvieZone").subscribe(()=>{Z();const t=yt();C=WA.ui.openPopup("marviePopup",t,[{label:"Got it",callback:()=>Z()}])}),WA.room.area.onLeave("MarvieZone").subscribe(()=>{Z()})}let w;const E=()=>{var t;try{(t=w==null?void 0:w.close)==null||t.call(w)}catch{}w=void 0};function mt(t,e){E();const n=(e||[]).map(o=>({label:o.label,callback:()=>{E();try{o.callback()}catch{}}}));return w=WA.ui.openPopup("QRcodePopup",t,n),w}const K=typeof globalThis.openNpcPopup=="function"?(t,e)=>(E(),w=globalThis.openNpcPopup(t,e),w):mt;function q(){K("You saw a QR code on the wall. CLAIM YOUR FREE POKEMON PACKS HERE!! Do you scan it?",[{label:"Yes",callback:vt},{label:"No",callback:At},{label:"What is quishing?",callback:wt}])}function vt(){K(`âš ï¸ Quishing (QR phishing): Scanning unknown QR codes can send you to fake login pages, trigger malicious downloads, or open payment requests.

Examples:
â€¢ Fake "Campus Wi-Fi" login that steals your credentials
â€¢ "Free voucher" QR that asks you to install a dodgy app.

Safer habit: Only scan trusted QRs, preview the link, or type the official URL yourself.`,[{label:"Back",callback:q},{label:"OK",callback:E}])}function At(){K('âœ… Correct! Avoid scanning random QR codes. This method of phishing is called "quishing". If a code looks suspicious or is a sticker placed over a poster, donâ€™t scan itâ€”navigate to the site yourself.',[{label:"Back",callback:q},{label:"OK",callback:E}])}function wt(){K(`Quishing = QR + phishing. Attackers plant QR codes in public places or messages to lure you to malicious sites.

Tips:
â€¢ Preview the URL before opening
â€¢ Check the exact domain (not just the logo)
â€¢ Never enter credentials after scanning an unknown QR`,[{label:"Back",callback:q},{label:"Close",callback:E}])}function kt(){WA.onInit().then(()=>{console.log("[qrcode] ready, listening for area 'QRcode'"),WA.room.area.onEnter("QRcode").subscribe(q),WA.room.area.onLeave("QRcode").subscribe(E)})}const Wt="MurdochEmailPopup";let m;function F(t,e){var n;try{(n=m==null?void 0:m.close)==null||n.call(m)}catch{}m=WA.ui.openPopup(Wt,t,e)}function _(){var t;try{(t=m==null?void 0:m.close)==null||t.call(m)}catch{}m=void 0}function $(){console.log("[MurdochEmail] askEmail()"),F('ðŸ“§ Email says: "Your university fees are overdue. Click here to pay immediately." What do you do?',[{label:"Click the link and pay",callback:Pt},{label:"Verify first (don't click)",callback:se},{label:"See red flags",callback:Me},{label:"Close",callback:_}])}function Pt(){console.log("[MurdochEmail] clicked()"),F(`âš ï¸ Risky. Classic phishing.

What can happen?
â€¢ Fake payment page steals your login or card
â€¢ Malware prompts
â€¢ "Update details" forms that harvest personal info

Safer: never pay from email links. Open the official portal yourself.`,[{label:"How to verify safely",callback:se},{label:"Back",callback:$},{label:"OK",callback:_}])}function se(){console.log("[MurdochEmail] verify()"),F(`âœ… Correct.

Verify steps:
â€¢ Check the sender domain carefully
â€¢ Preview the real link (hover/long-press)
â€¢ Type the official portal URL or use your bookmark
â€¢ Check balance inside the portal (not via the email link)
â€¢ If unsure, contact the uni via the official helpdesk`,[{label:"See red flags",callback:Me},{label:"Back",callback:$},{label:"Close",callback:_}])}function Me(){console.log("[MurdochEmail] flags()"),F(`Common red flags:
â€¢ Urgent language / threats ("immediately", "final notice")
â€¢ Look-alike sender domains
â€¢ Links that don't match the uni's real domain
â€¢ Attachments/QRs to "pay faster"
â€¢ Requests for card/bank info or passwords via email`,[{label:"Verify safely",callback:se},{label:"Back",callback:$},{label:"Close",callback:_}])}function Et(){WA.onInit().then(()=>{console.log("[MurdochEmail] ready â†’ listening for area 'MurdochEmail'"),WA.room.area.onEnter("MurdochEmail").subscribe(()=>{console.log("[MurdochEmail] onEnter"),$()}),WA.room.area.onLeave("MurdochEmail").subscribe(()=>{console.log("[MurdochEmail] onLeave"),_()})})}let U;function St(){const t="BrockZonePopup",e=()=>{U&&(U.close(),U=void 0)};WA.room.area.onEnter("BrockZone").subscribe(()=>{e();const n="Brock: Hey there! Please don't go! Are you sure you have all things about phishing understood?";U=WA.ui.openPopup(t,n,[])}),WA.room.area.onLeave("BrockZone").subscribe(e)}let D;function be(){D&&(D.close(),D=void 0)}function Ct(){WA.room.area.onEnter("billboard").subscribe(()=>{be(),D=WA.ui.openPopup("billboardPopup",`ðŸ“œ The community billboard

âž¡ï¸ Move towards the ladder on the right and begin your adventure!`,[])}),WA.room.area.onLeave("billboard").subscribe(()=>{be()})}let H;function Mt(){WA.onInit().then(()=>{console.log("[WA] Instructions ready"),me(),WA.room.area.onEnter("instructions").subscribe(()=>{me()}),WA.room.area.onLeave("instructions").subscribe(()=>{Re()})})}function me(){Re(),H=WA.ui.openPopup("instructionsPopup","ðŸ‘‹ Welcome Ranger! Use the Arrow Keys or WASD to move around. Walk close to objects such as signs, boards, or NPCs to interact with them. Sometimes you will need to press SPACE to open a dialogue or a side panel with more details. Explore the garden and see what you can discover! REMEMBER! Check the signboard for more info.",[{label:"Letâ€™s go!",className:"primary",callback:t=>t.close()}])}function Re(){H&&(H.close(),H=void 0)}let M;function Rt(){WA.onInit().then(()=>{console.log("[WA] Phishing Instructions ready"),Lt(),WA.room.area.onLeave("instructions_phishing").subscribe(()=>{Le()})})}function Lt(){Le(),M=WA.ui.openPopup("instructions_phishingPopup",`ðŸŽ£ Welcome to the Phishing Room!

There are 3 hidden easter eggs in this room â€” can you find them all?

Before you leave, talk to the NPC to learn more in-depth about phishing:
- How attackers trick you
- How to spot scams
- Simple steps to stay safe

Good luck and stay curious!`,[])}function Le(){var t;M&&((t=M.close)==null||t.call(M),M=void 0)}const h={blackbibleppt:!1,MurdochEmail:!1,QRcode:!1,BrockZone:!1},ve="to-canteen",Bt="canteen.tmj#spawn",Tt="phishing_gate_popup",xt="phishing_progress_popup",It=["instructions_phishingPopup","MurdochEmailPopup"];let P,ne=[];function Ot(){WA.onInit().then(()=>{console.log("[LibraryProgress] ready"),J(),["blackbibleppt","MurdochEmail","QRcode"].forEach(t=>{WA.room.area.onEnter(t).subscribe(()=>{h[t]||(h[t]=!0,J())})}),WA.room.area.onEnter("BrockZone").subscribe(()=>{h.BrockZone||(h.BrockZone=!0,J())}),WA.room.area.onEnter(ve).subscribe(()=>{if(Qt())ee(),_t(),WA.nav.goToRoom(Bt);else{const t=`ðŸš§ Hold up!

You still need to complete:
â€¢ ${Gt().join(`
â€¢ `)}

Find all 3 easter eggs and talk to Brock before leaving.`;ee(),P=ie(Tt,t,[{label:"OK",className:"primary",callback:e=>e.close()}])}}),WA.room.area.onLeave(ve).subscribe(()=>{ee()})})}function J(){const e=`Progress:  ${[h.blackbibleppt?"âœ… BlackBible":"â¬œ BlackBible",h.MurdochEmail?"âœ… MurdochEmail":"â¬œ MurdochEmail",h.QRcode?"âœ… QRcode":"â¬œ QRcode",h.BrockZone?"âœ… Brock (NPC)":"â¬œ Brock (NPC)"].join("   ")}

Visit all 3 easter eggs and talk to Brock to unlock the exit.`,n=ie(xt,e,[])||jt(It,e)||(WA.ui.displayActionMessage({message:e,callback:()=>{}}),void 0);n&&ne.push(n)}function jt(t,e){for(const n of t){const o=ie(n,e,[]);if(o)return o}}function ie(t,e,n){try{return WA.ui.openPopup(t,e,n)}catch{return}}function _t(){var t;for(const e of ne)try{(t=e==null?void 0:e.close)==null||t.call(e)}catch{}ne=[]}function ee(){var t;try{(t=P==null?void 0:P.close)==null||t.call(P)}catch{}P=void 0}function Qt(){return h.blackbibleppt&&h.MurdochEmail&&h.QRcode&&h.BrockZone}function Gt(){const t=[];return h.blackbibleppt||t.push("Black Bible Easter Egg"),h.MurdochEmail||t.push("Murdoch Email Easter Egg"),h.QRcode||t.push("QR Code Easter Egg"),h.BrockZone||t.push("Talk to Brock (NPC)"),t}console.log("Script started");WA.onInit().then(async()=>{console.log("Scripting API ready"),await ht(),dt(),gt(),bt(),kt(),Et(),St(),Ct(),Mt(),Rt(),Ot()});
//# sourceMappingURL=main-1860470a.js.map
