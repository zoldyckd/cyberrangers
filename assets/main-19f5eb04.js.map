{"version":3,"file":"main-19f5eb04.js","sources":["../../node_modules/@workadventure/scripting-api-extra/dist/Properties.js","../../node_modules/@workadventure/scripting-api-extra/dist/Features/default_assets_url.js","../../node_modules/@workadventure/scripting-api-extra/dist/VariablesExtra.js","../../node_modules/@workadventure/scripting-api-extra/dist/LayersFlattener.js","../../node_modules/@workadventure/scripting-api-extra/dist/AreaObject.js","../../node_modules/@workadventure/scripting-api-extra/dist/LayersExtra.js","../../node_modules/mustache/mustache.mjs","../../node_modules/@workadventure/scripting-api-extra/dist/TemplateValue.js","../../node_modules/@workadventure/scripting-api-extra/dist/Features/properties_templates.js","../../node_modules/@workadventure/scripting-api-extra/dist/Features/workadventure_assets_url.js","../../node_modules/@workadventure/scripting-api-extra/dist/Features/doors.js","../../node_modules/@workadventure/scripting-api-extra/dist/Features/variable_actions.js","../../node_modules/@workadventure/scripting-api-extra/dist/Features/special_properties.js","../../node_modules/@workadventure/scripting-api-extra/dist/Features/configuration.js","../../node_modules/@workadventure/scripting-api-extra/dist/init.js","../../src/clock.ts","../../src/board.ts","../../src/marvie.ts","../../src/phishing_qrcode.ts","../../src/phishing_murdochemail.ts","../../src/phishing_smsphishing.ts","../../src/phishing_libraryprogress.ts","../../src/phishing_instructions.ts","../../src/phishing_librarySpawnNote.ts","../../src/phishing_brock.ts","../../src/billboard.ts","../../src/spawnIntro.ts","../../src/instructions.ts","../../src/poster.ts","../../src/usbdrive.ts","../../src/stickynote.ts","../../src/instructions_safeinternetpractices.ts","../../src/officeprogress.ts","../../src/main.ts"],"sourcesContent":["export class Properties {\n    constructor(properties) {\n        this.properties = properties !== null && properties !== void 0 ? properties : [];\n    }\n    get(name) {\n        const values = this.properties\n            .filter((property) => property.name === name)\n            .map((property) => property.value);\n        if (values.length > 1) {\n            throw new Error('Expected only one property to be named \"' + name + '\"');\n        }\n        if (values.length === 0) {\n            return undefined;\n        }\n        return values[0];\n    }\n    getString(name) {\n        return this.getByType(name, \"string\");\n    }\n    getNumber(name) {\n        return this.getByType(name, \"number\");\n    }\n    getBoolean(name) {\n        return this.getByType(name, \"boolean\");\n    }\n    getByType(name, type) {\n        const value = this.get(name);\n        if (value === undefined) {\n            return undefined;\n        }\n        if (type !== \"json\" && typeof value !== type) {\n            throw new Error('Expected property \"' + name + '\" to have type \"' + type + '\"');\n        }\n        return value;\n    }\n    mustGetString(name) {\n        return this.mustGetByType(name, \"string\");\n    }\n    mustGetNumber(name) {\n        return this.mustGetByType(name, \"number\");\n    }\n    mustGetBoolean(name) {\n        return this.mustGetByType(name, \"boolean\");\n    }\n    mustGetByType(name, type) {\n        const value = this.get(name);\n        if (value === undefined) {\n            throw new Error('Property \"' + name + '\" is missing');\n        }\n        if (type !== \"json\" && typeof value !== type) {\n            throw new Error('Expected property \"' + name + '\" to have type \"' + type + '\"');\n        }\n        return value;\n    }\n    getType(name) {\n        const types = this.properties\n            .filter((property) => property.name === name)\n            .map((property) => property.type);\n        if (types.length > 1) {\n            throw new Error('Expected only one property to be named \"' + name + '\"');\n        }\n        if (types.length === 0) {\n            return undefined;\n        }\n        return types[0];\n    }\n}\n//# sourceMappingURL=Properties.js.map","export const defaultAssetsUrl = \"https://unpkg.com/@workadventure/scripting-api-extra@1.9.10/dist\";\n//# sourceMappingURL=default_assets_url.js.map","import { Properties } from \"./Properties\";\nimport { defaultAssetsUrl } from \"./Features/default_assets_url\";\nexport class VariableDescriptor {\n    constructor(object) {\n        this.name = object.name;\n        this.x = object.x;\n        this.y = object.y;\n        this.properties = new Properties(object.properties);\n    }\n    get isReadable() {\n        const readableBy = this.properties.getString(\"readableBy\");\n        if (!readableBy) {\n            return true;\n        }\n        return WA.player.tags.includes(readableBy);\n    }\n    get isWritable() {\n        const writableBy = this.properties.getString(\"writableBy\");\n        if (!writableBy) {\n            return true;\n        }\n        return WA.player.tags.includes(writableBy);\n    }\n}\nexport function openConfig(variables) {\n    const parameters = variables ? \"#\" + variables.join() : \"\";\n    WA.nav.openCoWebSite(defaultAssetsUrl + \"/configuration.html\" + parameters, true);\n}\nexport async function getVariables(layerFilter, variablesFilter) {\n    const map = await WA.room.getTiledMap();\n    const variables = new Map();\n    getAllVariablesRecursive(map.layers, variables, layerFilter, variablesFilter);\n    return variables;\n}\nfunction getAllVariablesRecursive(layers, variables, layerFilter, variablesFilter) {\n    for (const layer of layers) {\n        if (layer.type === \"objectgroup\") {\n            for (const object of layer.objects) {\n                if (object.type === \"variable\" || object.class === \"variable\") {\n                    if (!!layerFilter && layer.name !== layerFilter)\n                        continue;\n                    if (!!variablesFilter && !variablesFilter.includes(object.name))\n                        continue;\n                    variables.set(object.name, new VariableDescriptor(object));\n                }\n            }\n        }\n        else if (layer.type === \"group\") {\n            getAllVariablesRecursive(layer.layers, variables, layerFilter, variablesFilter);\n        }\n    }\n}\n//# sourceMappingURL=VariablesExtra.js.map","let layersMapPromise = undefined;\nexport async function getLayersMap() {\n    if (layersMapPromise === undefined) {\n        layersMapPromise = getLayersMapWithoutCache();\n    }\n    return layersMapPromise;\n}\nasync function getLayersMapWithoutCache() {\n    return flattenGroupLayersMap((await WA.room.getTiledMap()));\n}\nfunction flattenGroupLayersMap(map) {\n    const flatLayers = new Map();\n    flattenGroupLayers(map.layers, \"\", flatLayers);\n    return flatLayers;\n}\nfunction flattenGroupLayers(layers, prefix, flatLayers) {\n    for (const layer of layers) {\n        if (layer.type === \"group\") {\n            flattenGroupLayers(layer.layers, prefix + layer.name + \"/\", flatLayers);\n        }\n        else {\n            layer.name = prefix + layer.name;\n            flatLayers.set(layer.name, layer);\n        }\n    }\n}\n//# sourceMappingURL=LayersFlattener.js.map","import { getLayersMap } from \"./LayersFlattener\";\nexport async function getAreaObject() {\n    const layers = await getLayersMap();\n    const areaArray = [];\n    for (const layer of layers.values()) {\n        if (layer.type === \"objectgroup\") {\n            for (const object of layer.objects) {\n                if (object.type === \"area\" || object.class === \"area\") {\n                    areaArray.push(object);\n                }\n            }\n        }\n    }\n    return areaArray;\n}\n//# sourceMappingURL=AreaObject.js.map","export function findLayerBoundaries(layer) {\n    let left = Infinity;\n    let top = Infinity;\n    let bottom = 0;\n    let right = 0;\n    const data = layer.data;\n    if (typeof data === \"string\") {\n        throw new Error(\"Unsupported tile layer data stored as string instead of CSV\");\n    }\n    for (let j = 0; j < layer.height; j++) {\n        for (let i = 0; i < layer.width; i++) {\n            if (data[i + j * layer.width] !== 0) {\n                left = Math.min(left, i);\n                right = Math.max(right, i);\n                top = Math.min(top, j);\n                bottom = Math.max(bottom, j);\n            }\n        }\n    }\n    return {\n        top,\n        left,\n        right: right + 1,\n        bottom: bottom + 1,\n    };\n}\nexport function findLayersBoundaries(layers) {\n    let left = Infinity;\n    let top = Infinity;\n    let bottom = 0;\n    let right = 0;\n    for (const layer of layers) {\n        const boundaries = findLayerBoundaries(layer);\n        if (boundaries.left < left) {\n            left = boundaries.left;\n        }\n        if (boundaries.top < top) {\n            top = boundaries.top;\n        }\n        if (boundaries.right > right) {\n            right = boundaries.right;\n        }\n        if (boundaries.bottom > bottom) {\n            bottom = boundaries.bottom;\n        }\n    }\n    return {\n        top,\n        left,\n        right,\n        bottom,\n    };\n}\n//# sourceMappingURL=LayersExtra.js.map","/*!\n * mustache.js - Logic-less {{mustache}} templates with JavaScript\n * http://github.com/janl/mustache.js\n */\n\nvar objectToString = Object.prototype.toString;\nvar isArray = Array.isArray || function isArrayPolyfill (object) {\n  return objectToString.call(object) === '[object Array]';\n};\n\nfunction isFunction (object) {\n  return typeof object === 'function';\n}\n\n/**\n * More correct typeof string handling array\n * which normally returns typeof 'object'\n */\nfunction typeStr (obj) {\n  return isArray(obj) ? 'array' : typeof obj;\n}\n\nfunction escapeRegExp (string) {\n  return string.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, '\\\\$&');\n}\n\n/**\n * Null safe way of checking whether or not an object,\n * including its prototype, has a given property\n */\nfunction hasProperty (obj, propName) {\n  return obj != null && typeof obj === 'object' && (propName in obj);\n}\n\n/**\n * Safe way of detecting whether or not the given thing is a primitive and\n * whether it has the given property\n */\nfunction primitiveHasOwnProperty (primitive, propName) {\n  return (\n    primitive != null\n    && typeof primitive !== 'object'\n    && primitive.hasOwnProperty\n    && primitive.hasOwnProperty(propName)\n  );\n}\n\n// Workaround for https://issues.apache.org/jira/browse/COUCHDB-577\n// See https://github.com/janl/mustache.js/issues/189\nvar regExpTest = RegExp.prototype.test;\nfunction testRegExp (re, string) {\n  return regExpTest.call(re, string);\n}\n\nvar nonSpaceRe = /\\S/;\nfunction isWhitespace (string) {\n  return !testRegExp(nonSpaceRe, string);\n}\n\nvar entityMap = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;',\n  '/': '&#x2F;',\n  '`': '&#x60;',\n  '=': '&#x3D;'\n};\n\nfunction escapeHtml (string) {\n  return String(string).replace(/[&<>\"'`=\\/]/g, function fromEntityMap (s) {\n    return entityMap[s];\n  });\n}\n\nvar whiteRe = /\\s*/;\nvar spaceRe = /\\s+/;\nvar equalsRe = /\\s*=/;\nvar curlyRe = /\\s*\\}/;\nvar tagRe = /#|\\^|\\/|>|\\{|&|=|!/;\n\n/**\n * Breaks up the given `template` string into a tree of tokens. If the `tags`\n * argument is given here it must be an array with two string values: the\n * opening and closing tags used in the template (e.g. [ \"<%\", \"%>\" ]). Of\n * course, the default is to use mustaches (i.e. mustache.tags).\n *\n * A token is an array with at least 4 elements. The first element is the\n * mustache symbol that was used inside the tag, e.g. \"#\" or \"&\". If the tag\n * did not contain a symbol (i.e. {{myValue}}) this element is \"name\". For\n * all text that appears outside a symbol this element is \"text\".\n *\n * The second element of a token is its \"value\". For mustache tags this is\n * whatever else was inside the tag besides the opening symbol. For text tokens\n * this is the text itself.\n *\n * The third and fourth elements of the token are the start and end indices,\n * respectively, of the token in the original template.\n *\n * Tokens that are the root node of a subtree contain two more elements: 1) an\n * array of tokens in the subtree and 2) the index in the original template at\n * which the closing tag for that section begins.\n *\n * Tokens for partials also contain two more elements: 1) a string value of\n * indendation prior to that tag and 2) the index of that tag on that line -\n * eg a value of 2 indicates the partial is the third tag on this line.\n */\nfunction parseTemplate (template, tags) {\n  if (!template)\n    return [];\n  var lineHasNonSpace = false;\n  var sections = [];     // Stack to hold section tokens\n  var tokens = [];       // Buffer to hold the tokens\n  var spaces = [];       // Indices of whitespace tokens on the current line\n  var hasTag = false;    // Is there a {{tag}} on the current line?\n  var nonSpace = false;  // Is there a non-space char on the current line?\n  var indentation = '';  // Tracks indentation for tags that use it\n  var tagIndex = 0;      // Stores a count of number of tags encountered on a line\n\n  // Strips all whitespace tokens array for the current line\n  // if there was a {{#tag}} on it and otherwise only space.\n  function stripSpace () {\n    if (hasTag && !nonSpace) {\n      while (spaces.length)\n        delete tokens[spaces.pop()];\n    } else {\n      spaces = [];\n    }\n\n    hasTag = false;\n    nonSpace = false;\n  }\n\n  var openingTagRe, closingTagRe, closingCurlyRe;\n  function compileTags (tagsToCompile) {\n    if (typeof tagsToCompile === 'string')\n      tagsToCompile = tagsToCompile.split(spaceRe, 2);\n\n    if (!isArray(tagsToCompile) || tagsToCompile.length !== 2)\n      throw new Error('Invalid tags: ' + tagsToCompile);\n\n    openingTagRe = new RegExp(escapeRegExp(tagsToCompile[0]) + '\\\\s*');\n    closingTagRe = new RegExp('\\\\s*' + escapeRegExp(tagsToCompile[1]));\n    closingCurlyRe = new RegExp('\\\\s*' + escapeRegExp('}' + tagsToCompile[1]));\n  }\n\n  compileTags(tags || mustache.tags);\n\n  var scanner = new Scanner(template);\n\n  var start, type, value, chr, token, openSection;\n  while (!scanner.eos()) {\n    start = scanner.pos;\n\n    // Match any text between tags.\n    value = scanner.scanUntil(openingTagRe);\n\n    if (value) {\n      for (var i = 0, valueLength = value.length; i < valueLength; ++i) {\n        chr = value.charAt(i);\n\n        if (isWhitespace(chr)) {\n          spaces.push(tokens.length);\n          indentation += chr;\n        } else {\n          nonSpace = true;\n          lineHasNonSpace = true;\n          indentation += ' ';\n        }\n\n        tokens.push([ 'text', chr, start, start + 1 ]);\n        start += 1;\n\n        // Check for whitespace on the current line.\n        if (chr === '\\n') {\n          stripSpace();\n          indentation = '';\n          tagIndex = 0;\n          lineHasNonSpace = false;\n        }\n      }\n    }\n\n    // Match the opening tag.\n    if (!scanner.scan(openingTagRe))\n      break;\n\n    hasTag = true;\n\n    // Get the tag type.\n    type = scanner.scan(tagRe) || 'name';\n    scanner.scan(whiteRe);\n\n    // Get the tag value.\n    if (type === '=') {\n      value = scanner.scanUntil(equalsRe);\n      scanner.scan(equalsRe);\n      scanner.scanUntil(closingTagRe);\n    } else if (type === '{') {\n      value = scanner.scanUntil(closingCurlyRe);\n      scanner.scan(curlyRe);\n      scanner.scanUntil(closingTagRe);\n      type = '&';\n    } else {\n      value = scanner.scanUntil(closingTagRe);\n    }\n\n    // Match the closing tag.\n    if (!scanner.scan(closingTagRe))\n      throw new Error('Unclosed tag at ' + scanner.pos);\n\n    if (type == '>') {\n      token = [ type, value, start, scanner.pos, indentation, tagIndex, lineHasNonSpace ];\n    } else {\n      token = [ type, value, start, scanner.pos ];\n    }\n    tagIndex++;\n    tokens.push(token);\n\n    if (type === '#' || type === '^') {\n      sections.push(token);\n    } else if (type === '/') {\n      // Check section nesting.\n      openSection = sections.pop();\n\n      if (!openSection)\n        throw new Error('Unopened section \"' + value + '\" at ' + start);\n\n      if (openSection[1] !== value)\n        throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + start);\n    } else if (type === 'name' || type === '{' || type === '&') {\n      nonSpace = true;\n    } else if (type === '=') {\n      // Set the tags for the next time around.\n      compileTags(value);\n    }\n  }\n\n  stripSpace();\n\n  // Make sure there are no open sections when we're done.\n  openSection = sections.pop();\n\n  if (openSection)\n    throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + scanner.pos);\n\n  return nestTokens(squashTokens(tokens));\n}\n\n/**\n * Combines the values of consecutive text tokens in the given `tokens` array\n * to a single token.\n */\nfunction squashTokens (tokens) {\n  var squashedTokens = [];\n\n  var token, lastToken;\n  for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n    token = tokens[i];\n\n    if (token) {\n      if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {\n        lastToken[1] += token[1];\n        lastToken[3] = token[3];\n      } else {\n        squashedTokens.push(token);\n        lastToken = token;\n      }\n    }\n  }\n\n  return squashedTokens;\n}\n\n/**\n * Forms the given array of `tokens` into a nested tree structure where\n * tokens that represent a section have two additional items: 1) an array of\n * all tokens that appear in that section and 2) the index in the original\n * template that represents the end of that section.\n */\nfunction nestTokens (tokens) {\n  var nestedTokens = [];\n  var collector = nestedTokens;\n  var sections = [];\n\n  var token, section;\n  for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n    token = tokens[i];\n\n    switch (token[0]) {\n      case '#':\n      case '^':\n        collector.push(token);\n        sections.push(token);\n        collector = token[4] = [];\n        break;\n      case '/':\n        section = sections.pop();\n        section[5] = token[2];\n        collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;\n        break;\n      default:\n        collector.push(token);\n    }\n  }\n\n  return nestedTokens;\n}\n\n/**\n * A simple string scanner that is used by the template parser to find\n * tokens in template strings.\n */\nfunction Scanner (string) {\n  this.string = string;\n  this.tail = string;\n  this.pos = 0;\n}\n\n/**\n * Returns `true` if the tail is empty (end of string).\n */\nScanner.prototype.eos = function eos () {\n  return this.tail === '';\n};\n\n/**\n * Tries to match the given regular expression at the current position.\n * Returns the matched text if it can match, the empty string otherwise.\n */\nScanner.prototype.scan = function scan (re) {\n  var match = this.tail.match(re);\n\n  if (!match || match.index !== 0)\n    return '';\n\n  var string = match[0];\n\n  this.tail = this.tail.substring(string.length);\n  this.pos += string.length;\n\n  return string;\n};\n\n/**\n * Skips all text until the given regular expression can be matched. Returns\n * the skipped string, which is the entire tail if no match can be made.\n */\nScanner.prototype.scanUntil = function scanUntil (re) {\n  var index = this.tail.search(re), match;\n\n  switch (index) {\n    case -1:\n      match = this.tail;\n      this.tail = '';\n      break;\n    case 0:\n      match = '';\n      break;\n    default:\n      match = this.tail.substring(0, index);\n      this.tail = this.tail.substring(index);\n  }\n\n  this.pos += match.length;\n\n  return match;\n};\n\n/**\n * Represents a rendering context by wrapping a view object and\n * maintaining a reference to the parent context.\n */\nfunction Context (view, parentContext) {\n  this.view = view;\n  this.cache = { '.': this.view };\n  this.parent = parentContext;\n}\n\n/**\n * Creates a new context using the given view with this context\n * as the parent.\n */\nContext.prototype.push = function push (view) {\n  return new Context(view, this);\n};\n\n/**\n * Returns the value of the given name in this context, traversing\n * up the context hierarchy if the value is absent in this context's view.\n */\nContext.prototype.lookup = function lookup (name) {\n  var cache = this.cache;\n\n  var value;\n  if (cache.hasOwnProperty(name)) {\n    value = cache[name];\n  } else {\n    var context = this, intermediateValue, names, index, lookupHit = false;\n\n    while (context) {\n      if (name.indexOf('.') > 0) {\n        intermediateValue = context.view;\n        names = name.split('.');\n        index = 0;\n\n        /**\n         * Using the dot notion path in `name`, we descend through the\n         * nested objects.\n         *\n         * To be certain that the lookup has been successful, we have to\n         * check if the last object in the path actually has the property\n         * we are looking for. We store the result in `lookupHit`.\n         *\n         * This is specially necessary for when the value has been set to\n         * `undefined` and we want to avoid looking up parent contexts.\n         *\n         * In the case where dot notation is used, we consider the lookup\n         * to be successful even if the last \"object\" in the path is\n         * not actually an object but a primitive (e.g., a string, or an\n         * integer), because it is sometimes useful to access a property\n         * of an autoboxed primitive, such as the length of a string.\n         **/\n        while (intermediateValue != null && index < names.length) {\n          if (index === names.length - 1)\n            lookupHit = (\n              hasProperty(intermediateValue, names[index])\n              || primitiveHasOwnProperty(intermediateValue, names[index])\n            );\n\n          intermediateValue = intermediateValue[names[index++]];\n        }\n      } else {\n        intermediateValue = context.view[name];\n\n        /**\n         * Only checking against `hasProperty`, which always returns `false` if\n         * `context.view` is not an object. Deliberately omitting the check\n         * against `primitiveHasOwnProperty` if dot notation is not used.\n         *\n         * Consider this example:\n         * ```\n         * Mustache.render(\"The length of a football field is {{#length}}{{length}}{{/length}}.\", {length: \"100 yards\"})\n         * ```\n         *\n         * If we were to check also against `primitiveHasOwnProperty`, as we do\n         * in the dot notation case, then render call would return:\n         *\n         * \"The length of a football field is 9.\"\n         *\n         * rather than the expected:\n         *\n         * \"The length of a football field is 100 yards.\"\n         **/\n        lookupHit = hasProperty(context.view, name);\n      }\n\n      if (lookupHit) {\n        value = intermediateValue;\n        break;\n      }\n\n      context = context.parent;\n    }\n\n    cache[name] = value;\n  }\n\n  if (isFunction(value))\n    value = value.call(this.view);\n\n  return value;\n};\n\n/**\n * A Writer knows how to take a stream of tokens and render them to a\n * string, given a context. It also maintains a cache of templates to\n * avoid the need to parse the same template twice.\n */\nfunction Writer () {\n  this.templateCache = {\n    _cache: {},\n    set: function set (key, value) {\n      this._cache[key] = value;\n    },\n    get: function get (key) {\n      return this._cache[key];\n    },\n    clear: function clear () {\n      this._cache = {};\n    }\n  };\n}\n\n/**\n * Clears all cached templates in this writer.\n */\nWriter.prototype.clearCache = function clearCache () {\n  if (typeof this.templateCache !== 'undefined') {\n    this.templateCache.clear();\n  }\n};\n\n/**\n * Parses and caches the given `template` according to the given `tags` or\n * `mustache.tags` if `tags` is omitted,  and returns the array of tokens\n * that is generated from the parse.\n */\nWriter.prototype.parse = function parse (template, tags) {\n  var cache = this.templateCache;\n  var cacheKey = template + ':' + (tags || mustache.tags).join(':');\n  var isCacheEnabled = typeof cache !== 'undefined';\n  var tokens = isCacheEnabled ? cache.get(cacheKey) : undefined;\n\n  if (tokens == undefined) {\n    tokens = parseTemplate(template, tags);\n    isCacheEnabled && cache.set(cacheKey, tokens);\n  }\n  return tokens;\n};\n\n/**\n * High-level method that is used to render the given `template` with\n * the given `view`.\n *\n * The optional `partials` argument may be an object that contains the\n * names and templates of partials that are used in the template. It may\n * also be a function that is used to load partial templates on the fly\n * that takes a single argument: the name of the partial.\n *\n * If the optional `config` argument is given here, then it should be an\n * object with a `tags` attribute or an `escape` attribute or both.\n * If an array is passed, then it will be interpreted the same way as\n * a `tags` attribute on a `config` object.\n *\n * The `tags` attribute of a `config` object must be an array with two\n * string values: the opening and closing tags used in the template (e.g.\n * [ \"<%\", \"%>\" ]). The default is to mustache.tags.\n *\n * The `escape` attribute of a `config` object must be a function which\n * accepts a string as input and outputs a safely escaped string.\n * If an `escape` function is not provided, then an HTML-safe string\n * escaping function is used as the default.\n */\nWriter.prototype.render = function render (template, view, partials, config) {\n  var tags = this.getConfigTags(config);\n  var tokens = this.parse(template, tags);\n  var context = (view instanceof Context) ? view : new Context(view, undefined);\n  return this.renderTokens(tokens, context, partials, template, config);\n};\n\n/**\n * Low-level method that renders the given array of `tokens` using\n * the given `context` and `partials`.\n *\n * Note: The `originalTemplate` is only ever used to extract the portion\n * of the original template that was contained in a higher-order section.\n * If the template doesn't use higher-order sections, this argument may\n * be omitted.\n */\nWriter.prototype.renderTokens = function renderTokens (tokens, context, partials, originalTemplate, config) {\n  var buffer = '';\n\n  var token, symbol, value;\n  for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n    value = undefined;\n    token = tokens[i];\n    symbol = token[0];\n\n    if (symbol === '#') value = this.renderSection(token, context, partials, originalTemplate, config);\n    else if (symbol === '^') value = this.renderInverted(token, context, partials, originalTemplate, config);\n    else if (symbol === '>') value = this.renderPartial(token, context, partials, config);\n    else if (symbol === '&') value = this.unescapedValue(token, context);\n    else if (symbol === 'name') value = this.escapedValue(token, context, config);\n    else if (symbol === 'text') value = this.rawValue(token);\n\n    if (value !== undefined)\n      buffer += value;\n  }\n\n  return buffer;\n};\n\nWriter.prototype.renderSection = function renderSection (token, context, partials, originalTemplate, config) {\n  var self = this;\n  var buffer = '';\n  var value = context.lookup(token[1]);\n\n  // This function is used to render an arbitrary template\n  // in the current context by higher-order sections.\n  function subRender (template) {\n    return self.render(template, context, partials, config);\n  }\n\n  if (!value) return;\n\n  if (isArray(value)) {\n    for (var j = 0, valueLength = value.length; j < valueLength; ++j) {\n      buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate, config);\n    }\n  } else if (typeof value === 'object' || typeof value === 'string' || typeof value === 'number') {\n    buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate, config);\n  } else if (isFunction(value)) {\n    if (typeof originalTemplate !== 'string')\n      throw new Error('Cannot use higher-order sections without the original template');\n\n    // Extract the portion of the original template that the section contains.\n    value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);\n\n    if (value != null)\n      buffer += value;\n  } else {\n    buffer += this.renderTokens(token[4], context, partials, originalTemplate, config);\n  }\n  return buffer;\n};\n\nWriter.prototype.renderInverted = function renderInverted (token, context, partials, originalTemplate, config) {\n  var value = context.lookup(token[1]);\n\n  // Use JavaScript's definition of falsy. Include empty arrays.\n  // See https://github.com/janl/mustache.js/issues/186\n  if (!value || (isArray(value) && value.length === 0))\n    return this.renderTokens(token[4], context, partials, originalTemplate, config);\n};\n\nWriter.prototype.indentPartial = function indentPartial (partial, indentation, lineHasNonSpace) {\n  var filteredIndentation = indentation.replace(/[^ \\t]/g, '');\n  var partialByNl = partial.split('\\n');\n  for (var i = 0; i < partialByNl.length; i++) {\n    if (partialByNl[i].length && (i > 0 || !lineHasNonSpace)) {\n      partialByNl[i] = filteredIndentation + partialByNl[i];\n    }\n  }\n  return partialByNl.join('\\n');\n};\n\nWriter.prototype.renderPartial = function renderPartial (token, context, partials, config) {\n  if (!partials) return;\n  var tags = this.getConfigTags(config);\n\n  var value = isFunction(partials) ? partials(token[1]) : partials[token[1]];\n  if (value != null) {\n    var lineHasNonSpace = token[6];\n    var tagIndex = token[5];\n    var indentation = token[4];\n    var indentedValue = value;\n    if (tagIndex == 0 && indentation) {\n      indentedValue = this.indentPartial(value, indentation, lineHasNonSpace);\n    }\n    var tokens = this.parse(indentedValue, tags);\n    return this.renderTokens(tokens, context, partials, indentedValue, config);\n  }\n};\n\nWriter.prototype.unescapedValue = function unescapedValue (token, context) {\n  var value = context.lookup(token[1]);\n  if (value != null)\n    return value;\n};\n\nWriter.prototype.escapedValue = function escapedValue (token, context, config) {\n  var escape = this.getConfigEscape(config) || mustache.escape;\n  var value = context.lookup(token[1]);\n  if (value != null)\n    return (typeof value === 'number' && escape === mustache.escape) ? String(value) : escape(value);\n};\n\nWriter.prototype.rawValue = function rawValue (token) {\n  return token[1];\n};\n\nWriter.prototype.getConfigTags = function getConfigTags (config) {\n  if (isArray(config)) {\n    return config;\n  }\n  else if (config && typeof config === 'object') {\n    return config.tags;\n  }\n  else {\n    return undefined;\n  }\n};\n\nWriter.prototype.getConfigEscape = function getConfigEscape (config) {\n  if (config && typeof config === 'object' && !isArray(config)) {\n    return config.escape;\n  }\n  else {\n    return undefined;\n  }\n};\n\nvar mustache = {\n  name: 'mustache.js',\n  version: '4.2.0',\n  tags: [ '{{', '}}' ],\n  clearCache: undefined,\n  escape: undefined,\n  parse: undefined,\n  render: undefined,\n  Scanner: undefined,\n  Context: undefined,\n  Writer: undefined,\n  /**\n   * Allows a user to override the default caching strategy, by providing an\n   * object with set, get and clear methods. This can also be used to disable\n   * the cache by setting it to the literal `undefined`.\n   */\n  set templateCache (cache) {\n    defaultWriter.templateCache = cache;\n  },\n  /**\n   * Gets the default or overridden caching object from the default writer.\n   */\n  get templateCache () {\n    return defaultWriter.templateCache;\n  }\n};\n\n// All high-level mustache.* functions use this writer.\nvar defaultWriter = new Writer();\n\n/**\n * Clears all cached templates in the default writer.\n */\nmustache.clearCache = function clearCache () {\n  return defaultWriter.clearCache();\n};\n\n/**\n * Parses and caches the given template in the default writer and returns the\n * array of tokens it contains. Doing this ahead of time avoids the need to\n * parse templates on the fly as they are rendered.\n */\nmustache.parse = function parse (template, tags) {\n  return defaultWriter.parse(template, tags);\n};\n\n/**\n * Renders the `template` with the given `view`, `partials`, and `config`\n * using the default writer.\n */\nmustache.render = function render (template, view, partials, config) {\n  if (typeof template !== 'string') {\n    throw new TypeError('Invalid template! Template should be a \"string\" ' +\n                        'but \"' + typeStr(template) + '\" was given as the first ' +\n                        'argument for mustache#render(template, view, partials)');\n  }\n\n  return defaultWriter.render(template, view, partials, config);\n};\n\n// Export the escaping function so that the user may override it.\n// See https://github.com/janl/mustache.js/issues/244\nmustache.escape = escapeHtml;\n\n// Export these mainly for testing, but also for advanced usage.\nmustache.Scanner = Scanner;\nmustache.Context = Context;\nmustache.Writer = Writer;\n\nexport default mustache;\n","import Mustache from \"mustache\";\nexport class TemplateValue {\n    constructor(template, state) {\n        this.template = template;\n        this.state = state;\n        this.ast = Mustache.parse(template);\n    }\n    getValue() {\n        if (this.value === undefined) {\n            this.value = Mustache.render(this.template, this.state);\n        }\n        return this.value;\n    }\n    onChange(callback) {\n        const subscriptions = [];\n        for (const variableName of this.getUsedVariables().values()) {\n            subscriptions.push(this.state.onVariableChange(variableName).subscribe(() => {\n                const newValue = Mustache.render(this.template, this.state);\n                if (newValue !== this.value) {\n                    this.value = newValue;\n                    callback(this.value);\n                }\n            }));\n        }\n        return {\n            unsubscribe: () => {\n                for (const subscription of subscriptions) {\n                    subscription.unsubscribe();\n                }\n            },\n        };\n    }\n    isPureString() {\n        return this.ast.length === 0 || (this.ast.length === 1 && this.ast[0][0] === \"text\");\n    }\n    getUsedVariables() {\n        const variables = new Set();\n        this.recursiveGetUsedVariables(this.ast, variables);\n        return variables;\n    }\n    recursiveGetUsedVariables(ast, variables) {\n        for (const token of ast) {\n            const type = token[0];\n            const name = token[1];\n            const subAst = token[4];\n            if ([\"name\", \"&\", \"#\", \"^\"].includes(type)) {\n                variables.add(name);\n            }\n            if (subAst !== undefined && typeof subAst !== \"string\") {\n                this.recursiveGetUsedVariables(subAst, variables);\n            }\n        }\n    }\n}\n//# sourceMappingURL=TemplateValue.js.map","import { getLayersMap } from \"../LayersFlattener\";\nimport { TemplateValue } from \"../TemplateValue\";\nimport { getAreaObject } from \"../AreaObject\";\nexport async function initPropertiesTemplatesArea() {\n    var _a;\n    const areas = await getAreaObject();\n    for (const area of areas) {\n        const properties = (_a = area.properties) !== null && _a !== void 0 ? _a : [];\n        for (const property of properties) {\n            if (property.type === \"int\" ||\n                property.type === \"bool\" ||\n                property.type === \"object\" ||\n                typeof property.value !== \"string\") {\n                continue;\n            }\n            const template = new TemplateValue(property.value, WA.state);\n            if (template.isPureString()) {\n                continue;\n            }\n            const newValue = template.getValue();\n            await setPropertyArea(area.name, property.name, newValue);\n            template.onChange(async (newValue) => {\n                await setPropertyArea(area.name, property.name, newValue);\n            });\n        }\n    }\n}\nexport async function initPropertiesTemplates() {\n    var _a;\n    const layers = await getLayersMap();\n    for (const [layerName, layer] of layers.entries()) {\n        if (layer.type !== \"objectgroup\") {\n            const properties = (_a = layer.properties) !== null && _a !== void 0 ? _a : [];\n            for (const property of properties) {\n                if (property.type === \"int\" ||\n                    property.type === \"bool\" ||\n                    property.type === \"object\" ||\n                    typeof property.value !== \"string\") {\n                    continue;\n                }\n                const template = new TemplateValue(property.value, WA.state);\n                if (template.isPureString()) {\n                    continue;\n                }\n                const newValue = template.getValue();\n                setProperty(layerName, property.name, newValue);\n                template.onChange((newValue) => {\n                    setProperty(layerName, property.name, newValue);\n                });\n            }\n        }\n    }\n}\nasync function setPropertyArea(areaName, propertyName, value) {\n    console.log(areaName);\n    const area = await WA.room.area.get(areaName);\n    area.setProperty(propertyName, value);\n}\nfunction setProperty(layerName, propertyName, value) {\n    WA.room.setProperty(layerName, propertyName, value);\n    if (propertyName === \"visible\") {\n        if (value) {\n            WA.room.showLayer(layerName);\n        }\n        else {\n            WA.room.hideLayer(layerName);\n        }\n    }\n}\n//# sourceMappingURL=properties_templates.js.map","export const workadventureAssetsHtmlUrl = \"https://admin.workadventu.re/html\";\n//# sourceMappingURL=workadventure_assets_url.js.map","import { getVariables } from \"../VariablesExtra\";\nimport { getLayersMap } from \"../LayersFlattener\";\nimport { Properties } from \"../Properties\";\nimport { findLayersBoundaries } from \"../LayersExtra\";\nimport { defaultAssetsUrl } from \"./default_assets_url\";\nimport { workadventureAssetsHtmlUrl } from \"./workadventure_assets_url\";\nimport { getAreaObject } from \"../AreaObject\";\nlet layersMap;\nlet playerX = 0;\nlet playerY = 0;\nfunction updateDoorLayers(variable) {\n    if (WA.state[variable.name]) {\n        let layers = variable.properties.mustGetString(\"openLayer\");\n        for (const layer of layers.split(\"\\n\")) {\n            WA.room.showLayer(layer);\n        }\n        layers = variable.properties.mustGetString(\"closeLayer\");\n        for (const layer of layers.split(\"\\n\")) {\n            WA.room.hideLayer(layer);\n        }\n    }\n    else {\n        let layers = variable.properties.mustGetString(\"openLayer\");\n        for (const layer of layers.split(\"\\n\")) {\n            WA.room.hideLayer(layer);\n        }\n        layers = variable.properties.mustGetString(\"closeLayer\");\n        for (const layer of layers.split(\"\\n\")) {\n            WA.room.showLayer(layer);\n        }\n    }\n}\nfunction playOpenSound(variable) {\n    const url = variable.properties.getString(\"openSound\");\n    const radius = variable.properties.getNumber(\"soundRadius\");\n    let volume = 1;\n    if (radius) {\n        const distance = getDistance(variable.properties.mustGetString(\"openLayer\").split(\"\\n\"));\n        if (distance > radius) {\n            return;\n        }\n        volume = 1 - distance / radius;\n    }\n    if (url) {\n        WA.sound.loadSound(url).play({\n            volume,\n        });\n    }\n}\nfunction playCloseSound(variable) {\n    const url = variable.properties.getString(\"closeSound\");\n    const radius = variable.properties.getNumber(\"soundRadius\");\n    let volume = 1;\n    if (radius) {\n        const distance = getDistance(variable.properties.mustGetString(\"closeLayer\").split(\"\\n\"));\n        if (distance > radius) {\n            return;\n        }\n        volume = 1 - distance / radius;\n    }\n    if (url) {\n        WA.sound.loadSound(url).play({\n            volume,\n        });\n    }\n}\nfunction getTileLayers(layerNames) {\n    return layerNames\n        .map((layerName) => layersMap.get(layerName))\n        .filter((layer) => (layer === null || layer === void 0 ? void 0 : layer.type) === \"tilelayer\");\n}\nfunction getDistance(layerNames) {\n    const layers = getTileLayers(layerNames);\n    const boundaries = findLayersBoundaries(layers);\n    const xLayer = ((boundaries.right - boundaries.left) / 2 + boundaries.left) * 32;\n    const yLayer = ((boundaries.bottom - boundaries.top) / 2 + boundaries.top) * 32;\n    return Math.sqrt(Math.pow(playerX - xLayer, 2) + Math.pow(playerY - yLayer, 2));\n}\nfunction initDoor(variable) {\n    WA.state.onVariableChange(variable.name).subscribe(() => {\n        if (WA.state[variable.name]) {\n            playOpenSound(variable);\n        }\n        else {\n            playCloseSound(variable);\n        }\n        updateDoorLayers(variable);\n    });\n    updateDoorLayers(variable);\n}\nfunction initDoorstep(doorstepZone, doorVariable, properties, assetsUrl) {\n    const name = doorstepZone.name;\n    let actionMessage = undefined;\n    let keypadWebsite = undefined;\n    let inZone = false;\n    const tag = properties.getString(\"tag\");\n    let allowed = true;\n    if (tag && !WA.player.tags.includes(tag)) {\n        allowed = false;\n    }\n    const accessRestricted = !!tag;\n    function displayCloseDoorMessage() {\n        var _a;\n        if (actionMessage) {\n            actionMessage.remove();\n        }\n        actionMessage = WA.ui.displayActionMessage({\n            message: (_a = properties.getString(\"closeTriggerMessage\")) !== null && _a !== void 0 ? _a : \"Press SPACE to close the door\",\n            callback: () => {\n                WA.state[doorVariable.name] = false;\n                displayOpenDoorMessage();\n            },\n        });\n    }\n    function displayOpenDoorMessage() {\n        var _a;\n        if (actionMessage) {\n            actionMessage.remove();\n        }\n        actionMessage = WA.ui.displayActionMessage({\n            message: (_a = properties.getString(\"openTriggerMessage\")) !== null && _a !== void 0 ? _a : \"Press SPACE to open the door\",\n            callback: () => {\n                WA.state[doorVariable.name] = true;\n                displayCloseDoorMessage();\n            },\n        });\n    }\n    function openKeypad() {\n        let boundaries;\n        if (doorstepZone.type === \"tilelayer\") {\n            boundaries = findLayersBoundaries(getTileLayers(doorVariable.properties.mustGetString(\"closeLayer\").split(\"\\n\")));\n        }\n        else {\n            if (doorstepZone.x === undefined ||\n                doorstepZone.y === undefined ||\n                doorstepZone.width === undefined ||\n                doorstepZone.height === undefined) {\n                throw new Error(`Doorstep zone \"${doorstepZone.name}\" is missing x, y, width or height`);\n            }\n            boundaries = {\n                top: doorstepZone.y,\n                left: doorstepZone.x,\n                right: doorstepZone.x + doorstepZone.width,\n                bottom: doorstepZone.y + doorstepZone.height,\n            };\n        }\n        keypadWebsite = WA.room.website.create({\n            name: \"doorKeypad\" + name,\n            url: assetsUrl + \"/keypad.html#\" + encodeURIComponent(name),\n            position: {\n                x: boundaries.right * 32,\n                y: boundaries.top * 32,\n                width: 32 * 3,\n                height: 32 * 4,\n            },\n            allowApi: true,\n        });\n    }\n    function closeKeypad() {\n        if (keypadWebsite) {\n            WA.room.website.delete(keypadWebsite.name);\n            keypadWebsite = undefined;\n        }\n    }\n    function onEnter() {\n        inZone = true;\n        if (properties.getBoolean(\"autoOpen\") && allowed) {\n            WA.state[doorVariable.name] = true;\n            return;\n        }\n        if (!WA.state[doorVariable.name] &&\n            ((accessRestricted && !allowed) || !accessRestricted) &&\n            (properties.getString(\"code\") || properties.getString(\"codeVariable\"))) {\n            openKeypad();\n            return;\n        }\n        if (!allowed) {\n            return;\n        }\n        if (WA.state[doorVariable.name]) {\n            displayCloseDoorMessage();\n        }\n        else {\n            displayOpenDoorMessage();\n        }\n    }\n    function onLeave() {\n        inZone = false;\n        if (properties.getBoolean(\"autoClose\")) {\n            WA.state[doorVariable.name] = false;\n        }\n        if (actionMessage) {\n            actionMessage.remove();\n        }\n        closeKeypad();\n    }\n    if (doorstepZone.type === \"tilelayer\") {\n        WA.room.onEnterLayer(name).subscribe(onEnter);\n        WA.room.onLeaveLayer(name).subscribe(onLeave);\n    }\n    else {\n        WA.room.area.onEnter(name).subscribe(onEnter);\n        WA.room.area.onLeave(name).subscribe(onLeave);\n    }\n    WA.state.onVariableChange(doorVariable.name).subscribe(() => {\n        if (inZone) {\n            if (!properties.getBoolean(\"autoClose\") && WA.state[doorVariable.name] === true) {\n                displayCloseDoorMessage();\n            }\n            if (keypadWebsite && WA.state[doorVariable.name] === true) {\n                closeKeypad();\n            }\n            if (!properties.getBoolean(\"autoOpen\") && WA.state[doorVariable.name] === false) {\n                displayOpenDoorMessage();\n            }\n        }\n    });\n}\nfunction playBellSound(variable) {\n    const url = variable.properties.mustGetString(\"bellSound\");\n    const radius = variable.properties.getNumber(\"soundRadius\");\n    let volume = 1;\n    if (radius) {\n        const distance = Math.sqrt(Math.pow(variable.x - playerX, 2) + Math.pow(variable.y - playerY, 2));\n        if (distance > radius) {\n            return;\n        }\n        volume = 1 - distance / radius;\n    }\n    WA.sound.loadSound(url).play({\n        volume,\n    });\n}\nfunction initBell(variable) {\n    if (WA.state[variable.name] === undefined) {\n        WA.state[variable.name] = 0;\n    }\n    WA.state.onVariableChange(variable.name).subscribe(() => {\n        if (WA.state[variable.name]) {\n            playBellSound(variable);\n        }\n    });\n}\nfunction initBellLayer(bellVariable, properties, bellZone) {\n    let popup = undefined;\n    const bellPopupName = properties.getString(\"bellPopup\");\n    if (bellZone.type === \"tilelayer\") {\n        const layerName = bellZone.name;\n        WA.room.onEnterLayer(layerName).subscribe(() => {\n            var _a;\n            if (!bellPopupName) {\n                WA.state[bellVariable] = WA.state[bellVariable] + 1;\n            }\n            else {\n                popup = WA.ui.openPopup(bellPopupName, \"\", [\n                    {\n                        label: (_a = properties.getString(\"bellButtonText\")) !== null && _a !== void 0 ? _a : \"Ring\",\n                        callback: () => {\n                            WA.state[bellVariable] = WA.state[bellVariable] + 1;\n                        },\n                    },\n                ]);\n            }\n        });\n        WA.room.onLeaveLayer(layerName).subscribe(() => {\n            if (popup) {\n                popup.close();\n                popup = undefined;\n            }\n        });\n    }\n    else {\n        const objectName = bellZone.name;\n        WA.room.area.onEnter(objectName).subscribe(() => {\n            var _a;\n            if (!bellPopupName) {\n                WA.state[bellVariable] = WA.state[bellVariable] + 1;\n            }\n            else {\n                popup = WA.ui.openPopup(bellPopupName, \"\", [\n                    {\n                        label: (_a = properties.getString(\"bellButtonText\")) !== null && _a !== void 0 ? _a : \"Ring\",\n                        callback: () => {\n                            WA.state[bellVariable] = WA.state[bellVariable] + 1;\n                        },\n                    },\n                ]);\n            }\n        });\n        WA.room.area.onLeave(objectName).subscribe(() => {\n            if (popup) {\n                popup.close();\n                popup = undefined;\n            }\n        });\n    }\n}\nexport async function initDoors(assetsUrl) {\n    assetsUrl = assetsUrl !== null && assetsUrl !== void 0 ? assetsUrl : (workadventureAssetsHtmlUrl || defaultAssetsUrl);\n    const variables = await getVariables();\n    layersMap = await getLayersMap();\n    for (const variable of variables.values()) {\n        if (variable.properties.get(\"door\")) {\n            initDoor(variable);\n        }\n        if (variable.properties.get(\"bell\")) {\n            initBell(variable);\n        }\n    }\n    for (const layer of layersMap.values()) {\n        const properties = new Properties(layer.properties);\n        const doorVariableName = properties.getString(\"doorVariable\");\n        if (doorVariableName && layer.type === \"tilelayer\") {\n            const doorVariable = variables.get(doorVariableName);\n            if (doorVariable === undefined) {\n                throw new Error('Cannot find variable \"' +\n                    doorVariableName +\n                    '\" referred in the \"doorVariable\" property of layer \"' +\n                    layer.name +\n                    '\"');\n            }\n            initDoorstep(layer, doorVariable, properties, assetsUrl);\n        }\n        const bellVariable = properties.getString(\"bellVariable\");\n        if (bellVariable && layer.type === \"tilelayer\") {\n            initBellLayer(bellVariable, properties, layer);\n        }\n    }\n    for (const object of await getAreaObject()) {\n        const properties = new Properties(object.properties);\n        const doorVariableName = properties.getString(\"doorVariable\");\n        if (doorVariableName) {\n            const doorVariable = variables.get(doorVariableName);\n            if (doorVariable === undefined) {\n                throw new Error('Cannot find variable \"' +\n                    doorVariableName +\n                    '\" referred in the \"doorVariable\" property of object \"' +\n                    object.name +\n                    '\"');\n            }\n            initDoorstep(object, doorVariable, properties, assetsUrl);\n        }\n        const bellVariable = properties.getString(\"bellVariable\");\n        if (bellVariable) {\n            initBellLayer(bellVariable, properties, object);\n        }\n    }\n    WA.player.onPlayerMove((moveEvent) => {\n        playerX = moveEvent.x;\n        playerY = moveEvent.y;\n    });\n}\n//# sourceMappingURL=doors.js.map","export function initVariableActionLayer(properties, layerName) {\n    const variableName = properties.getString(\"bindVariable\");\n    if (variableName) {\n        const enterValue = properties.get(\"enterValue\");\n        const leaveValue = properties.get(\"leaveValue\");\n        const triggerMessage = properties.getString(\"triggerMessage\");\n        const tag = properties.getString(\"tag\");\n        setupVariableActionLayer(variableName, layerName, enterValue, leaveValue, triggerMessage, tag);\n    }\n}\nlet actionMessagePopup;\nfunction setupVariableActionLayer(variableName, layerName, enterValue, leaveValue, triggerMessage, tag) {\n    if (tag && !WA.player.tags.includes(tag)) {\n        return;\n    }\n    if (enterValue !== undefined) {\n        WA.room.onEnterLayer(layerName).subscribe(() => {\n            if (triggerMessage) {\n                actionMessagePopup = WA.ui.displayActionMessage({\n                    type: \"message\",\n                    message: triggerMessage,\n                    callback: () => {\n                        WA.state[variableName] = enterValue;\n                    },\n                });\n            }\n            else {\n                WA.state[variableName] = enterValue;\n            }\n        });\n    }\n    if (leaveValue !== undefined) {\n        WA.room.onLeaveLayer(layerName).subscribe(() => {\n            WA.state[variableName] = leaveValue;\n            if (actionMessagePopup) {\n                actionMessagePopup.remove().catch((e) => {\n                    console.error(e);\n                });\n                actionMessagePopup = undefined;\n            }\n        });\n    }\n}\n//# sourceMappingURL=variable_actions.js.map","import { getLayersMap } from \"../LayersFlattener\";\nimport { Properties } from \"../Properties\";\nimport { initVariableActionLayer } from \"./variable_actions\";\nexport async function initSpecialProperties() {\n    const layers = await getLayersMap();\n    for (const layer of layers.values()) {\n        const properties = new Properties(layer.properties);\n        initVariableActionLayer(properties, layer.name);\n    }\n}\n//# sourceMappingURL=special_properties.js.map","import { Properties } from \"../Properties\";\nimport { defaultAssetsUrl } from \"./default_assets_url\";\nimport { getLayersMap } from \"../LayersFlattener\";\nimport { openConfig } from \"../VariablesExtra\";\nlet layersMap;\nexport async function initConfiguration(assetsUrl) {\n    const map = (await WA.room.getTiledMap());\n    assetsUrl = assetsUrl !== null && assetsUrl !== void 0 ? assetsUrl : defaultAssetsUrl;\n    layersMap = await getLayersMap();\n    const configurationLayer = map.layers.find((layer) => layer.name === \"configuration\");\n    if (configurationLayer) {\n        const properties = new Properties(configurationLayer.properties);\n        const tag = properties.getString(\"tag\");\n        if (!tag || WA.player.tags.includes(tag)) {\n            WA.ui.registerMenuCommand(\"Configure the room\", () => {\n                WA.nav.openCoWebSite(assetsUrl + \"/configuration.html\", true);\n            });\n        }\n        for (const layer of layersMap.values()) {\n            const properties = new Properties(layer.properties);\n            const openConfigVariables = properties.getString(\"openConfig\");\n            if (openConfigVariables && layer.type === \"tilelayer\") {\n                initLocalConfigurationPanel(openConfigVariables.split(\",\"), layer.name, properties);\n            }\n        }\n    }\n}\nfunction initLocalConfigurationPanel(openConfigVariables, layerName, properties) {\n    let actionMessage = undefined;\n    const tag = properties.getString(\"openConfigAdminTag\");\n    let allowedByTag = true;\n    if (tag && !WA.player.tags.includes(tag)) {\n        allowedByTag = false;\n    }\n    function displayConfigurationMessage() {\n        var _a;\n        if (actionMessage) {\n            actionMessage.remove();\n        }\n        actionMessage = WA.ui.displayActionMessage({\n            message: (_a = properties.getString(\"openConfigTriggerMessage\")) !== null && _a !== void 0 ? _a : \"Press SPACE or touch here to configure\",\n            callback: () => openConfig(openConfigVariables),\n        });\n    }\n    function closeConfigurationPanel() {\n        WA.nav.closeCoWebSite();\n    }\n    WA.room.onEnterLayer(layerName).subscribe(() => {\n        const openConfigTriggerValue = properties.getString(\"openConfigTrigger\");\n        if (allowedByTag) {\n            if (openConfigTriggerValue && openConfigTriggerValue === \"onaction\") {\n                displayConfigurationMessage();\n            }\n            else {\n                openConfig(openConfigVariables);\n            }\n        }\n    });\n    WA.room.onLeaveLayer(layerName).subscribe(() => {\n        if (actionMessage) {\n            actionMessage.remove();\n            closeConfigurationPanel();\n        }\n        else {\n            closeConfigurationPanel();\n        }\n    });\n}\n//# sourceMappingURL=configuration.js.map","import { initDoors } from \"./Features/doors\";\nimport { initSpecialProperties } from \"./Features/special_properties\";\nimport { initConfiguration } from \"./Features/configuration\";\nimport { initPropertiesTemplates, initPropertiesTemplatesArea, } from \"./Features/properties_templates\";\nexport function bootstrapExtra() {\n    return WA.onInit()\n        .then(() => {\n        initDoors().catch((e) => console.error(e));\n        initSpecialProperties().catch((e) => console.error(e));\n        initConfiguration().catch((e) => console.error(e));\n        initPropertiesTemplates().catch((e) => console.error(e));\n        initPropertiesTemplatesArea().catch((e) => console.error(e));\n    })\n        .catch((e) => console.error(e));\n}\n//# sourceMappingURL=init.js.map","let currentPopup: any | undefined;\r\n\r\nexport function initClock() {\r\n  WA.room.area.onEnter(\"clock\").subscribe(() => {\r\n    const now = new Date();\r\n    const hh = String(now.getHours()).padStart(2, \"0\");\r\n    const mm = String(now.getMinutes()).padStart(2, \"0\");\r\n\r\n    // close old popup if any\r\n    if (currentPopup) currentPopup.close();\r\n\r\n    // open new popup\r\n    currentPopup = WA.ui.openPopup(\"clockPopup\", `It's ${hh}:${mm}`, []);\r\n  });\r\n\r\n  WA.room.area.onLeave(\"clock\").subscribe(() => {\r\n    if (currentPopup) {\r\n      currentPopup.close();\r\n      currentPopup = undefined;\r\n    }\r\n  });\r\n}\r\n","let boardPopupRef: any | undefined;\r\n\r\nexport function initBoard() {\r\n  const close = () => {\r\n    if (boardPopupRef) {\r\n      boardPopupRef.close();\r\n      boardPopupRef = undefined;\r\n    }\r\n  };\r\n\r\n  WA.room.area.onEnter(\"board\").subscribe(() => {\r\n    close();\r\n    const text =\r\n      \"The bulletin board hums with strange energy. Five portals shimmer before youchoose your path:  Malware  malicious code that corrupts, spies, and destroys   Phishing/Quishing  fake messages or QR Codes that trick you into giving secrets   Identity Theft  criminals using your identity   xxxxxxxxxxxx   Password Security  strong, unique passwords and MFA to protect your accounts.\";\r\n    boardPopupRef = WA.ui.openPopup(\"boardPopup\", text, []);\r\n  });\r\n\r\n  WA.room.area.onLeave(\"board\").subscribe(close);\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet marviePopupRef: any | undefined;\r\n\r\nfunction closeMarviePopup() {\r\n  if (marviePopupRef) {\r\n    try { marviePopupRef.close?.(); } catch {}\r\n    marviePopupRef = undefined;\r\n  }\r\n}\r\n\r\nfunction getMessageForZone(): string {\r\n  try {\r\n    const obj = (WA.room as any).object?.get?.(\"MarvieZone\");\r\n    if (obj && obj.properties) {\r\n      const props = obj.properties;\r\n      if (Array.isArray(props)) {\r\n        const p = props.find((x: any) => x.name === \"marvieMessage\" || x.name === \"marviePopup\");\r\n        if (p?.value) return String(p.value);\r\n      } else if (props.marvieMessage) {\r\n        return String(props.marvieMessage);\r\n      }\r\n    }\r\n  } catch {}\r\n  return [\r\n    \" Hi  I'm Marvie.\",\r\n    \"\",\r\n    \"Welcome to the Room of Malware.\",\r\n\t\"Do you think you can find the 3 easter eggs around the map?\",\r\n    \"Tip: Check the walls, the chairs or the floor for suspicious objects.\",\r\n  ].join(\"\\n\");\r\n}\r\n\r\nexport function initMarvie() {\r\n  console.log(\"[Marvie] init\");\r\n\r\n  WA.room.area.onEnter(\"MarvieZone\").subscribe(() => {\r\n    closeMarviePopup();\r\n    const message = getMessageForZone();\r\n    marviePopupRef = WA.ui.openPopup(\"marviePopup\", message, [\r\n      { label: \"Got it\", callback: () => closeMarviePopup() },\r\n    ]);\r\n  });\r\n\r\n  WA.room.area.onLeave(\"MarvieZone\").subscribe(() => {\r\n    closeMarviePopup();\r\n  });\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet previewRef: any | undefined;\r\n\r\nconst AREA   = \"phishing_QRcode\";\r\nconst ANCHOR = \"phishing_QRcodePopup\";\r\n\r\nexport function initphishing_QRcode() {\r\n  WA.onInit().then(() => {\r\n    WA.room.area.onEnter(AREA).subscribe(() => {\r\n      closePopup();\r\n      previewRef = WA.ui.openPopup(\r\n        ANCHOR,\r\n        \" You spot a poster in the library: Free Wi-Fi for Students  Scan to connect.\\n\\nScanning unknown QR codes can lead to fake login pages.\\n\\nWhat would you do? Press SPACE to help!\",\r\n        [{ label: \"Got it\", callback: () => closePopup() }]\r\n      );\r\n    });\r\n\r\n    WA.room.area.onLeave(AREA).subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction closePopup() {\r\n  try {\r\n    if (previewRef) {\r\n      previewRef.close?.();\r\n      previewRef = undefined; // important!\r\n    }\r\n  } catch {\r\n    previewRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet previewRef: any | undefined;\r\n\r\nconst AREA   = \"phishing_MurdochEmail\";\r\nconst ANCHOR = \"phishing_MurdochEmailPopup\";\r\n\r\nexport function initphishing_MurdochEmail() {\r\n  WA.onInit().then(() => {\r\n    // Enter -> open (after closing any stray instance)\r\n    WA.room.area.onEnter(AREA).subscribe(() => {\r\n      closePopup();\r\n      previewRef = WA.ui.openPopup(\r\n        ANCHOR,\r\n        \" You received an email: Your university fees are overdue. Click here to pay immediately.\\n\\n This looks suspicious... What would you do? Press SPACE to help!\",\r\n        [\r\n          {\r\n            label: \"Got it\",\r\n            callback: () => closePopup(),\r\n          },\r\n        ]\r\n      );\r\n    });\r\n\r\n    // Leave -> always close and clear reference\r\n    WA.room.area.onLeave(AREA).subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction closePopup() {\r\n  try {\r\n    if (previewRef) {\r\n      previewRef.close?.();\r\n      previewRef = undefined; //  make sure future cycles start clean\r\n    }\r\n  } catch {\r\n    // ignore\r\n    previewRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet previewRef: any | undefined;\r\n\r\nconst AREA   = \"phishing_SMSphishing\";\r\nconst ANCHOR = \"phishing_SMSphishingPopup\";\r\n\r\nexport function initphishing_SMSphishing() {\r\n  WA.onInit().then(() => {\r\n    WA.room.area.onEnter(AREA).subscribe(() => {\r\n      closePopup();\r\n      previewRef = WA.ui.openPopup(\r\n        ANCHOR,\r\n        \" You received an SMS: URGENT: Your bank account has been locked. Verify now to avoid service interruption.\\n\\n Messages like this try to rush you. What would you do? Press SPACE to help!\",\r\n        [{ label: \"Got it\", callback: () => closePopup() }]\r\n      );\r\n    });\r\n\r\n    WA.room.area.onLeave(AREA).subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction closePopup() {\r\n  try {\r\n    if (previewRef) {\r\n      previewRef.close?.();\r\n      previewRef = undefined; // important!\r\n    }\r\n  } catch {\r\n    previewRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\ntype Goals = {\r\n  phishing_SMSphishing: boolean;\r\n  phishing_MurdochEmail: boolean;\r\n  phishing_QRcode: boolean;\r\n  BrockZone: boolean;\r\n};\r\n\r\nconst goals: Goals = {\r\n  phishing_SMSphishing: false,\r\n  phishing_MurdochEmail: false,\r\n  phishing_QRcode: false,\r\n  BrockZone: false,\r\n};\r\n\r\nconst EXIT_AREA_NAME = \"to-canteen\";   // exit gate area\r\nconst NEXT_ROOM = \"canteen.tmj#from-library\"; // change if your spawn is named differently\r\n\r\nexport function initPhishingLibraryProgress() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[PhishingLibraryProgress] ready\");\r\n\r\n    // --- Easter Eggs ---\r\n    [\"phishing_SMSphishing\", \"phishing_MurdochEmail\", \"phishing_QRcode\"].forEach((egg) => {\r\n      WA.room.area.onEnter(egg).subscribe(() => {\r\n        if (!goals[egg as keyof Goals]) {\r\n          goals[egg as keyof Goals] = true;\r\n          notifyProgress();\r\n        }\r\n      });\r\n    });\r\n\r\n    // --- NPC ---\r\n    WA.room.area.onEnter(\"BrockZone\").subscribe(() => {\r\n      if (!goals.BrockZone) {\r\n        goals.BrockZone = true;\r\n        notifyProgress();\r\n      }\r\n    });\r\n\r\n    // --- Exit ---\r\n    WA.room.area.onEnter(EXIT_AREA_NAME).subscribe(() => {\r\n      if (allDone()) {\r\n        WA.nav.goToRoom(NEXT_ROOM);\r\n      } else {\r\n        WA.ui.openPopup(\r\n          \"phishing_gate_popup\",\r\n          ` Hold up!\\n\\nYou still need to complete:\\n ${missingList().join(\"\\n \")}\\n\\nFind all 3 phishing easter eggs and talk to Brock before leaving.`,\r\n          [\r\n            { label: \"OK\", className: \"primary\", callback: (p) => p.close() },\r\n          ]\r\n        );\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n/* ---------- Helpers ---------- */\r\nfunction allDone(): boolean {\r\n  return goals.phishing_SMSphishing && goals.phishing_MurdochEmail && goals.phishing_QRcode && goals.BrockZone;\r\n}\r\n\r\nfunction missingList(): string[] {\r\n  const out: string[] = [];\r\n  if (!goals.phishing_SMSphishing) out.push(\"SMS Phishing Easter Egg\");\r\n  if (!goals.phishing_MurdochEmail) out.push(\"Murdoch Email Easter Egg\");\r\n  if (!goals.phishing_QRcode) out.push(\"QR Code Easter Egg\");\r\n  if (!goals.BrockZone) out.push(\"Talk to Brock (NPC)\");\r\n  return out;\r\n}\r\n\r\nfunction notifyProgress() {\r\n  const done = [\r\n    goals.phishing_SMSphishing ? \" SMS\" : \" SMS\",\r\n    goals.phishing_MurdochEmail ? \" MurdochEmail\" : \" MurdochEmail\",\r\n    goals.phishing_QRcode ? \" QRcode\" : \" QRcode\",\r\n    goals.BrockZone ? \" Brock\" : \" Brock\",\r\n  ].join(\"   \");\r\n\r\n  WA.ui.displayActionMessage({\r\n    message: `Progress: ${done}`,\r\n    callback: () => {}, // no action\r\n  });\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nexport function initPhishingInstructions() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Phishing sign instructions ready\");\r\n\r\n    // Open when entering the sign-board area\r\n    WA.room.area.onEnter(\"phishing_instructions\").subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    // Close when leaving the sign-board area\r\n    WA.room.area.onLeave(\"phishing_instructions\").subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // prevent duplicates\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"phishing_instructionsPopup\",\r\n    \" Go through the PPT to prepare yourself for when you explore the room!\",\r\n    [\r\n      {\r\n        label: \"Got it!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  if (popupRef) {\r\n    popupRef.close?.();\r\n    popupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet ref: any | undefined;\r\nlet leaveSub: any | undefined;\r\n\r\nfunction closeNote() {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = undefined;\r\n  try { leaveSub?.unsubscribe?.(); } catch {}\r\n  leaveSub = undefined;\r\n}\r\n\r\nfunction openNote() {\r\n  // open popup\r\n  try { ref?.close?.(); } catch {}\r\n  ref = WA.ui.openPopup(\r\n    \"phishing_librarySpawnPopup\",   // anchor ID (adjust in Tiled if needed)\r\n    \" Please visit the signboard.\",\r\n    [{ label: \"OK\", callback: closeNote }]\r\n  );\r\n\r\n  // close it automatically when leaving the spawn area\r\n  try { leaveSub?.unsubscribe?.(); } catch {}\r\n  leaveSub = WA.room.area.onLeave(\"from-garden\").subscribe(closeNote);\r\n\r\n  // (optional) also auto-close after 5s if player doesn't move/click\r\n  setTimeout(() => { closeNote(); }, 5000);\r\n}\r\n\r\nexport function initPhishingLibrarySpawnNote() {\r\n  WA.onInit().then(() => {\r\n    // show when entering the spawn area (arriving from garden)\r\n    WA.room.area.onEnter(\"from-garden\").subscribe(openNote);\r\n\r\n    // safety: if the player spawns already inside the area, show once\r\n    setTimeout(() => {\r\n      WA.player.getPosition().then(() => openNote());\r\n    }, 250);\r\n  });\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet brockPopupRef: any | undefined;\r\n\r\nexport function initPhishingBrock() {\r\n  const ANCHOR = \"phishing_BrockPopup\"; // must match the popup object in Tiled\r\n\r\n  const close = () => {\r\n    if (brockPopupRef) {\r\n      brockPopupRef.close();\r\n      brockPopupRef = undefined;\r\n    }\r\n  };\r\n\r\n  // When entering Brocks area\r\n  WA.room.area.onEnter(\"phishing_Brock\").subscribe(() => {\r\n    close();\r\n    const text =\r\n      \" Brock: Hey there! Before you move on, have you checked out all the phishing clues? Make sure youve seen the email, QR code, and SMS examples  theyll help you spot scams in the future!\";\r\n    brockPopupRef = WA.ui.openPopup(ANCHOR, text, [\r\n      {\r\n        label: \"Got it!\",\r\n        callback: () => close(),\r\n      },\r\n    ]);\r\n  });\r\n\r\n  // When leaving Brocks area\r\n  WA.room.area.onLeave(\"phishing_Brock\").subscribe(close);\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\nlet enterSub: any | undefined;\r\nlet leaveSub: any | undefined;\r\nlet initialized = false;\r\n\r\nconst AREA   = \"billboard\";       // Tiled area name\r\nconst ANCHOR = \"billboardPopup\";  // Tiled object name used as popup anchor\r\n\r\nfunction closePopup() {\r\n  try { popupRef?.close?.(); } catch {}\r\n  popupRef = undefined;\r\n}\r\n\r\nexport function initBillboard() {\r\n  if (initialized) return;      // prevent double-binding\r\n  initialized = true;\r\n\r\n  WA.onInit().then(() => {\r\n    try { enterSub?.unsubscribe?.(); } catch {}\r\n    try { leaveSub?.unsubscribe?.(); } catch {}\r\n\r\n    enterSub = WA.room.area.onEnter(AREA).subscribe(() => {\r\n      closePopup();\r\n      try {\r\n        popupRef = WA.ui.openPopup(\r\n          ANCHOR,\r\n          \" The community billboard\\n\\n Move towards the ladder on the right and begin your adventure!\",\r\n          [{ label: \"Close\", className: \"primary\", callback: () => closePopup() }]\r\n        );\r\n      } catch { /* ignore */ }\r\n    });\r\n\r\n    leaveSub = WA.room.area.onLeave(AREA).subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet spawnPopupRef: any | undefined;\r\n\r\nexport function initSpawnIntro() {\r\n  WA.onInit().then(() => {\r\n    // small delay avoids races with other initializers\r\n    setTimeout(openSpawnIntro, 50);\r\n  });\r\n}\r\n\r\nfunction openSpawnIntro() {\r\n  closeSpawnIntro(); // prevent duplicates\r\n\r\n  spawnPopupRef = WA.ui.openPopup(\r\n    \"spawnIntroPopup\",\r\n    \" Welcome! Use the Arrow Keys or WASD to move. Explore the map and look for the wooden signage for guidance. Tip: Walk close to objects (signs, boards, NPCs) to interact with them.\",\r\n    [\r\n      {\r\n        label: \"Got it\",\r\n        className: \"primary\",\r\n        callback: (popup) => {\r\n          try { popup.close?.(); } catch {}\r\n          closeSpawnIntro();\r\n        },\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closeSpawnIntro() {\r\n  if (spawnPopupRef) {\r\n    try { spawnPopupRef.close?.(); } catch {}\r\n    spawnPopupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\nlet enterSub: any | undefined;\r\nlet leaveSub: any | undefined;\r\nlet initialized = false;\r\n\r\nconst AREA   = \"instructions\";       // must match your Tiled area name\r\nconst ANCHOR = \"instructionsPopup\";  // must match your Tiled popup object\r\n\r\nexport function initInstructions() {\r\n  if (initialized) return;           // prevent double-binding if file gets imported twice\r\n  initialized = true;\r\n\r\n  WA.onInit().then(() => {\r\n    // (Re)create clean subscriptions\r\n    try { enterSub?.unsubscribe?.(); } catch {}\r\n    try { leaveSub?.unsubscribe?.(); } catch {}\r\n\r\n    enterSub = WA.room.area.onEnter(AREA).subscribe(() => {\r\n      closePopup(); // just in case\r\n      popupRef = WA.ui.openPopup(\r\n        ANCHOR,\r\n        \" Cyber Rangers HQ  Welcome to the starting map of Cyber Adventure. Murdoch University is in distress, the students need your help! Look for me when you get to every map for more info! When you're ready, head to the ladder at the top to continue!\",\r\n        [\r\n          {\r\n            label: \"Close\",\r\n            className: \"primary\",\r\n            callback: () => closePopup(),\r\n          },\r\n        ]\r\n      );\r\n    });\r\n\r\n    leaveSub = WA.room.area.onLeave(AREA).subscribe(() => {\r\n      // Always close when walking out of the area\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction closePopup() {\r\n  try {\r\n    popupRef?.close?.();\r\n  } catch { /* ignore */ }\r\n  popupRef = undefined;\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nconst POPUP_ANCHOR = \"posterPopup\";\r\nlet ref: any | undefined;\r\n\r\nfunction show(text: string) {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = WA.ui.openPopup(POPUP_ANCHOR, text, []);\r\n}\r\n\r\nfunction hide() {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = undefined;\r\n}\r\n\r\nexport function initPoster() {\r\n  WA.room.area.onEnter(\"poster\").subscribe(() => {\r\n    show(\r\n      \" You notice a faded poster: \\\"Think Before You Click! Your Cyber Kingdom Depends On It.\\\"\\n\\n\" +\r\n      \" You: (to yourself) 'Think before you click.' That's a good motto.\\n\\n\" +\r\n      \" Narrator: Always pause before clicking unknown links. Your vigilance protects your cyber kingdom!\"\r\n    );\r\n  });\r\n  WA.room.area.onLeave(\"poster\").subscribe(hide);\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nconst POPUP_ANCHOR = \"usbdrivePopup\";\r\nlet ref: any | undefined;\r\n\r\nfunction show(text: string) {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = WA.ui.openPopup(POPUP_ANCHOR, text, []);\r\n}\r\nfunction hide() {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = undefined;\r\n}\r\n\r\nexport function initUsbDrive() {\r\n  WA.room.area.onEnter(\"usbdrive\").subscribe(() => {\r\n    show(\r\n      \" You spot a random USB drive on the floor.\\n\\n\" +\r\n      \" You: Should I plug this into a PC and see what's inside?\\n\\n\" +\r\n      \" Narrator: Never plug in unknown USBs. They can hide malware that runs automatically. \" +\r\n      \"If you find one in real life, hand it to IT/Security instead of investigating it yourself.\"\r\n    );\r\n  });\r\n  WA.room.area.onLeave(\"usbdrive\").subscribe(hide);\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nconst POPUP_ANCHOR = \"stickynotePopup\";\r\nlet ref: any | undefined;\r\n\r\nfunction show(text: string) {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = WA.ui.openPopup(POPUP_ANCHOR, text, []);\r\n}\r\nfunction hide() {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = undefined;\r\n}\r\n\r\nexport function initStickyNote() {\r\n  WA.room.area.onEnter(\"stickynote\").subscribe(() => {\r\n    show(\r\n      \" A sticky note is stuck to the monitor: Email PW: P@ssw0rd123.\\n\\n\" +\r\n      \" You: Wah someone actually wrote their password here.\\n\\n\" +\r\n      \" Narrator: Dont write passwords on paper or share them. Use a password manager, \" +\r\n      \"create unique passphrases, and always enable MFA (multi-factor authentication).\"\r\n    );\r\n  });\r\n  WA.room.area.onLeave(\"stickynote\").subscribe(hide);\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nconst POPUP_ANCHOR = \"instructions_safeinternetpracticesPopup\";\r\nlet ref: any | undefined;\r\n\r\nfunction show(text: string) {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = WA.ui.openPopup(POPUP_ANCHOR, text, []);\r\n}\r\nfunction hide() {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = undefined;\r\n}\r\n\r\nexport function initSafeInternetPractices() {\r\n  WA.room.area.onEnter(\"instructions_safeinternetpractices\").subscribe(() => {\r\n    show(\r\n      \" Welcome to the Safe Internet Practices office!\\n\\n\" +\r\n      \" Explore the room and look for hidden clues (poster, USB drive, sticky note).\\n\" +\r\n      \" Read your characters thoughts and the narrators tips.\\n\" +\r\n      \" Learn to: think before you click, protect passwords, and avoid risky devices.\\n\\n\" +\r\n      \"When youre done, proceed to the exit to continue your mission.\"\r\n    );\r\n  });\r\n  WA.room.area.onLeave(\"instructions_safeinternetpractices\").subscribe(hide);\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\ntype Goals = {\r\n  poster: boolean;\r\n  usbdrive: boolean;\r\n  stickynote: boolean;\r\n  AmeliaZone: boolean;\r\n};\r\n\r\nconst goals: Goals = {\r\n  poster: false,\r\n  usbdrive: false,\r\n  stickynote: false,\r\n  AmeliaZone: false,\r\n};\r\n\r\nconst EXIT_AREA_NAME = \"to-hall\";                 // the area in Tiled\r\nconst NEXT_ROOM = \"hall.tmj#from-canteen\";        // adjust filename if needed\r\n\r\nexport function initOfficeProgress() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[OfficeProgress] ready\");\r\n\r\n    // --- Easter Eggs ---\r\n    [\"poster\", \"usbdrive\", \"stickynote\"].forEach((egg) => {\r\n      WA.room.area.onEnter(egg).subscribe(() => {\r\n        console.log(`[OfficeProgress] ENTER ${egg}`);\r\n        if (!goals[egg as keyof Goals]) {\r\n          goals[egg as keyof Goals] = true;\r\n          notifyProgress();\r\n        }\r\n      });\r\n    });\r\n\r\n    // --- NPC ---\r\n    WA.room.area.onEnter(\"AmeliaZone\").subscribe(() => {\r\n      console.log(\"[OfficeProgress] ENTER AmeliaZone\");\r\n      if (!goals.AmeliaZone) {\r\n        goals.AmeliaZone = true;\r\n        notifyProgress();\r\n      }\r\n    });\r\n\r\n    // --- Exit ---\r\n    WA.room.area.onEnter(EXIT_AREA_NAME).subscribe(() => {\r\n      console.log(\"[OfficeProgress] ENTER EXIT, allDone =\", allDone());\r\n      if (allDone()) {\r\n        WA.nav.goToRoom(NEXT_ROOM);\r\n      } else {\r\n        WA.ui.openPopup(\r\n          \"safeinternet_gate_popup\",\r\n          ` Hold up!\\n\\nYou still need to complete:\\n ${missingList().join(\"\\n \")}\\n\\nFind all 3 clues and talk to Amelia before leaving.`,\r\n          [{ label: \"OK\", className: \"primary\", callback: (p) => p.close() }]\r\n        );\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n/* ---------- Helpers ---------- */\r\nfunction allDone(): boolean {\r\n  return goals.poster && goals.usbdrive && goals.stickynote && goals.AmeliaZone;\r\n}\r\n\r\nfunction missingList(): string[] {\r\n  const out: string[] = [];\r\n  if (!goals.poster) out.push(\"Old Security Poster\");\r\n  if (!goals.usbdrive) out.push(\"USB Drive\");\r\n  if (!goals.stickynote) out.push(\"Sticky Note\");\r\n  if (!goals.AmeliaZone) out.push(\"Talk to Amelia (NPC)\");\r\n  return out;\r\n}\r\n\r\nfunction notifyProgress() {\r\n  const status = [\r\n    goals.poster ? \" Poster\" : \" Poster\",\r\n    goals.usbdrive ? \" USB\" : \" USB\",\r\n    goals.stickynote ? \" Sticky\" : \" Sticky Note\",\r\n    goals.AmeliaZone ? \" Amelia\" : \" Amelia\",\r\n  ].join(\"   \");\r\n\r\n  WA.ui.displayActionMessage({\r\n    message: `Progress: ${status}`,\r\n    callback: () => {},\r\n  });\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\nimport { bootstrapExtra } from \"@workadventure/scripting-api-extra\";\nimport { initClock } from \"./clock\";\nimport { initBoard } from \"./board\";\nimport { initMarvie } from \"./marvie\";\n\n//phishing - library room\nimport { initphishing_QRcode } from \"./phishing_qrcode\";\nimport { initphishing_MurdochEmail } from \"./phishing_murdochemail\";   //  add this\nimport { initphishing_SMSphishing } from \"./phishing_smsphishing\";\nimport { initPhishingLibraryProgress } from \"./phishing_libraryprogress\";\nimport { initPhishingInstructions } from \"./phishing_instructions\";\nimport { initPhishingLibrarySpawnNote } from \"./phishing_librarySpawnNote\";\nimport { initPhishingBrock } from \"./phishing_brock\";\n\n\nimport { initBillboard } from \"./billboard\";   //  add this\nimport { initSpawnIntro } from \"./spawnIntro\";\nimport { initInstructions } from \"./instructions\";   //  add this\nimport { initPoster } from \"./poster\";\nimport { initUsbDrive } from \"./usbdrive\";\nimport { initStickyNote } from \"./stickynote\";\nimport { initSafeInternetPractices } from \"./instructions_safeinternetpractices\";\nimport { initOfficeProgress } from \"./officeprogress\";\n\n\n\nconsole.log(\"Script started\");\n\nWA.onInit().then(async () => {\n  console.log(\"Scripting API ready\");\n  await bootstrapExtra();\n\n  // register features\n  initClock();\n  initBoard();\n  initMarvie();\n  \n  //phishing - library room\n  initphishing_QRcode();                       //  and call it\n  initphishing_MurdochEmail();\n  initphishing_SMSphishing();\n  initPhishingLibraryProgress();\n  initPhishingInstructions();\n  initPhishingLibrarySpawnNote();\n  initPhishingBrock();\n\n\n  initBillboard();\n  initSpawnIntro();\n  initInstructions();\n  initPoster();\n  initUsbDrive();\n  initStickyNote();\n  initSafeInternetPractices();\n  initOfficeProgress();\n});\n"],"names":["Properties","properties","name","values","property","type","value","types","defaultAssetsUrl","VariableDescriptor","object","readableBy","writableBy","openConfig","variables","parameters","getVariables","layerFilter","variablesFilter","map","getAllVariablesRecursive","layers","layer","layersMapPromise","getLayersMap","getLayersMapWithoutCache","flattenGroupLayersMap","flatLayers","flattenGroupLayers","prefix","getAreaObject","areaArray","findLayerBoundaries","left","top","bottom","right","data","j","i","findLayersBoundaries","boundaries","objectToString","isArray","isFunction","typeStr","obj","escapeRegExp","string","hasProperty","propName","primitiveHasOwnProperty","primitive","regExpTest","testRegExp","re","nonSpaceRe","isWhitespace","entityMap","escapeHtml","s","whiteRe","spaceRe","equalsRe","curlyRe","tagRe","parseTemplate","template","tags","lineHasNonSpace","sections","tokens","spaces","hasTag","nonSpace","indentation","tagIndex","stripSpace","openingTagRe","closingTagRe","closingCurlyRe","compileTags","tagsToCompile","mustache","scanner","Scanner","start","chr","token","openSection","valueLength","nestTokens","squashTokens","squashedTokens","lastToken","numTokens","nestedTokens","collector","section","match","index","Context","view","parentContext","cache","context","intermediateValue","names","lookupHit","Writer","key","cacheKey","isCacheEnabled","partials","config","originalTemplate","buffer","symbol","self","subRender","partial","filteredIndentation","partialByNl","indentedValue","escape","defaultWriter","TemplateValue","state","Mustache","callback","subscriptions","variableName","newValue","subscription","ast","subAst","initPropertiesTemplatesArea","_a","areas","area","setPropertyArea","initPropertiesTemplates","layerName","setProperty","areaName","propertyName","workadventureAssetsHtmlUrl","layersMap","playerX","playerY","updateDoorLayers","variable","playOpenSound","url","radius","volume","distance","getDistance","playCloseSound","getTileLayers","layerNames","xLayer","yLayer","initDoor","initDoorstep","doorstepZone","doorVariable","assetsUrl","actionMessage","keypadWebsite","inZone","tag","allowed","accessRestricted","displayCloseDoorMessage","displayOpenDoorMessage","openKeypad","closeKeypad","onEnter","onLeave","playBellSound","initBell","initBellLayer","bellVariable","bellZone","popup","bellPopupName","objectName","initDoors","doorVariableName","moveEvent","initVariableActionLayer","enterValue","leaveValue","triggerMessage","setupVariableActionLayer","actionMessagePopup","e","initSpecialProperties","initConfiguration","configurationLayer","openConfigVariables","initLocalConfigurationPanel","allowedByTag","displayConfigurationMessage","closeConfigurationPanel","openConfigTriggerValue","bootstrapExtra","currentPopup","initClock","now","hh","mm","boardPopupRef","initBoard","close","text","marviePopupRef","closeMarviePopup","getMessageForZone","_b","props","p","x","initMarvie","message","previewRef","AREA","ANCHOR","initphishing_QRcode","closePopup","initphishing_MurdochEmail","initphishing_SMSphishing","goals","EXIT_AREA_NAME","NEXT_ROOM","initPhishingLibraryProgress","egg","notifyProgress","allDone","missingList","out","done","popupRef","initPhishingInstructions","openPopup","ref","leaveSub","closeNote","openNote","initPhishingLibrarySpawnNote","brockPopupRef","initPhishingBrock","enterSub","initialized","initBillboard","spawnPopupRef","initSpawnIntro","openSpawnIntro","closeSpawnIntro","initInstructions","POPUP_ANCHOR","show","hide","initPoster","initUsbDrive","initStickyNote","initSafeInternetPractices","initOfficeProgress","status"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]}