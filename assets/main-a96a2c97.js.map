{"version":3,"file":"main-a96a2c97.js","sources":["../../node_modules/@workadventure/scripting-api-extra/dist/Properties.js","../../node_modules/@workadventure/scripting-api-extra/dist/Features/default_assets_url.js","../../node_modules/@workadventure/scripting-api-extra/dist/VariablesExtra.js","../../node_modules/@workadventure/scripting-api-extra/dist/LayersFlattener.js","../../node_modules/@workadventure/scripting-api-extra/dist/AreaObject.js","../../node_modules/@workadventure/scripting-api-extra/dist/LayersExtra.js","../../node_modules/mustache/mustache.mjs","../../node_modules/@workadventure/scripting-api-extra/dist/TemplateValue.js","../../node_modules/@workadventure/scripting-api-extra/dist/Features/properties_templates.js","../../node_modules/@workadventure/scripting-api-extra/dist/Features/workadventure_assets_url.js","../../node_modules/@workadventure/scripting-api-extra/dist/Features/doors.js","../../node_modules/@workadventure/scripting-api-extra/dist/Features/variable_actions.js","../../node_modules/@workadventure/scripting-api-extra/dist/Features/special_properties.js","../../node_modules/@workadventure/scripting-api-extra/dist/Features/configuration.js","../../node_modules/@workadventure/scripting-api-extra/dist/init.js","../../src/clock.ts","../../src/board.ts","../../src/marvie.ts","../../src/phishing_progress.ts","../../src/malware_progress.ts","../../src/passwordsecurity_progress.ts","../../src/idtheft_progress.ts","../../src/safeinternetpractices_progress.ts","../../src/finalboss_progress.ts","../../src/progresschecker.ts","../../src/phishing_qrcode.ts","../../src/phishing_murdochemail.ts","../../src/phishing_smsphishing.ts","../../src/phishing_instructions.ts","../../src/phishing_librarySpawnNote.ts","../../src/billboard.ts","../../src/spawnIntro.ts","../../src/instructions.ts","../../src/poster.ts","../../src/usbdrive.ts","../../src/stickynote.ts","../../src/instructions_safeinternetpractices.ts","../../src/officeprogress.ts","../../src/malware_instructions.ts","../../src/malware_discord.ts","../../src/malware_usbdrive.ts","../../src/malware_trojan.ts","../../src/passwordsecurity_instructions.ts","../../src/passwordsecurity_lmsaccount.ts","../../src/passwordsecurity_lmspasswordexpired.ts","../../src/passwordsecurity_unlockedpc.ts","../../src/safeinternetpractices_freewifi.ts","../../src/safeinternetpractices_fileuploads.ts","../../src/safeinternetpractices_outdatedsoftware.ts","../../src/safeinternetpractices_instructions.ts","../../src/idtheft_instructions.ts","../../src/idtheft_sensitivepapers.ts","../../src/idtheft_customerservicecall.ts","../../src/idtheft_celebration.ts","../../src/finalboss_spawn.ts","../../src/finalboss_cipherx.ts","../../src/endingmessage.ts","../../src/survey.ts","../../src/main.ts"],"sourcesContent":["export class Properties {\n    constructor(properties) {\n        this.properties = properties !== null && properties !== void 0 ? properties : [];\n    }\n    get(name) {\n        const values = this.properties\n            .filter((property) => property.name === name)\n            .map((property) => property.value);\n        if (values.length > 1) {\n            throw new Error('Expected only one property to be named \"' + name + '\"');\n        }\n        if (values.length === 0) {\n            return undefined;\n        }\n        return values[0];\n    }\n    getString(name) {\n        return this.getByType(name, \"string\");\n    }\n    getNumber(name) {\n        return this.getByType(name, \"number\");\n    }\n    getBoolean(name) {\n        return this.getByType(name, \"boolean\");\n    }\n    getByType(name, type) {\n        const value = this.get(name);\n        if (value === undefined) {\n            return undefined;\n        }\n        if (type !== \"json\" && typeof value !== type) {\n            throw new Error('Expected property \"' + name + '\" to have type \"' + type + '\"');\n        }\n        return value;\n    }\n    mustGetString(name) {\n        return this.mustGetByType(name, \"string\");\n    }\n    mustGetNumber(name) {\n        return this.mustGetByType(name, \"number\");\n    }\n    mustGetBoolean(name) {\n        return this.mustGetByType(name, \"boolean\");\n    }\n    mustGetByType(name, type) {\n        const value = this.get(name);\n        if (value === undefined) {\n            throw new Error('Property \"' + name + '\" is missing');\n        }\n        if (type !== \"json\" && typeof value !== type) {\n            throw new Error('Expected property \"' + name + '\" to have type \"' + type + '\"');\n        }\n        return value;\n    }\n    getType(name) {\n        const types = this.properties\n            .filter((property) => property.name === name)\n            .map((property) => property.type);\n        if (types.length > 1) {\n            throw new Error('Expected only one property to be named \"' + name + '\"');\n        }\n        if (types.length === 0) {\n            return undefined;\n        }\n        return types[0];\n    }\n}\n//# sourceMappingURL=Properties.js.map","export const defaultAssetsUrl = \"https://unpkg.com/@workadventure/scripting-api-extra@1.9.10/dist\";\n//# sourceMappingURL=default_assets_url.js.map","import { Properties } from \"./Properties\";\nimport { defaultAssetsUrl } from \"./Features/default_assets_url\";\nexport class VariableDescriptor {\n    constructor(object) {\n        this.name = object.name;\n        this.x = object.x;\n        this.y = object.y;\n        this.properties = new Properties(object.properties);\n    }\n    get isReadable() {\n        const readableBy = this.properties.getString(\"readableBy\");\n        if (!readableBy) {\n            return true;\n        }\n        return WA.player.tags.includes(readableBy);\n    }\n    get isWritable() {\n        const writableBy = this.properties.getString(\"writableBy\");\n        if (!writableBy) {\n            return true;\n        }\n        return WA.player.tags.includes(writableBy);\n    }\n}\nexport function openConfig(variables) {\n    const parameters = variables ? \"#\" + variables.join() : \"\";\n    WA.nav.openCoWebSite(defaultAssetsUrl + \"/configuration.html\" + parameters, true);\n}\nexport async function getVariables(layerFilter, variablesFilter) {\n    const map = await WA.room.getTiledMap();\n    const variables = new Map();\n    getAllVariablesRecursive(map.layers, variables, layerFilter, variablesFilter);\n    return variables;\n}\nfunction getAllVariablesRecursive(layers, variables, layerFilter, variablesFilter) {\n    for (const layer of layers) {\n        if (layer.type === \"objectgroup\") {\n            for (const object of layer.objects) {\n                if (object.type === \"variable\" || object.class === \"variable\") {\n                    if (!!layerFilter && layer.name !== layerFilter)\n                        continue;\n                    if (!!variablesFilter && !variablesFilter.includes(object.name))\n                        continue;\n                    variables.set(object.name, new VariableDescriptor(object));\n                }\n            }\n        }\n        else if (layer.type === \"group\") {\n            getAllVariablesRecursive(layer.layers, variables, layerFilter, variablesFilter);\n        }\n    }\n}\n//# sourceMappingURL=VariablesExtra.js.map","let layersMapPromise = undefined;\nexport async function getLayersMap() {\n    if (layersMapPromise === undefined) {\n        layersMapPromise = getLayersMapWithoutCache();\n    }\n    return layersMapPromise;\n}\nasync function getLayersMapWithoutCache() {\n    return flattenGroupLayersMap((await WA.room.getTiledMap()));\n}\nfunction flattenGroupLayersMap(map) {\n    const flatLayers = new Map();\n    flattenGroupLayers(map.layers, \"\", flatLayers);\n    return flatLayers;\n}\nfunction flattenGroupLayers(layers, prefix, flatLayers) {\n    for (const layer of layers) {\n        if (layer.type === \"group\") {\n            flattenGroupLayers(layer.layers, prefix + layer.name + \"/\", flatLayers);\n        }\n        else {\n            layer.name = prefix + layer.name;\n            flatLayers.set(layer.name, layer);\n        }\n    }\n}\n//# sourceMappingURL=LayersFlattener.js.map","import { getLayersMap } from \"./LayersFlattener\";\nexport async function getAreaObject() {\n    const layers = await getLayersMap();\n    const areaArray = [];\n    for (const layer of layers.values()) {\n        if (layer.type === \"objectgroup\") {\n            for (const object of layer.objects) {\n                if (object.type === \"area\" || object.class === \"area\") {\n                    areaArray.push(object);\n                }\n            }\n        }\n    }\n    return areaArray;\n}\n//# sourceMappingURL=AreaObject.js.map","export function findLayerBoundaries(layer) {\n    let left = Infinity;\n    let top = Infinity;\n    let bottom = 0;\n    let right = 0;\n    const data = layer.data;\n    if (typeof data === \"string\") {\n        throw new Error(\"Unsupported tile layer data stored as string instead of CSV\");\n    }\n    for (let j = 0; j < layer.height; j++) {\n        for (let i = 0; i < layer.width; i++) {\n            if (data[i + j * layer.width] !== 0) {\n                left = Math.min(left, i);\n                right = Math.max(right, i);\n                top = Math.min(top, j);\n                bottom = Math.max(bottom, j);\n            }\n        }\n    }\n    return {\n        top,\n        left,\n        right: right + 1,\n        bottom: bottom + 1,\n    };\n}\nexport function findLayersBoundaries(layers) {\n    let left = Infinity;\n    let top = Infinity;\n    let bottom = 0;\n    let right = 0;\n    for (const layer of layers) {\n        const boundaries = findLayerBoundaries(layer);\n        if (boundaries.left < left) {\n            left = boundaries.left;\n        }\n        if (boundaries.top < top) {\n            top = boundaries.top;\n        }\n        if (boundaries.right > right) {\n            right = boundaries.right;\n        }\n        if (boundaries.bottom > bottom) {\n            bottom = boundaries.bottom;\n        }\n    }\n    return {\n        top,\n        left,\n        right,\n        bottom,\n    };\n}\n//# sourceMappingURL=LayersExtra.js.map","/*!\n * mustache.js - Logic-less {{mustache}} templates with JavaScript\n * http://github.com/janl/mustache.js\n */\n\nvar objectToString = Object.prototype.toString;\nvar isArray = Array.isArray || function isArrayPolyfill (object) {\n  return objectToString.call(object) === '[object Array]';\n};\n\nfunction isFunction (object) {\n  return typeof object === 'function';\n}\n\n/**\n * More correct typeof string handling array\n * which normally returns typeof 'object'\n */\nfunction typeStr (obj) {\n  return isArray(obj) ? 'array' : typeof obj;\n}\n\nfunction escapeRegExp (string) {\n  return string.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, '\\\\$&');\n}\n\n/**\n * Null safe way of checking whether or not an object,\n * including its prototype, has a given property\n */\nfunction hasProperty (obj, propName) {\n  return obj != null && typeof obj === 'object' && (propName in obj);\n}\n\n/**\n * Safe way of detecting whether or not the given thing is a primitive and\n * whether it has the given property\n */\nfunction primitiveHasOwnProperty (primitive, propName) {\n  return (\n    primitive != null\n    && typeof primitive !== 'object'\n    && primitive.hasOwnProperty\n    && primitive.hasOwnProperty(propName)\n  );\n}\n\n// Workaround for https://issues.apache.org/jira/browse/COUCHDB-577\n// See https://github.com/janl/mustache.js/issues/189\nvar regExpTest = RegExp.prototype.test;\nfunction testRegExp (re, string) {\n  return regExpTest.call(re, string);\n}\n\nvar nonSpaceRe = /\\S/;\nfunction isWhitespace (string) {\n  return !testRegExp(nonSpaceRe, string);\n}\n\nvar entityMap = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;',\n  '/': '&#x2F;',\n  '`': '&#x60;',\n  '=': '&#x3D;'\n};\n\nfunction escapeHtml (string) {\n  return String(string).replace(/[&<>\"'`=\\/]/g, function fromEntityMap (s) {\n    return entityMap[s];\n  });\n}\n\nvar whiteRe = /\\s*/;\nvar spaceRe = /\\s+/;\nvar equalsRe = /\\s*=/;\nvar curlyRe = /\\s*\\}/;\nvar tagRe = /#|\\^|\\/|>|\\{|&|=|!/;\n\n/**\n * Breaks up the given `template` string into a tree of tokens. If the `tags`\n * argument is given here it must be an array with two string values: the\n * opening and closing tags used in the template (e.g. [ \"<%\", \"%>\" ]). Of\n * course, the default is to use mustaches (i.e. mustache.tags).\n *\n * A token is an array with at least 4 elements. The first element is the\n * mustache symbol that was used inside the tag, e.g. \"#\" or \"&\". If the tag\n * did not contain a symbol (i.e. {{myValue}}) this element is \"name\". For\n * all text that appears outside a symbol this element is \"text\".\n *\n * The second element of a token is its \"value\". For mustache tags this is\n * whatever else was inside the tag besides the opening symbol. For text tokens\n * this is the text itself.\n *\n * The third and fourth elements of the token are the start and end indices,\n * respectively, of the token in the original template.\n *\n * Tokens that are the root node of a subtree contain two more elements: 1) an\n * array of tokens in the subtree and 2) the index in the original template at\n * which the closing tag for that section begins.\n *\n * Tokens for partials also contain two more elements: 1) a string value of\n * indendation prior to that tag and 2) the index of that tag on that line -\n * eg a value of 2 indicates the partial is the third tag on this line.\n */\nfunction parseTemplate (template, tags) {\n  if (!template)\n    return [];\n  var lineHasNonSpace = false;\n  var sections = [];     // Stack to hold section tokens\n  var tokens = [];       // Buffer to hold the tokens\n  var spaces = [];       // Indices of whitespace tokens on the current line\n  var hasTag = false;    // Is there a {{tag}} on the current line?\n  var nonSpace = false;  // Is there a non-space char on the current line?\n  var indentation = '';  // Tracks indentation for tags that use it\n  var tagIndex = 0;      // Stores a count of number of tags encountered on a line\n\n  // Strips all whitespace tokens array for the current line\n  // if there was a {{#tag}} on it and otherwise only space.\n  function stripSpace () {\n    if (hasTag && !nonSpace) {\n      while (spaces.length)\n        delete tokens[spaces.pop()];\n    } else {\n      spaces = [];\n    }\n\n    hasTag = false;\n    nonSpace = false;\n  }\n\n  var openingTagRe, closingTagRe, closingCurlyRe;\n  function compileTags (tagsToCompile) {\n    if (typeof tagsToCompile === 'string')\n      tagsToCompile = tagsToCompile.split(spaceRe, 2);\n\n    if (!isArray(tagsToCompile) || tagsToCompile.length !== 2)\n      throw new Error('Invalid tags: ' + tagsToCompile);\n\n    openingTagRe = new RegExp(escapeRegExp(tagsToCompile[0]) + '\\\\s*');\n    closingTagRe = new RegExp('\\\\s*' + escapeRegExp(tagsToCompile[1]));\n    closingCurlyRe = new RegExp('\\\\s*' + escapeRegExp('}' + tagsToCompile[1]));\n  }\n\n  compileTags(tags || mustache.tags);\n\n  var scanner = new Scanner(template);\n\n  var start, type, value, chr, token, openSection;\n  while (!scanner.eos()) {\n    start = scanner.pos;\n\n    // Match any text between tags.\n    value = scanner.scanUntil(openingTagRe);\n\n    if (value) {\n      for (var i = 0, valueLength = value.length; i < valueLength; ++i) {\n        chr = value.charAt(i);\n\n        if (isWhitespace(chr)) {\n          spaces.push(tokens.length);\n          indentation += chr;\n        } else {\n          nonSpace = true;\n          lineHasNonSpace = true;\n          indentation += ' ';\n        }\n\n        tokens.push([ 'text', chr, start, start + 1 ]);\n        start += 1;\n\n        // Check for whitespace on the current line.\n        if (chr === '\\n') {\n          stripSpace();\n          indentation = '';\n          tagIndex = 0;\n          lineHasNonSpace = false;\n        }\n      }\n    }\n\n    // Match the opening tag.\n    if (!scanner.scan(openingTagRe))\n      break;\n\n    hasTag = true;\n\n    // Get the tag type.\n    type = scanner.scan(tagRe) || 'name';\n    scanner.scan(whiteRe);\n\n    // Get the tag value.\n    if (type === '=') {\n      value = scanner.scanUntil(equalsRe);\n      scanner.scan(equalsRe);\n      scanner.scanUntil(closingTagRe);\n    } else if (type === '{') {\n      value = scanner.scanUntil(closingCurlyRe);\n      scanner.scan(curlyRe);\n      scanner.scanUntil(closingTagRe);\n      type = '&';\n    } else {\n      value = scanner.scanUntil(closingTagRe);\n    }\n\n    // Match the closing tag.\n    if (!scanner.scan(closingTagRe))\n      throw new Error('Unclosed tag at ' + scanner.pos);\n\n    if (type == '>') {\n      token = [ type, value, start, scanner.pos, indentation, tagIndex, lineHasNonSpace ];\n    } else {\n      token = [ type, value, start, scanner.pos ];\n    }\n    tagIndex++;\n    tokens.push(token);\n\n    if (type === '#' || type === '^') {\n      sections.push(token);\n    } else if (type === '/') {\n      // Check section nesting.\n      openSection = sections.pop();\n\n      if (!openSection)\n        throw new Error('Unopened section \"' + value + '\" at ' + start);\n\n      if (openSection[1] !== value)\n        throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + start);\n    } else if (type === 'name' || type === '{' || type === '&') {\n      nonSpace = true;\n    } else if (type === '=') {\n      // Set the tags for the next time around.\n      compileTags(value);\n    }\n  }\n\n  stripSpace();\n\n  // Make sure there are no open sections when we're done.\n  openSection = sections.pop();\n\n  if (openSection)\n    throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + scanner.pos);\n\n  return nestTokens(squashTokens(tokens));\n}\n\n/**\n * Combines the values of consecutive text tokens in the given `tokens` array\n * to a single token.\n */\nfunction squashTokens (tokens) {\n  var squashedTokens = [];\n\n  var token, lastToken;\n  for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n    token = tokens[i];\n\n    if (token) {\n      if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {\n        lastToken[1] += token[1];\n        lastToken[3] = token[3];\n      } else {\n        squashedTokens.push(token);\n        lastToken = token;\n      }\n    }\n  }\n\n  return squashedTokens;\n}\n\n/**\n * Forms the given array of `tokens` into a nested tree structure where\n * tokens that represent a section have two additional items: 1) an array of\n * all tokens that appear in that section and 2) the index in the original\n * template that represents the end of that section.\n */\nfunction nestTokens (tokens) {\n  var nestedTokens = [];\n  var collector = nestedTokens;\n  var sections = [];\n\n  var token, section;\n  for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n    token = tokens[i];\n\n    switch (token[0]) {\n      case '#':\n      case '^':\n        collector.push(token);\n        sections.push(token);\n        collector = token[4] = [];\n        break;\n      case '/':\n        section = sections.pop();\n        section[5] = token[2];\n        collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;\n        break;\n      default:\n        collector.push(token);\n    }\n  }\n\n  return nestedTokens;\n}\n\n/**\n * A simple string scanner that is used by the template parser to find\n * tokens in template strings.\n */\nfunction Scanner (string) {\n  this.string = string;\n  this.tail = string;\n  this.pos = 0;\n}\n\n/**\n * Returns `true` if the tail is empty (end of string).\n */\nScanner.prototype.eos = function eos () {\n  return this.tail === '';\n};\n\n/**\n * Tries to match the given regular expression at the current position.\n * Returns the matched text if it can match, the empty string otherwise.\n */\nScanner.prototype.scan = function scan (re) {\n  var match = this.tail.match(re);\n\n  if (!match || match.index !== 0)\n    return '';\n\n  var string = match[0];\n\n  this.tail = this.tail.substring(string.length);\n  this.pos += string.length;\n\n  return string;\n};\n\n/**\n * Skips all text until the given regular expression can be matched. Returns\n * the skipped string, which is the entire tail if no match can be made.\n */\nScanner.prototype.scanUntil = function scanUntil (re) {\n  var index = this.tail.search(re), match;\n\n  switch (index) {\n    case -1:\n      match = this.tail;\n      this.tail = '';\n      break;\n    case 0:\n      match = '';\n      break;\n    default:\n      match = this.tail.substring(0, index);\n      this.tail = this.tail.substring(index);\n  }\n\n  this.pos += match.length;\n\n  return match;\n};\n\n/**\n * Represents a rendering context by wrapping a view object and\n * maintaining a reference to the parent context.\n */\nfunction Context (view, parentContext) {\n  this.view = view;\n  this.cache = { '.': this.view };\n  this.parent = parentContext;\n}\n\n/**\n * Creates a new context using the given view with this context\n * as the parent.\n */\nContext.prototype.push = function push (view) {\n  return new Context(view, this);\n};\n\n/**\n * Returns the value of the given name in this context, traversing\n * up the context hierarchy if the value is absent in this context's view.\n */\nContext.prototype.lookup = function lookup (name) {\n  var cache = this.cache;\n\n  var value;\n  if (cache.hasOwnProperty(name)) {\n    value = cache[name];\n  } else {\n    var context = this, intermediateValue, names, index, lookupHit = false;\n\n    while (context) {\n      if (name.indexOf('.') > 0) {\n        intermediateValue = context.view;\n        names = name.split('.');\n        index = 0;\n\n        /**\n         * Using the dot notion path in `name`, we descend through the\n         * nested objects.\n         *\n         * To be certain that the lookup has been successful, we have to\n         * check if the last object in the path actually has the property\n         * we are looking for. We store the result in `lookupHit`.\n         *\n         * This is specially necessary for when the value has been set to\n         * `undefined` and we want to avoid looking up parent contexts.\n         *\n         * In the case where dot notation is used, we consider the lookup\n         * to be successful even if the last \"object\" in the path is\n         * not actually an object but a primitive (e.g., a string, or an\n         * integer), because it is sometimes useful to access a property\n         * of an autoboxed primitive, such as the length of a string.\n         **/\n        while (intermediateValue != null && index < names.length) {\n          if (index === names.length - 1)\n            lookupHit = (\n              hasProperty(intermediateValue, names[index])\n              || primitiveHasOwnProperty(intermediateValue, names[index])\n            );\n\n          intermediateValue = intermediateValue[names[index++]];\n        }\n      } else {\n        intermediateValue = context.view[name];\n\n        /**\n         * Only checking against `hasProperty`, which always returns `false` if\n         * `context.view` is not an object. Deliberately omitting the check\n         * against `primitiveHasOwnProperty` if dot notation is not used.\n         *\n         * Consider this example:\n         * ```\n         * Mustache.render(\"The length of a football field is {{#length}}{{length}}{{/length}}.\", {length: \"100 yards\"})\n         * ```\n         *\n         * If we were to check also against `primitiveHasOwnProperty`, as we do\n         * in the dot notation case, then render call would return:\n         *\n         * \"The length of a football field is 9.\"\n         *\n         * rather than the expected:\n         *\n         * \"The length of a football field is 100 yards.\"\n         **/\n        lookupHit = hasProperty(context.view, name);\n      }\n\n      if (lookupHit) {\n        value = intermediateValue;\n        break;\n      }\n\n      context = context.parent;\n    }\n\n    cache[name] = value;\n  }\n\n  if (isFunction(value))\n    value = value.call(this.view);\n\n  return value;\n};\n\n/**\n * A Writer knows how to take a stream of tokens and render them to a\n * string, given a context. It also maintains a cache of templates to\n * avoid the need to parse the same template twice.\n */\nfunction Writer () {\n  this.templateCache = {\n    _cache: {},\n    set: function set (key, value) {\n      this._cache[key] = value;\n    },\n    get: function get (key) {\n      return this._cache[key];\n    },\n    clear: function clear () {\n      this._cache = {};\n    }\n  };\n}\n\n/**\n * Clears all cached templates in this writer.\n */\nWriter.prototype.clearCache = function clearCache () {\n  if (typeof this.templateCache !== 'undefined') {\n    this.templateCache.clear();\n  }\n};\n\n/**\n * Parses and caches the given `template` according to the given `tags` or\n * `mustache.tags` if `tags` is omitted,  and returns the array of tokens\n * that is generated from the parse.\n */\nWriter.prototype.parse = function parse (template, tags) {\n  var cache = this.templateCache;\n  var cacheKey = template + ':' + (tags || mustache.tags).join(':');\n  var isCacheEnabled = typeof cache !== 'undefined';\n  var tokens = isCacheEnabled ? cache.get(cacheKey) : undefined;\n\n  if (tokens == undefined) {\n    tokens = parseTemplate(template, tags);\n    isCacheEnabled && cache.set(cacheKey, tokens);\n  }\n  return tokens;\n};\n\n/**\n * High-level method that is used to render the given `template` with\n * the given `view`.\n *\n * The optional `partials` argument may be an object that contains the\n * names and templates of partials that are used in the template. It may\n * also be a function that is used to load partial templates on the fly\n * that takes a single argument: the name of the partial.\n *\n * If the optional `config` argument is given here, then it should be an\n * object with a `tags` attribute or an `escape` attribute or both.\n * If an array is passed, then it will be interpreted the same way as\n * a `tags` attribute on a `config` object.\n *\n * The `tags` attribute of a `config` object must be an array with two\n * string values: the opening and closing tags used in the template (e.g.\n * [ \"<%\", \"%>\" ]). The default is to mustache.tags.\n *\n * The `escape` attribute of a `config` object must be a function which\n * accepts a string as input and outputs a safely escaped string.\n * If an `escape` function is not provided, then an HTML-safe string\n * escaping function is used as the default.\n */\nWriter.prototype.render = function render (template, view, partials, config) {\n  var tags = this.getConfigTags(config);\n  var tokens = this.parse(template, tags);\n  var context = (view instanceof Context) ? view : new Context(view, undefined);\n  return this.renderTokens(tokens, context, partials, template, config);\n};\n\n/**\n * Low-level method that renders the given array of `tokens` using\n * the given `context` and `partials`.\n *\n * Note: The `originalTemplate` is only ever used to extract the portion\n * of the original template that was contained in a higher-order section.\n * If the template doesn't use higher-order sections, this argument may\n * be omitted.\n */\nWriter.prototype.renderTokens = function renderTokens (tokens, context, partials, originalTemplate, config) {\n  var buffer = '';\n\n  var token, symbol, value;\n  for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n    value = undefined;\n    token = tokens[i];\n    symbol = token[0];\n\n    if (symbol === '#') value = this.renderSection(token, context, partials, originalTemplate, config);\n    else if (symbol === '^') value = this.renderInverted(token, context, partials, originalTemplate, config);\n    else if (symbol === '>') value = this.renderPartial(token, context, partials, config);\n    else if (symbol === '&') value = this.unescapedValue(token, context);\n    else if (symbol === 'name') value = this.escapedValue(token, context, config);\n    else if (symbol === 'text') value = this.rawValue(token);\n\n    if (value !== undefined)\n      buffer += value;\n  }\n\n  return buffer;\n};\n\nWriter.prototype.renderSection = function renderSection (token, context, partials, originalTemplate, config) {\n  var self = this;\n  var buffer = '';\n  var value = context.lookup(token[1]);\n\n  // This function is used to render an arbitrary template\n  // in the current context by higher-order sections.\n  function subRender (template) {\n    return self.render(template, context, partials, config);\n  }\n\n  if (!value) return;\n\n  if (isArray(value)) {\n    for (var j = 0, valueLength = value.length; j < valueLength; ++j) {\n      buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate, config);\n    }\n  } else if (typeof value === 'object' || typeof value === 'string' || typeof value === 'number') {\n    buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate, config);\n  } else if (isFunction(value)) {\n    if (typeof originalTemplate !== 'string')\n      throw new Error('Cannot use higher-order sections without the original template');\n\n    // Extract the portion of the original template that the section contains.\n    value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);\n\n    if (value != null)\n      buffer += value;\n  } else {\n    buffer += this.renderTokens(token[4], context, partials, originalTemplate, config);\n  }\n  return buffer;\n};\n\nWriter.prototype.renderInverted = function renderInverted (token, context, partials, originalTemplate, config) {\n  var value = context.lookup(token[1]);\n\n  // Use JavaScript's definition of falsy. Include empty arrays.\n  // See https://github.com/janl/mustache.js/issues/186\n  if (!value || (isArray(value) && value.length === 0))\n    return this.renderTokens(token[4], context, partials, originalTemplate, config);\n};\n\nWriter.prototype.indentPartial = function indentPartial (partial, indentation, lineHasNonSpace) {\n  var filteredIndentation = indentation.replace(/[^ \\t]/g, '');\n  var partialByNl = partial.split('\\n');\n  for (var i = 0; i < partialByNl.length; i++) {\n    if (partialByNl[i].length && (i > 0 || !lineHasNonSpace)) {\n      partialByNl[i] = filteredIndentation + partialByNl[i];\n    }\n  }\n  return partialByNl.join('\\n');\n};\n\nWriter.prototype.renderPartial = function renderPartial (token, context, partials, config) {\n  if (!partials) return;\n  var tags = this.getConfigTags(config);\n\n  var value = isFunction(partials) ? partials(token[1]) : partials[token[1]];\n  if (value != null) {\n    var lineHasNonSpace = token[6];\n    var tagIndex = token[5];\n    var indentation = token[4];\n    var indentedValue = value;\n    if (tagIndex == 0 && indentation) {\n      indentedValue = this.indentPartial(value, indentation, lineHasNonSpace);\n    }\n    var tokens = this.parse(indentedValue, tags);\n    return this.renderTokens(tokens, context, partials, indentedValue, config);\n  }\n};\n\nWriter.prototype.unescapedValue = function unescapedValue (token, context) {\n  var value = context.lookup(token[1]);\n  if (value != null)\n    return value;\n};\n\nWriter.prototype.escapedValue = function escapedValue (token, context, config) {\n  var escape = this.getConfigEscape(config) || mustache.escape;\n  var value = context.lookup(token[1]);\n  if (value != null)\n    return (typeof value === 'number' && escape === mustache.escape) ? String(value) : escape(value);\n};\n\nWriter.prototype.rawValue = function rawValue (token) {\n  return token[1];\n};\n\nWriter.prototype.getConfigTags = function getConfigTags (config) {\n  if (isArray(config)) {\n    return config;\n  }\n  else if (config && typeof config === 'object') {\n    return config.tags;\n  }\n  else {\n    return undefined;\n  }\n};\n\nWriter.prototype.getConfigEscape = function getConfigEscape (config) {\n  if (config && typeof config === 'object' && !isArray(config)) {\n    return config.escape;\n  }\n  else {\n    return undefined;\n  }\n};\n\nvar mustache = {\n  name: 'mustache.js',\n  version: '4.2.0',\n  tags: [ '{{', '}}' ],\n  clearCache: undefined,\n  escape: undefined,\n  parse: undefined,\n  render: undefined,\n  Scanner: undefined,\n  Context: undefined,\n  Writer: undefined,\n  /**\n   * Allows a user to override the default caching strategy, by providing an\n   * object with set, get and clear methods. This can also be used to disable\n   * the cache by setting it to the literal `undefined`.\n   */\n  set templateCache (cache) {\n    defaultWriter.templateCache = cache;\n  },\n  /**\n   * Gets the default or overridden caching object from the default writer.\n   */\n  get templateCache () {\n    return defaultWriter.templateCache;\n  }\n};\n\n// All high-level mustache.* functions use this writer.\nvar defaultWriter = new Writer();\n\n/**\n * Clears all cached templates in the default writer.\n */\nmustache.clearCache = function clearCache () {\n  return defaultWriter.clearCache();\n};\n\n/**\n * Parses and caches the given template in the default writer and returns the\n * array of tokens it contains. Doing this ahead of time avoids the need to\n * parse templates on the fly as they are rendered.\n */\nmustache.parse = function parse (template, tags) {\n  return defaultWriter.parse(template, tags);\n};\n\n/**\n * Renders the `template` with the given `view`, `partials`, and `config`\n * using the default writer.\n */\nmustache.render = function render (template, view, partials, config) {\n  if (typeof template !== 'string') {\n    throw new TypeError('Invalid template! Template should be a \"string\" ' +\n                        'but \"' + typeStr(template) + '\" was given as the first ' +\n                        'argument for mustache#render(template, view, partials)');\n  }\n\n  return defaultWriter.render(template, view, partials, config);\n};\n\n// Export the escaping function so that the user may override it.\n// See https://github.com/janl/mustache.js/issues/244\nmustache.escape = escapeHtml;\n\n// Export these mainly for testing, but also for advanced usage.\nmustache.Scanner = Scanner;\nmustache.Context = Context;\nmustache.Writer = Writer;\n\nexport default mustache;\n","import Mustache from \"mustache\";\nexport class TemplateValue {\n    constructor(template, state) {\n        this.template = template;\n        this.state = state;\n        this.ast = Mustache.parse(template);\n    }\n    getValue() {\n        if (this.value === undefined) {\n            this.value = Mustache.render(this.template, this.state);\n        }\n        return this.value;\n    }\n    onChange(callback) {\n        const subscriptions = [];\n        for (const variableName of this.getUsedVariables().values()) {\n            subscriptions.push(this.state.onVariableChange(variableName).subscribe(() => {\n                const newValue = Mustache.render(this.template, this.state);\n                if (newValue !== this.value) {\n                    this.value = newValue;\n                    callback(this.value);\n                }\n            }));\n        }\n        return {\n            unsubscribe: () => {\n                for (const subscription of subscriptions) {\n                    subscription.unsubscribe();\n                }\n            },\n        };\n    }\n    isPureString() {\n        return this.ast.length === 0 || (this.ast.length === 1 && this.ast[0][0] === \"text\");\n    }\n    getUsedVariables() {\n        const variables = new Set();\n        this.recursiveGetUsedVariables(this.ast, variables);\n        return variables;\n    }\n    recursiveGetUsedVariables(ast, variables) {\n        for (const token of ast) {\n            const type = token[0];\n            const name = token[1];\n            const subAst = token[4];\n            if ([\"name\", \"&\", \"#\", \"^\"].includes(type)) {\n                variables.add(name);\n            }\n            if (subAst !== undefined && typeof subAst !== \"string\") {\n                this.recursiveGetUsedVariables(subAst, variables);\n            }\n        }\n    }\n}\n//# sourceMappingURL=TemplateValue.js.map","import { getLayersMap } from \"../LayersFlattener\";\nimport { TemplateValue } from \"../TemplateValue\";\nimport { getAreaObject } from \"../AreaObject\";\nexport async function initPropertiesTemplatesArea() {\n    var _a;\n    const areas = await getAreaObject();\n    for (const area of areas) {\n        const properties = (_a = area.properties) !== null && _a !== void 0 ? _a : [];\n        for (const property of properties) {\n            if (property.type === \"int\" ||\n                property.type === \"bool\" ||\n                property.type === \"object\" ||\n                typeof property.value !== \"string\") {\n                continue;\n            }\n            const template = new TemplateValue(property.value, WA.state);\n            if (template.isPureString()) {\n                continue;\n            }\n            const newValue = template.getValue();\n            await setPropertyArea(area.name, property.name, newValue);\n            template.onChange(async (newValue) => {\n                await setPropertyArea(area.name, property.name, newValue);\n            });\n        }\n    }\n}\nexport async function initPropertiesTemplates() {\n    var _a;\n    const layers = await getLayersMap();\n    for (const [layerName, layer] of layers.entries()) {\n        if (layer.type !== \"objectgroup\") {\n            const properties = (_a = layer.properties) !== null && _a !== void 0 ? _a : [];\n            for (const property of properties) {\n                if (property.type === \"int\" ||\n                    property.type === \"bool\" ||\n                    property.type === \"object\" ||\n                    typeof property.value !== \"string\") {\n                    continue;\n                }\n                const template = new TemplateValue(property.value, WA.state);\n                if (template.isPureString()) {\n                    continue;\n                }\n                const newValue = template.getValue();\n                setProperty(layerName, property.name, newValue);\n                template.onChange((newValue) => {\n                    setProperty(layerName, property.name, newValue);\n                });\n            }\n        }\n    }\n}\nasync function setPropertyArea(areaName, propertyName, value) {\n    console.log(areaName);\n    const area = await WA.room.area.get(areaName);\n    area.setProperty(propertyName, value);\n}\nfunction setProperty(layerName, propertyName, value) {\n    WA.room.setProperty(layerName, propertyName, value);\n    if (propertyName === \"visible\") {\n        if (value) {\n            WA.room.showLayer(layerName);\n        }\n        else {\n            WA.room.hideLayer(layerName);\n        }\n    }\n}\n//# sourceMappingURL=properties_templates.js.map","export const workadventureAssetsHtmlUrl = \"https://admin.workadventu.re/html\";\n//# sourceMappingURL=workadventure_assets_url.js.map","import { getVariables } from \"../VariablesExtra\";\nimport { getLayersMap } from \"../LayersFlattener\";\nimport { Properties } from \"../Properties\";\nimport { findLayersBoundaries } from \"../LayersExtra\";\nimport { defaultAssetsUrl } from \"./default_assets_url\";\nimport { workadventureAssetsHtmlUrl } from \"./workadventure_assets_url\";\nimport { getAreaObject } from \"../AreaObject\";\nlet layersMap;\nlet playerX = 0;\nlet playerY = 0;\nfunction updateDoorLayers(variable) {\n    if (WA.state[variable.name]) {\n        let layers = variable.properties.mustGetString(\"openLayer\");\n        for (const layer of layers.split(\"\\n\")) {\n            WA.room.showLayer(layer);\n        }\n        layers = variable.properties.mustGetString(\"closeLayer\");\n        for (const layer of layers.split(\"\\n\")) {\n            WA.room.hideLayer(layer);\n        }\n    }\n    else {\n        let layers = variable.properties.mustGetString(\"openLayer\");\n        for (const layer of layers.split(\"\\n\")) {\n            WA.room.hideLayer(layer);\n        }\n        layers = variable.properties.mustGetString(\"closeLayer\");\n        for (const layer of layers.split(\"\\n\")) {\n            WA.room.showLayer(layer);\n        }\n    }\n}\nfunction playOpenSound(variable) {\n    const url = variable.properties.getString(\"openSound\");\n    const radius = variable.properties.getNumber(\"soundRadius\");\n    let volume = 1;\n    if (radius) {\n        const distance = getDistance(variable.properties.mustGetString(\"openLayer\").split(\"\\n\"));\n        if (distance > radius) {\n            return;\n        }\n        volume = 1 - distance / radius;\n    }\n    if (url) {\n        WA.sound.loadSound(url).play({\n            volume,\n        });\n    }\n}\nfunction playCloseSound(variable) {\n    const url = variable.properties.getString(\"closeSound\");\n    const radius = variable.properties.getNumber(\"soundRadius\");\n    let volume = 1;\n    if (radius) {\n        const distance = getDistance(variable.properties.mustGetString(\"closeLayer\").split(\"\\n\"));\n        if (distance > radius) {\n            return;\n        }\n        volume = 1 - distance / radius;\n    }\n    if (url) {\n        WA.sound.loadSound(url).play({\n            volume,\n        });\n    }\n}\nfunction getTileLayers(layerNames) {\n    return layerNames\n        .map((layerName) => layersMap.get(layerName))\n        .filter((layer) => (layer === null || layer === void 0 ? void 0 : layer.type) === \"tilelayer\");\n}\nfunction getDistance(layerNames) {\n    const layers = getTileLayers(layerNames);\n    const boundaries = findLayersBoundaries(layers);\n    const xLayer = ((boundaries.right - boundaries.left) / 2 + boundaries.left) * 32;\n    const yLayer = ((boundaries.bottom - boundaries.top) / 2 + boundaries.top) * 32;\n    return Math.sqrt(Math.pow(playerX - xLayer, 2) + Math.pow(playerY - yLayer, 2));\n}\nfunction initDoor(variable) {\n    WA.state.onVariableChange(variable.name).subscribe(() => {\n        if (WA.state[variable.name]) {\n            playOpenSound(variable);\n        }\n        else {\n            playCloseSound(variable);\n        }\n        updateDoorLayers(variable);\n    });\n    updateDoorLayers(variable);\n}\nfunction initDoorstep(doorstepZone, doorVariable, properties, assetsUrl) {\n    const name = doorstepZone.name;\n    let actionMessage = undefined;\n    let keypadWebsite = undefined;\n    let inZone = false;\n    const tag = properties.getString(\"tag\");\n    let allowed = true;\n    if (tag && !WA.player.tags.includes(tag)) {\n        allowed = false;\n    }\n    const accessRestricted = !!tag;\n    function displayCloseDoorMessage() {\n        var _a;\n        if (actionMessage) {\n            actionMessage.remove();\n        }\n        actionMessage = WA.ui.displayActionMessage({\n            message: (_a = properties.getString(\"closeTriggerMessage\")) !== null && _a !== void 0 ? _a : \"Press SPACE to close the door\",\n            callback: () => {\n                WA.state[doorVariable.name] = false;\n                displayOpenDoorMessage();\n            },\n        });\n    }\n    function displayOpenDoorMessage() {\n        var _a;\n        if (actionMessage) {\n            actionMessage.remove();\n        }\n        actionMessage = WA.ui.displayActionMessage({\n            message: (_a = properties.getString(\"openTriggerMessage\")) !== null && _a !== void 0 ? _a : \"Press SPACE to open the door\",\n            callback: () => {\n                WA.state[doorVariable.name] = true;\n                displayCloseDoorMessage();\n            },\n        });\n    }\n    function openKeypad() {\n        let boundaries;\n        if (doorstepZone.type === \"tilelayer\") {\n            boundaries = findLayersBoundaries(getTileLayers(doorVariable.properties.mustGetString(\"closeLayer\").split(\"\\n\")));\n        }\n        else {\n            if (doorstepZone.x === undefined ||\n                doorstepZone.y === undefined ||\n                doorstepZone.width === undefined ||\n                doorstepZone.height === undefined) {\n                throw new Error(`Doorstep zone \"${doorstepZone.name}\" is missing x, y, width or height`);\n            }\n            boundaries = {\n                top: doorstepZone.y,\n                left: doorstepZone.x,\n                right: doorstepZone.x + doorstepZone.width,\n                bottom: doorstepZone.y + doorstepZone.height,\n            };\n        }\n        keypadWebsite = WA.room.website.create({\n            name: \"doorKeypad\" + name,\n            url: assetsUrl + \"/keypad.html#\" + encodeURIComponent(name),\n            position: {\n                x: boundaries.right * 32,\n                y: boundaries.top * 32,\n                width: 32 * 3,\n                height: 32 * 4,\n            },\n            allowApi: true,\n        });\n    }\n    function closeKeypad() {\n        if (keypadWebsite) {\n            WA.room.website.delete(keypadWebsite.name);\n            keypadWebsite = undefined;\n        }\n    }\n    function onEnter() {\n        inZone = true;\n        if (properties.getBoolean(\"autoOpen\") && allowed) {\n            WA.state[doorVariable.name] = true;\n            return;\n        }\n        if (!WA.state[doorVariable.name] &&\n            ((accessRestricted && !allowed) || !accessRestricted) &&\n            (properties.getString(\"code\") || properties.getString(\"codeVariable\"))) {\n            openKeypad();\n            return;\n        }\n        if (!allowed) {\n            return;\n        }\n        if (WA.state[doorVariable.name]) {\n            displayCloseDoorMessage();\n        }\n        else {\n            displayOpenDoorMessage();\n        }\n    }\n    function onLeave() {\n        inZone = false;\n        if (properties.getBoolean(\"autoClose\")) {\n            WA.state[doorVariable.name] = false;\n        }\n        if (actionMessage) {\n            actionMessage.remove();\n        }\n        closeKeypad();\n    }\n    if (doorstepZone.type === \"tilelayer\") {\n        WA.room.onEnterLayer(name).subscribe(onEnter);\n        WA.room.onLeaveLayer(name).subscribe(onLeave);\n    }\n    else {\n        WA.room.area.onEnter(name).subscribe(onEnter);\n        WA.room.area.onLeave(name).subscribe(onLeave);\n    }\n    WA.state.onVariableChange(doorVariable.name).subscribe(() => {\n        if (inZone) {\n            if (!properties.getBoolean(\"autoClose\") && WA.state[doorVariable.name] === true) {\n                displayCloseDoorMessage();\n            }\n            if (keypadWebsite && WA.state[doorVariable.name] === true) {\n                closeKeypad();\n            }\n            if (!properties.getBoolean(\"autoOpen\") && WA.state[doorVariable.name] === false) {\n                displayOpenDoorMessage();\n            }\n        }\n    });\n}\nfunction playBellSound(variable) {\n    const url = variable.properties.mustGetString(\"bellSound\");\n    const radius = variable.properties.getNumber(\"soundRadius\");\n    let volume = 1;\n    if (radius) {\n        const distance = Math.sqrt(Math.pow(variable.x - playerX, 2) + Math.pow(variable.y - playerY, 2));\n        if (distance > radius) {\n            return;\n        }\n        volume = 1 - distance / radius;\n    }\n    WA.sound.loadSound(url).play({\n        volume,\n    });\n}\nfunction initBell(variable) {\n    if (WA.state[variable.name] === undefined) {\n        WA.state[variable.name] = 0;\n    }\n    WA.state.onVariableChange(variable.name).subscribe(() => {\n        if (WA.state[variable.name]) {\n            playBellSound(variable);\n        }\n    });\n}\nfunction initBellLayer(bellVariable, properties, bellZone) {\n    let popup = undefined;\n    const bellPopupName = properties.getString(\"bellPopup\");\n    if (bellZone.type === \"tilelayer\") {\n        const layerName = bellZone.name;\n        WA.room.onEnterLayer(layerName).subscribe(() => {\n            var _a;\n            if (!bellPopupName) {\n                WA.state[bellVariable] = WA.state[bellVariable] + 1;\n            }\n            else {\n                popup = WA.ui.openPopup(bellPopupName, \"\", [\n                    {\n                        label: (_a = properties.getString(\"bellButtonText\")) !== null && _a !== void 0 ? _a : \"Ring\",\n                        callback: () => {\n                            WA.state[bellVariable] = WA.state[bellVariable] + 1;\n                        },\n                    },\n                ]);\n            }\n        });\n        WA.room.onLeaveLayer(layerName).subscribe(() => {\n            if (popup) {\n                popup.close();\n                popup = undefined;\n            }\n        });\n    }\n    else {\n        const objectName = bellZone.name;\n        WA.room.area.onEnter(objectName).subscribe(() => {\n            var _a;\n            if (!bellPopupName) {\n                WA.state[bellVariable] = WA.state[bellVariable] + 1;\n            }\n            else {\n                popup = WA.ui.openPopup(bellPopupName, \"\", [\n                    {\n                        label: (_a = properties.getString(\"bellButtonText\")) !== null && _a !== void 0 ? _a : \"Ring\",\n                        callback: () => {\n                            WA.state[bellVariable] = WA.state[bellVariable] + 1;\n                        },\n                    },\n                ]);\n            }\n        });\n        WA.room.area.onLeave(objectName).subscribe(() => {\n            if (popup) {\n                popup.close();\n                popup = undefined;\n            }\n        });\n    }\n}\nexport async function initDoors(assetsUrl) {\n    assetsUrl = assetsUrl !== null && assetsUrl !== void 0 ? assetsUrl : (workadventureAssetsHtmlUrl || defaultAssetsUrl);\n    const variables = await getVariables();\n    layersMap = await getLayersMap();\n    for (const variable of variables.values()) {\n        if (variable.properties.get(\"door\")) {\n            initDoor(variable);\n        }\n        if (variable.properties.get(\"bell\")) {\n            initBell(variable);\n        }\n    }\n    for (const layer of layersMap.values()) {\n        const properties = new Properties(layer.properties);\n        const doorVariableName = properties.getString(\"doorVariable\");\n        if (doorVariableName && layer.type === \"tilelayer\") {\n            const doorVariable = variables.get(doorVariableName);\n            if (doorVariable === undefined) {\n                throw new Error('Cannot find variable \"' +\n                    doorVariableName +\n                    '\" referred in the \"doorVariable\" property of layer \"' +\n                    layer.name +\n                    '\"');\n            }\n            initDoorstep(layer, doorVariable, properties, assetsUrl);\n        }\n        const bellVariable = properties.getString(\"bellVariable\");\n        if (bellVariable && layer.type === \"tilelayer\") {\n            initBellLayer(bellVariable, properties, layer);\n        }\n    }\n    for (const object of await getAreaObject()) {\n        const properties = new Properties(object.properties);\n        const doorVariableName = properties.getString(\"doorVariable\");\n        if (doorVariableName) {\n            const doorVariable = variables.get(doorVariableName);\n            if (doorVariable === undefined) {\n                throw new Error('Cannot find variable \"' +\n                    doorVariableName +\n                    '\" referred in the \"doorVariable\" property of object \"' +\n                    object.name +\n                    '\"');\n            }\n            initDoorstep(object, doorVariable, properties, assetsUrl);\n        }\n        const bellVariable = properties.getString(\"bellVariable\");\n        if (bellVariable) {\n            initBellLayer(bellVariable, properties, object);\n        }\n    }\n    WA.player.onPlayerMove((moveEvent) => {\n        playerX = moveEvent.x;\n        playerY = moveEvent.y;\n    });\n}\n//# sourceMappingURL=doors.js.map","export function initVariableActionLayer(properties, layerName) {\n    const variableName = properties.getString(\"bindVariable\");\n    if (variableName) {\n        const enterValue = properties.get(\"enterValue\");\n        const leaveValue = properties.get(\"leaveValue\");\n        const triggerMessage = properties.getString(\"triggerMessage\");\n        const tag = properties.getString(\"tag\");\n        setupVariableActionLayer(variableName, layerName, enterValue, leaveValue, triggerMessage, tag);\n    }\n}\nlet actionMessagePopup;\nfunction setupVariableActionLayer(variableName, layerName, enterValue, leaveValue, triggerMessage, tag) {\n    if (tag && !WA.player.tags.includes(tag)) {\n        return;\n    }\n    if (enterValue !== undefined) {\n        WA.room.onEnterLayer(layerName).subscribe(() => {\n            if (triggerMessage) {\n                actionMessagePopup = WA.ui.displayActionMessage({\n                    type: \"message\",\n                    message: triggerMessage,\n                    callback: () => {\n                        WA.state[variableName] = enterValue;\n                    },\n                });\n            }\n            else {\n                WA.state[variableName] = enterValue;\n            }\n        });\n    }\n    if (leaveValue !== undefined) {\n        WA.room.onLeaveLayer(layerName).subscribe(() => {\n            WA.state[variableName] = leaveValue;\n            if (actionMessagePopup) {\n                actionMessagePopup.remove().catch((e) => {\n                    console.error(e);\n                });\n                actionMessagePopup = undefined;\n            }\n        });\n    }\n}\n//# sourceMappingURL=variable_actions.js.map","import { getLayersMap } from \"../LayersFlattener\";\nimport { Properties } from \"../Properties\";\nimport { initVariableActionLayer } from \"./variable_actions\";\nexport async function initSpecialProperties() {\n    const layers = await getLayersMap();\n    for (const layer of layers.values()) {\n        const properties = new Properties(layer.properties);\n        initVariableActionLayer(properties, layer.name);\n    }\n}\n//# sourceMappingURL=special_properties.js.map","import { Properties } from \"../Properties\";\nimport { defaultAssetsUrl } from \"./default_assets_url\";\nimport { getLayersMap } from \"../LayersFlattener\";\nimport { openConfig } from \"../VariablesExtra\";\nlet layersMap;\nexport async function initConfiguration(assetsUrl) {\n    const map = (await WA.room.getTiledMap());\n    assetsUrl = assetsUrl !== null && assetsUrl !== void 0 ? assetsUrl : defaultAssetsUrl;\n    layersMap = await getLayersMap();\n    const configurationLayer = map.layers.find((layer) => layer.name === \"configuration\");\n    if (configurationLayer) {\n        const properties = new Properties(configurationLayer.properties);\n        const tag = properties.getString(\"tag\");\n        if (!tag || WA.player.tags.includes(tag)) {\n            WA.ui.registerMenuCommand(\"Configure the room\", () => {\n                WA.nav.openCoWebSite(assetsUrl + \"/configuration.html\", true);\n            });\n        }\n        for (const layer of layersMap.values()) {\n            const properties = new Properties(layer.properties);\n            const openConfigVariables = properties.getString(\"openConfig\");\n            if (openConfigVariables && layer.type === \"tilelayer\") {\n                initLocalConfigurationPanel(openConfigVariables.split(\",\"), layer.name, properties);\n            }\n        }\n    }\n}\nfunction initLocalConfigurationPanel(openConfigVariables, layerName, properties) {\n    let actionMessage = undefined;\n    const tag = properties.getString(\"openConfigAdminTag\");\n    let allowedByTag = true;\n    if (tag && !WA.player.tags.includes(tag)) {\n        allowedByTag = false;\n    }\n    function displayConfigurationMessage() {\n        var _a;\n        if (actionMessage) {\n            actionMessage.remove();\n        }\n        actionMessage = WA.ui.displayActionMessage({\n            message: (_a = properties.getString(\"openConfigTriggerMessage\")) !== null && _a !== void 0 ? _a : \"Press SPACE or touch here to configure\",\n            callback: () => openConfig(openConfigVariables),\n        });\n    }\n    function closeConfigurationPanel() {\n        WA.nav.closeCoWebSite();\n    }\n    WA.room.onEnterLayer(layerName).subscribe(() => {\n        const openConfigTriggerValue = properties.getString(\"openConfigTrigger\");\n        if (allowedByTag) {\n            if (openConfigTriggerValue && openConfigTriggerValue === \"onaction\") {\n                displayConfigurationMessage();\n            }\n            else {\n                openConfig(openConfigVariables);\n            }\n        }\n    });\n    WA.room.onLeaveLayer(layerName).subscribe(() => {\n        if (actionMessage) {\n            actionMessage.remove();\n            closeConfigurationPanel();\n        }\n        else {\n            closeConfigurationPanel();\n        }\n    });\n}\n//# sourceMappingURL=configuration.js.map","import { initDoors } from \"./Features/doors\";\nimport { initSpecialProperties } from \"./Features/special_properties\";\nimport { initConfiguration } from \"./Features/configuration\";\nimport { initPropertiesTemplates, initPropertiesTemplatesArea, } from \"./Features/properties_templates\";\nexport function bootstrapExtra() {\n    return WA.onInit()\n        .then(() => {\n        initDoors().catch((e) => console.error(e));\n        initSpecialProperties().catch((e) => console.error(e));\n        initConfiguration().catch((e) => console.error(e));\n        initPropertiesTemplates().catch((e) => console.error(e));\n        initPropertiesTemplatesArea().catch((e) => console.error(e));\n    })\n        .catch((e) => console.error(e));\n}\n//# sourceMappingURL=init.js.map","let currentPopup: any | undefined;\r\n\r\nexport function initClock() {\r\n  WA.room.area.onEnter(\"clock\").subscribe(() => {\r\n    const now = new Date();\r\n    const hh = String(now.getHours()).padStart(2, \"0\");\r\n    const mm = String(now.getMinutes()).padStart(2, \"0\");\r\n\r\n    // close old popup if any\r\n    if (currentPopup) currentPopup.close();\r\n\r\n    // open new popup\r\n    currentPopup = WA.ui.openPopup(\"clockPopup\", `It's ${hh}:${mm}`, []);\r\n  });\r\n\r\n  WA.room.area.onLeave(\"clock\").subscribe(() => {\r\n    if (currentPopup) {\r\n      currentPopup.close();\r\n      currentPopup = undefined;\r\n    }\r\n  });\r\n}\r\n","let boardPopupRef: any | undefined;\r\n\r\nexport function initBoard() {\r\n  const close = () => {\r\n    if (boardPopupRef) {\r\n      boardPopupRef.close();\r\n      boardPopupRef = undefined;\r\n    }\r\n  };\r\n\r\n  WA.room.area.onEnter(\"board\").subscribe(() => {\r\n    close();\r\n    const text =\r\n      \"The bulletin board hums with strange energy. Five portals shimmer before youchoose your path:  Malware  malicious code that corrupts, spies, and destroys   Phishing/Quishing  fake messages or QR Codes that trick you into giving secrets   Identity Theft  criminals using your identity   xxxxxxxxxxxx   Password Security  strong, unique passwords and MFA to protect your accounts.\";\r\n    boardPopupRef = WA.ui.openPopup(\"boardPopup\", text, []);\r\n  });\r\n\r\n  WA.room.area.onLeave(\"board\").subscribe(close);\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet marviePopupRef: any | undefined;\r\n\r\nfunction closeMarviePopup() {\r\n  if (marviePopupRef) {\r\n    try { marviePopupRef.close?.(); } catch {}\r\n    marviePopupRef = undefined;\r\n  }\r\n}\r\n\r\nfunction getMessageForZone(): string {\r\n  try {\r\n    const obj = (WA.room as any).object?.get?.(\"MarvieZone\");\r\n    if (obj && obj.properties) {\r\n      const props = obj.properties;\r\n      if (Array.isArray(props)) {\r\n        const p = props.find((x: any) => x.name === \"marvieMessage\" || x.name === \"marviePopup\");\r\n        if (p?.value) return String(p.value);\r\n      } else if (props.marvieMessage) {\r\n        return String(props.marvieMessage);\r\n      }\r\n    }\r\n  } catch {}\r\n  return [\r\n    \" Hi  I'm Marvie.\",\r\n    \"\",\r\n    \"Welcome to the Room of Malware.\",\r\n\t\"Do you think you can find the 3 easter eggs around the map?\",\r\n    \"Tip: Check the walls, the chairs or the floor for suspicious objects.\",\r\n  ].join(\"\\n\");\r\n}\r\n\r\nexport function initMarvie() {\r\n  console.log(\"[Marvie] init\");\r\n\r\n  WA.room.area.onEnter(\"MarvieZone\").subscribe(() => {\r\n    closeMarviePopup();\r\n    const message = getMessageForZone();\r\n    marviePopupRef = WA.ui.openPopup(\"marviePopup\", message, [\r\n      { label: \"Got it\", callback: () => closeMarviePopup() },\r\n    ]);\r\n  });\r\n\r\n  WA.room.area.onLeave(\"MarvieZone\").subscribe(() => {\r\n    closeMarviePopup();\r\n  });\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\n/** Progress config for the LIBRARY (Phishing) room */\r\nexport const PHISHING_PROGRESS: Record<\r\n  string,\r\n  {\r\n    tasks: { key: string; label: string; area: string }[];\r\n    exitGate?: { area: string; nextRoom: string; warnAnchorId?: string };\r\n  }\r\n> = {\r\n  library: {\r\n    tasks: [\r\n      { key: \"phishing_SMSphishing\",  label: \"SMS\",         area: \"phishing_SMSphishing\" },\r\n      { key: \"phishing_MurdochEmail\", label: \"MurdochEmail\", area: \"phishing_MurdochEmail\" },\r\n      { key: \"phishing_QRcode\",       label: \"QRcode\",      area: \"phishing_QRcode\" },\r\n      { key: \"phishing_instructions\", label: \"PPT Slides\",  area: \"phishing_instructions\" },\r\n    ],\r\n    exitGate: {\r\n      area: \"to-canteen\",\r\n      nextRoom: \"canteen.tmj#from-library\",\r\n      warnAnchorId: \"phishing_gate_popup\",\r\n    },\r\n  },\r\n};\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\n/** Progress config for the CANTEEN (Malware) room */\r\nexport const MALWARE_PROGRESS: Record<\r\n  string,\r\n  {\r\n    tasks: { key: string; label: string; area: string }[];\r\n    exitGate?: { area: string; nextRoom: string; warnAnchorId?: string };\r\n  }\r\n> = {\r\n  canteen: {\r\n    tasks: [\r\n      { key: \"malware_instructions\", label: \"Slides\",  area: \"malware_instructions\" },\r\n      { key: \"malware_discord\",      label: \"Discord\", area: \"malware_discord\" },\r\n      { key: \"malware_usbdrive\",     label: \"USB\",     area: \"malware_usbdrive\" },\r\n      { key: \"malware_trojan\",       label: \"Trojan\",  area: \"malware_trojan\" },\r\n    ],\r\n    exitGate: {\r\n      area: \"to-classroom\",                    // area name in Tiled\r\n      nextRoom: \"classroom.tmj#from-canteen\",  // destination when ALL tasks done\r\n      warnAnchorId: \"malware_gate_popup\",      // anchor rectangle near stairs\r\n    },\r\n  },\r\n};\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\n/** Progress config for the CLASSROOM (Password Security) room */\r\nexport const PASSWORDSECURITY_PROGRESS: Record<\r\n  string,\r\n  {\r\n    tasks: { key: string; label: string; area: string }[];\r\n    exitGate?: { area: string; nextRoom: string; warnAnchorId?: string };\r\n  }\r\n> = {\r\n  classroom: {\r\n    tasks: [\r\n      { key: \"passwordsecurity_instructions\",      label: \"Slides\",            area: \"passwordsecurity_instructions\" },\r\n      { key: \"passwordsecurity_lmsaccount\",        label: \"LMS Account\",       area: \"passwordsecurity_lmsaccount\" },\r\n      { key: \"passwordsecurity_lmspasswordexpired\",label: \"Password Expired\",  area: \"passwordsecurity_lmspasswordexpired\" },\r\n      { key: \"passwordsecurity_unlockedpc\",        label: \"Unlocked PC\",       area: \"passwordsecurity_unlockedpc\" },\r\n    ],\r\n    exitGate: {\r\n      area: \"to-hall\",                              // area name in Tiled (stairs/door)\r\n      nextRoom: \"hall.tmj#from-classroom\",          // destination when ALL tasks done\r\n      warnAnchorId: \"passwordsecurity_gate_popup\",    // anchor rectangle near exit\r\n    },\r\n  },\r\n};\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\nimport { initProgressChecker } from \"./progresschecker\";\r\n\r\n/** Progress config for the COMPUTER LAB (ID Theft) room */\r\nexport const IDTHEFT_PROGRESS: Record<\r\n  string,\r\n  {\r\n    tasks: { key: string; label: string; area: string }[];\r\n    exitGate?: { area: string; nextRoom: string; warnAnchorId?: string };\r\n  }\r\n> = {\r\n  computerlab: {\r\n    tasks: [\r\n      { key: \"idtheft_instructions\",       label: \"Slides\",                 area: \"idtheft_instructions\" },\r\n      { key: \"idtheft_sensitivepapers\",    label: \"Sensitive Papers\",       area: \"idtheft_sensitivepapers\" },\r\n      { key: \"idtheft_customerservicecall\",label: \"Customer Service Call\",  area: \"idtheft_customerservicecall\" },\r\n      { key: \"idtheft_celebration\",        label: \"Celebration\",            area: \"idtheft_celebration\" },\r\n    ],\r\n    exitGate: {\r\n      area: \"to-office\",\r\n      nextRoom: \"office.tmj#from-computerlab\",           // TODO: set to your actual Office room path/id\r\n      warnAnchorId: \"idtheft_gate_popup\",\r\n    },\r\n  },\r\n};\r\n\r\n/** Helper to wire up this rooms progress with your generic checker */\r\nexport function initIDTheftProgress() {\r\n  // If your checker expects just the object, this works. Otherwise, adapt as needed.\r\n  // @ts-ignore - generic checker may be typed loosely\r\n  initProgressChecker(IDTHEFT_PROGRESS.computerlab);\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\n/** Progress config for the HALL (Safe Internet Practices) */\r\nexport const SAFEINTERNETPRACTICES_PROGRESS: Record<\r\n  string,\r\n  {\r\n    tasks: { key: string; label: string; area: string }[];\r\n    exitGate?: { area: string; nextRoom: string; warnAnchorId?: string };\r\n  }\r\n> = {\r\n  hall: {\r\n    tasks: [\r\n      { key: \"safeinternetpractices_instructions\",     label: \"Slides\",             area: \"safeinternetpractices_instructions\" },\r\n      { key: \"safeinternetpractices_freewifi\",          label: \"Free Wi-Fi\",         area: \"safeinternetpractices_freewifi\" },\r\n      { key: \"safeinternetpractices_fileuploads\",       label: \"File Uploads\",       area: \"safeinternetpractices_fileuploads\" },\r\n      { key: \"safeinternetpractices_outdatedsoftware\",  label: \"Outdated Software\",  area: \"safeinternetpractices_outdatedsoftware\" },\r\n    ],\r\n    exitGate: {\r\n      area: \"to-computerlab\",                            // door/exit area in Tiled\r\n      nextRoom: \"computerlab.tmj#from-hall\",             // next room once all tasks are done\r\n      warnAnchorId: \"safeinternetpractices_gate_popup\",  // anchor rectangle near the exit\r\n    },\r\n  },\r\n};\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\nimport { initProgressChecker } from \"./progresschecker\";\r\n\r\n/** Progress config for the OFFICE (Final Boss) room */\r\nexport const FINALBOSS_PROGRESS: Record<\r\n  string,\r\n  {\r\n    tasks: { key: string; label: string; area: string }[];\r\n    exitGate?: { area: string; nextRoom: string; warnAnchorId?: string };\r\n  }\r\n> = {\r\n  office: {\r\n    tasks: [\r\n      // Boss encounter area (popup  Twine quiz)\r\n      { key: \"finalboss\",   label: \"Face CipherX\",     area: \"finalboss_cipherx\" },\r\n\r\n    ],\r\n    // No exit gate for final room (end of game). Add one here if you later need it.\r\n    // exitGate: { area: \"to-somewhere\", nextRoom: \"garden\", warnAnchorId: \"finalboss_gate_popup\" },\r\n  },\r\n};\r\n\r\n/** Helper to initialize this maps progress */\r\nexport function initFinalBossProgress() {\r\n  // @ts-ignore - generic checker accepts SingleMapConfig\r\n  initProgressChecker(FINALBOSS_PROGRESS.office);\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\nimport { PHISHING_PROGRESS } from \"./phishing_progress\";\r\nimport { MALWARE_PROGRESS } from \"./malware_progress\";\r\nimport { PASSWORDSECURITY_PROGRESS } from \"./passwordsecurity_progress\";\r\nimport { IDTHEFT_PROGRESS } from \"./idtheft_progress\";\r\nimport { SAFEINTERNETPRACTICES_PROGRESS } from \"./safeinternetpractices_progress\";\r\nimport { FINALBOSS_PROGRESS } from \"./finalboss_progress\"; //  NEW\r\n\r\n/* ------------ types (local to this file) ------------ */\r\ntype Task = { key: string; label: string; area: string };\r\ntype SingleMapConfig = {\r\n  tasks: Task[];\r\n  exitGate?: { area: string; nextRoom: string; warnAnchorId?: string };\r\n};\r\ntype MapConfigRecord = Record<string, SingleMapConfig>;\r\ntype Goals = Record<string, boolean>;\r\n\r\n/* ------------ merge per-room configs ------------ */\r\nconst MAP_CONFIG: MapConfigRecord = {\r\n  ...PHISHING_PROGRESS,\r\n  ...MALWARE_PROGRESS,\r\n  ...PASSWORDSECURITY_PROGRESS,\r\n  ...IDTHEFT_PROGRESS,\r\n  ...SAFEINTERNETPRACTICES_PROGRESS,\r\n  ...FINALBOSS_PROGRESS, //  NEW\r\n};\r\n\r\n/* ------------ storage helpers ------------ */\r\nconst STORAGE_PREFIX = \"cr:goals:\";\r\nconst storageKey = (mapId: string) => `${STORAGE_PREFIX}${mapId}`;\r\n\r\nfunction saveGoals(mapId: string, goals: Goals) {\r\n  try { localStorage.setItem(storageKey(mapId), JSON.stringify(goals)); } catch {}\r\n}\r\nfunction loadGoals(mapId: string): Goals | null {\r\n  try {\r\n    const raw = localStorage.getItem(storageKey(mapId));\r\n    return raw ? (JSON.parse(raw) as Goals) : null;\r\n  } catch { return null; }\r\n}\r\n/** Remove goals from all *other* maps (prevents cross-map stacking). */\r\nfunction clearOtherMaps(currentMapId: string) {\r\n  try {\r\n    const toDelete: string[] = [];\r\n    for (let i = 0; i < localStorage.length; i++) {\r\n      const k = localStorage.key(i);\r\n      if (k && k.startsWith(STORAGE_PREFIX) && !k.endsWith(currentMapId)) toDelete.push(k);\r\n    }\r\n    toDelete.forEach(k => localStorage.removeItem(k));\r\n  } catch {}\r\n}\r\n\r\n/* ------------ module state ------------ */\r\nlet goals: Goals = {};\r\nlet currentTasks: Task[] = [];\r\nlet toastCooldown = 0;\r\n\r\nlet gatePopupRef: ReturnType<typeof WA.ui.openPopup> | undefined;\r\nlet gateCooldown = 0;\r\nlet exiting = false;\r\nlet initializedForMap = \"\"; // prevent double init if script persists\r\n\r\n/* ------------ public API ------------ */\r\nexport function initProgressChecker() {\r\n  WA.onInit().then(async () => {\r\n    const mapId = (await getMapId()) || \"\";\r\n    if (!mapId) {\r\n      console.log(\"[ProgressChecker] No mapId resolved.\");\r\n      return;\r\n    }\r\n    if (initializedForMap === mapId) return;\r\n    initializedForMap = mapId;\r\n\r\n    const cfg = MAP_CONFIG[mapId];\r\n\r\n    // Clean slate on map load\r\n    hardCloseAllUi();\r\n    clearOtherMaps(mapId);\r\n\r\n    if (!cfg) {\r\n      console.log(\"[ProgressChecker] No config for map:\", mapId);\r\n      return;\r\n    }\r\n\r\n    console.log(\"[ProgressChecker] Init for map:\", mapId);\r\n    currentTasks = cfg.tasks;\r\n\r\n    // Restore progress (clamped to current task keys)\r\n    const restored = loadGoals(mapId);\r\n    const defaultGoals = Object.fromEntries(currentTasks.map(t => [t.key, false]));\r\n    goals = { ...defaultGoals, ...(restored ?? {}) };\r\n\r\n    // Safety: close UI on unload\r\n    window.addEventListener(\"beforeunload\", () => hardCloseAllUi(), { passive: true });\r\n\r\n    // --- Task listeners ---\r\n    currentTasks.forEach(t => {\r\n      try {\r\n        WA.room.area.onEnter(t.area).subscribe(() => {\r\n          if (exiting) return;\r\n\r\n          if (!goals[t.key]) {\r\n            goals[t.key] = true;\r\n            saveGoals(mapId, goals);\r\n            showProgress();\r\n\r\n            if (allDone()) {\r\n              WA.ui.displayActionMessage({\r\n                message: \" All tasks done! You may proceed to the exit.\",\r\n                callback: () => {},\r\n              });\r\n            }\r\n          }\r\n        });\r\n      } catch (e) {\r\n        console.warn(`[ProgressChecker] area '${t.area}' not found on this map`, e);\r\n      }\r\n    });\r\n\r\n    // --- Exit gate listener ---\r\n    if (cfg.exitGate) {\r\n      const { area, nextRoom, warnAnchorId } = cfg.exitGate;\r\n\r\n      WA.room.area.onEnter(area).subscribe(() => {\r\n        if (exiting) return;\r\n\r\n        if (allDone()) {\r\n          exiting = true;\r\n          hardCloseAllUi();\r\n          try { WA.controls.disablePlayerControls(); } catch {}\r\n          try { localStorage.removeItem(storageKey(mapId)); } catch {}\r\n          setTimeout(() => WA.nav.goToRoom(nextRoom), 40);\r\n          return;\r\n        }\r\n\r\n        const now = Date.now();\r\n        if (now - gateCooldown < 500) return; // debounce\r\n        gateCooldown = now;\r\n\r\n        const missing = missingList();\r\n        if (warnAnchorId) {\r\n          try {\r\n            closeGatePopup();\r\n            gatePopupRef = WA.ui.openPopup(\r\n              warnAnchorId,\r\n              ` Hold up!\\n\\nYou still need to complete:\\n ${missing.join(\"\\n \")}\\n\\nFind all tasks in this room before leaving.`,\r\n              [{ label: \"Close\", className: \"primary\", callback: () => closeGatePopup() }]\r\n            );\r\n            return;\r\n          } catch {\r\n            // fall back to toast\r\n          }\r\n        }\r\n\r\n        WA.ui.displayActionMessage({\r\n          message: ` Hold up! Missing: ${missing.join(\", \")}`,\r\n          callback: () => {},\r\n        });\r\n      });\r\n\r\n      WA.room.area.onLeave(area).subscribe(() => {\r\n        closeGatePopup();\r\n        if (!exiting) gateCooldown = 0;\r\n      });\r\n    }\r\n\r\n    // Show initial progress shortly after load\r\n    setTimeout(() => { if (!exiting) showProgress(); }, 300);\r\n  });\r\n}\r\n\r\n/** Optional external hook */\r\nexport function markTaskDone(taskKey: string) {\r\n  if (exiting) return;\r\n  if (taskKey in goals && !goals[taskKey]) {\r\n    goals[taskKey] = true;\r\n    const mapId = initializedForMap || \"\";\r\n    if (mapId) saveGoals(mapId, goals);\r\n\r\n    showProgress();\r\n\r\n    if (allDone()) {\r\n      WA.ui.displayActionMessage({\r\n        message: \" All tasks done! You may proceed to the exit.\",\r\n        callback: () => {},\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\n/* ------------ internals ------------ */\r\nfunction allDone(): boolean {\r\n  return currentTasks.every(t => goals[t.key]);\r\n}\r\nfunction missingList(): string[] {\r\n  return currentTasks.filter(t => !goals[t.key]).map(t => t.label);\r\n}\r\nfunction showProgress() {\r\n  if (exiting) return;\r\n  const now = Date.now();\r\n  if (now - toastCooldown < 150) return; // debounce\r\n  toastCooldown = now;\r\n\r\n  const line = currentTasks\r\n    .map(t => (goals[t.key] ? ` ${t.label}` : ` ${t.label}`))\r\n    .join(\"   \");\r\n\r\n  WA.ui.displayActionMessage({ message: `Progress:  ${line}`, callback: () => {} });\r\n}\r\nfunction closeGatePopup() {\r\n  try { gatePopupRef?.close?.(); } catch {}\r\n  gatePopupRef = undefined;\r\n}\r\nfunction hardCloseAllUi() {\r\n  closeGatePopup();\r\n}\r\n\r\n/* mapId helper */\r\nasync function getMapId(): Promise<string> {\r\n  try {\r\n    const m = decodeURIComponent(location.href).match(/\\/([^\\/?#]+)\\.tmj/i);\r\n    if (m?.[1]) return m[1].toLowerCase();\r\n  } catch {}\r\n  try {\r\n    const tiled: any = await WA.room.getTiledMap?.();\r\n    const props = tiled?.properties as Array<{ name: string; value: any }> | undefined;\r\n    const fromProp = props?.find(p => p?.name === \"mapId\")?.value;\r\n    if (typeof fromProp === \"string\" && fromProp.trim()) return fromProp.trim().toLowerCase();\r\n  } catch {}\r\n  return \"\";\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet previewRef: any | undefined;\r\n\r\nconst AREA   = \"phishing_QRcode\";\r\nconst ANCHOR = \"phishing_QRcodePopup\";\r\n\r\nexport function initphishing_QRcode() {\r\n  WA.onInit().then(() => {\r\n    WA.room.area.onEnter(AREA).subscribe(() => {\r\n      closePopup();\r\n      previewRef = WA.ui.openPopup(\r\n        ANCHOR,\r\n        \" You spot a poster in the library:FREE NUGGETS FOR LIFE  Scan Me! Your friend insists it looks real, but scanning random QR codes can lead to fake websites or data theft. What would you do? Press SPACE to help!\",\r\n        [{ label: \"Got it\", callback: () => closePopup() }]\r\n      );\r\n    });\r\n\r\n    WA.room.area.onLeave(AREA).subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction closePopup() {\r\n  try {\r\n    if (previewRef) {\r\n      previewRef.close?.();\r\n      previewRef = undefined; // important!\r\n    }\r\n  } catch {\r\n    previewRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet previewRef: any | undefined;\r\n\r\nconst AREA   = \"phishing_MurdochEmail\";\r\nconst ANCHOR = \"phishing_MurdochEmailPopup\";\r\n\r\nexport function initphishing_MurdochEmail() {\r\n  WA.onInit().then(() => {\r\n    // Enter -> open (after closing any stray instance)\r\n    WA.room.area.onEnter(AREA).subscribe(() => {\r\n      closePopup();\r\n      previewRef = WA.ui.openPopup(\r\n        ANCHOR,\r\n        \" You received an email: Your university fees are overdue. Click here to pay immediately.\\n\\n This looks suspicious... What would you do? Press SPACE to help!\",\r\n        [\r\n          {\r\n            label: \"Got it\",\r\n            callback: () => closePopup(),\r\n          },\r\n        ]\r\n      );\r\n    });\r\n\r\n    // Leave -> always close and clear reference\r\n    WA.room.area.onLeave(AREA).subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction closePopup() {\r\n  try {\r\n    if (previewRef) {\r\n      previewRef.close?.();\r\n      previewRef = undefined; //  make sure future cycles start clean\r\n    }\r\n  } catch {\r\n    // ignore\r\n    previewRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet previewRef: any | undefined;\r\n\r\nconst AREA   = \"phishing_SMSphishing\";\r\nconst ANCHOR = \"phishing_SMSphishingPopup\";\r\n\r\nexport function initphishing_SMSphishing() {\r\n  WA.onInit().then(() => {\r\n    WA.room.area.onEnter(AREA).subscribe(() => {\r\n      closePopup();\r\n      previewRef = WA.ui.openPopup(\r\n        ANCHOR,\r\n        \" You received a message: Your Murdoch account needs verification! Click here: https://tinyurl.com/murdoch-reset. Shortened links can hide where they actually lead. Always check the real destination before clicking! What would you do? Press SPACE to help!\",\r\n        [{ label: \"Got it\", callback: () => closePopup() }]\r\n      );\r\n    });\r\n\r\n    WA.room.area.onLeave(AREA).subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction closePopup() {\r\n  try {\r\n    if (previewRef) {\r\n      previewRef.close?.();\r\n      previewRef = undefined; // important!\r\n    }\r\n  } catch {\r\n    previewRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nexport function initPhishingInstructions() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Phishing sign instructions ready\");\r\n\r\n    // Open when entering the sign-board area\r\n    WA.room.area.onEnter(\"phishing_instructions\").subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    // Close when leaving the sign-board area\r\n    WA.room.area.onLeave(\"phishing_instructions\").subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // prevent duplicates\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"phishing_instructionsPopup\",\r\n    \" Quick! We saw one of the hackers going through this room! They are using phishing emails and dodgy QR codes to endanger students on campus! Before you chase after him, you should read these slides to learn how you can defend against Phishing.  \",\r\n    [\r\n      {\r\n        label: \"Got it!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  if (popupRef) {\r\n    popupRef.close?.();\r\n    popupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet ref: any | undefined;\r\nlet leaveSub: any | undefined;\r\n\r\nfunction closeNote() {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = undefined;\r\n  try { leaveSub?.unsubscribe?.(); } catch {}\r\n  leaveSub = undefined;\r\n}\r\n\r\nfunction openNote() {\r\n  // open popup\r\n  try { ref?.close?.(); } catch {}\r\n  ref = WA.ui.openPopup(\r\n    \"phishing_librarySpawnPopup\",   // anchor ID (adjust in Tiled if needed)\r\n    \" Please proceed and talk to Professor Byte.\",\r\n    [{ label: \"OK\", callback: closeNote }]\r\n  );\r\n\r\n  // close it automatically when leaving the spawn area\r\n  try { leaveSub?.unsubscribe?.(); } catch {}\r\n  leaveSub = WA.room.area.onLeave(\"from-garden\").subscribe(closeNote);\r\n\r\n  // (optional) also auto-close after 5s if player doesn't move/click\r\n  setTimeout(() => { closeNote(); }, 5000);\r\n}\r\n\r\nexport function initPhishingLibrarySpawnNote() {\r\n  WA.onInit().then(() => {\r\n    // show when entering the spawn area (arriving from garden)\r\n    WA.room.area.onEnter(\"from-garden\").subscribe(openNote);\r\n\r\n    // safety: if the player spawns already inside the area, show once\r\n    setTimeout(() => {\r\n      WA.player.getPosition().then(() => openNote());\r\n    }, 250);\r\n  });\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\nlet enterSub: any | undefined;\r\nlet leaveSub: any | undefined;\r\nlet initialized = false;\r\n\r\nconst AREA   = \"billboard\";       // Tiled area name (case-sensitive)\r\nconst ANCHOR = \"billboardPopup\";  // Tiled popup anchor object name\r\n\r\nfunction closePopup() {\r\n  try { popupRef?.close?.(); } catch {}\r\n  popupRef = undefined;\r\n}\r\n\r\nexport function initBillboard() {\r\n  if (initialized) return;        // prevent double-binding\r\n  initialized = true;\r\n\r\n  WA.onInit().then(() => {\r\n    try { enterSub?.unsubscribe?.(); } catch {}\r\n    try { leaveSub?.unsubscribe?.(); } catch {}\r\n\r\n    enterSub = WA.room.area.onEnter(AREA).subscribe(() => {\r\n      console.log(\"[billboard] enter\");\r\n      closePopup();\r\n      popupRef = WA.ui.openPopup(\r\n        ANCHOR,\r\n        \" The community billboard\\n\\n Move towards the ladder on the right and begin your adventure!\",\r\n        [{ label: \"Close\", className: \"primary\", callback: () => closePopup() }]\r\n      );\r\n    });\r\n\r\n    leaveSub = WA.room.area.onLeave(AREA).subscribe(() => {\r\n      console.log(\"[billboard] leave\");\r\n      closePopup();\r\n    });\r\n\r\n    // Safety net: close the popup whenever the map changes or focus is lost\r\n    WA.room.onLeaveLayer?.(\"**\").subscribe?.(() => closePopup());\r\n    window.addEventListener(\"blur\", closePopup);\r\n  });\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet spawnPopupRef: any | undefined;\r\n\r\nexport function initSpawnIntro() {\r\n  WA.onInit().then(() => {\r\n    // small delay avoids races with other initializers\r\n    setTimeout(openSpawnIntro, 50);\r\n  });\r\n}\r\n\r\nfunction openSpawnIntro() {\r\n  closeSpawnIntro(); // prevent duplicates\r\n\r\n  spawnPopupRef = WA.ui.openPopup(\r\n    \"spawnIntroPopup\",\r\n    \" Welcome! Use the Arrow Keys or WASD to move. Explore the map and look for Professor Byte for guidance. Tip: Walk close to objects (signs, boards, NPCs) to interact with them.\",\r\n    [\r\n      {\r\n        label: \"Got it\",\r\n        className: \"primary\",\r\n        callback: (popup) => {\r\n          try { popup.close?.(); } catch {}\r\n          closeSpawnIntro();\r\n        },\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closeSpawnIntro() {\r\n  if (spawnPopupRef) {\r\n    try { spawnPopupRef.close?.(); } catch {}\r\n    spawnPopupRef = undefined;\r\n  }\r\n}\r\n\r\n// make sure there's also a default export so either import style will work:\r\nexport default { initSpawnIntro };\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\nlet enterSub: any | undefined;\r\nlet leaveSub: any | undefined;\r\nlet initialized = false;\r\n\r\nconst AREA   = \"instructions\";       // must match your Tiled area name\r\nconst ANCHOR = \"instructionsPopup\";  // must match your Tiled popup object\r\n\r\nexport function initInstructions() {\r\n  if (initialized) return;           // prevent double-binding if file gets imported twice\r\n  initialized = true;\r\n\r\n  WA.onInit().then(() => {\r\n    // (Re)create clean subscriptions\r\n    try { enterSub?.unsubscribe?.(); } catch {}\r\n    try { leaveSub?.unsubscribe?.(); } catch {}\r\n\r\n    enterSub = WA.room.area.onEnter(AREA).subscribe(() => {\r\n      closePopup(); // just in case\r\n      popupRef = WA.ui.openPopup(\r\n        ANCHOR,\r\n        \" Thank the heavens you're here! Brave student, Murdoch University is under a Cyber Attack! We need your help to protect the school against evildoers who wish us harm. Please proceed through the school and learn about how you can help us!\",\r\n        [\r\n          {\r\n            label: \"Close\",\r\n            className: \"primary\",\r\n            callback: () => closePopup(),\r\n          },\r\n        ]\r\n      );\r\n    });\r\n\r\n    leaveSub = WA.room.area.onLeave(AREA).subscribe(() => {\r\n      // Always close when walking out of the area\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction closePopup() {\r\n  try {\r\n    popupRef?.close?.();\r\n  } catch { /* ignore */ }\r\n  popupRef = undefined;\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nconst POPUP_ANCHOR = \"posterPopup\";\r\nlet ref: any | undefined;\r\n\r\nfunction show(text: string) {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = WA.ui.openPopup(POPUP_ANCHOR, text, []);\r\n}\r\n\r\nfunction hide() {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = undefined;\r\n}\r\n\r\nexport function initPoster() {\r\n  WA.room.area.onEnter(\"poster\").subscribe(() => {\r\n    show(\r\n      \" You notice a faded poster: \\\"Think Before You Click! Your Cyber Kingdom Depends On It.\\\"\\n\\n\" +\r\n      \" You: (to yourself) 'Think before you click.' That's a good motto.\\n\\n\" +\r\n      \" Narrator: Always pause before clicking unknown links. Your vigilance protects your cyber kingdom!\"\r\n    );\r\n  });\r\n  WA.room.area.onLeave(\"poster\").subscribe(hide);\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nconst POPUP_ANCHOR = \"usbdrivePopup\";\r\nlet ref: any | undefined;\r\n\r\nfunction show(text: string) {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = WA.ui.openPopup(POPUP_ANCHOR, text, []);\r\n}\r\nfunction hide() {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = undefined;\r\n}\r\n\r\nexport function initUsbDrive() {\r\n  WA.room.area.onEnter(\"usbdrive\").subscribe(() => {\r\n    show(\r\n      \" You spot a random USB drive on the floor.\\n\\n\" +\r\n      \" You: Should I plug this into a PC and see what's inside?\\n\\n\" +\r\n      \" Narrator: Never plug in unknown USBs. They can hide malware that runs automatically. \" +\r\n      \"If you find one in real life, hand it to IT/Security instead of investigating it yourself.\"\r\n    );\r\n  });\r\n  WA.room.area.onLeave(\"usbdrive\").subscribe(hide);\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nconst POPUP_ANCHOR = \"stickynotePopup\";\r\nlet ref: any | undefined;\r\n\r\nfunction show(text: string) {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = WA.ui.openPopup(POPUP_ANCHOR, text, []);\r\n}\r\nfunction hide() {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = undefined;\r\n}\r\n\r\nexport function initStickyNote() {\r\n  WA.room.area.onEnter(\"stickynote\").subscribe(() => {\r\n    show(\r\n      \" A sticky note is stuck to the monitor: Email PW: P@ssw0rd123.\\n\\n\" +\r\n      \" You: Wah someone actually wrote their password here.\\n\\n\" +\r\n      \" Narrator: Dont write passwords on paper or share them. Use a password manager, \" +\r\n      \"create unique passphrases, and always enable MFA (multi-factor authentication).\"\r\n    );\r\n  });\r\n  WA.room.area.onLeave(\"stickynote\").subscribe(hide);\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nconst POPUP_ANCHOR = \"instructions_safeinternetpracticesPopup\";\r\nlet ref: any | undefined;\r\n\r\nfunction show(text: string) {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = WA.ui.openPopup(POPUP_ANCHOR, text, []);\r\n}\r\nfunction hide() {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = undefined;\r\n}\r\n\r\nexport function initSafeInternetPractices() {\r\n  WA.room.area.onEnter(\"instructions_safeinternetpractices\").subscribe(() => {\r\n    show(\r\n      \" Welcome to the Safe Internet Practices office!\\n\\n\" +\r\n      \" Explore the room and look for hidden clues (poster, USB drive, sticky note).\\n\" +\r\n      \" Read your characters thoughts and the narrators tips.\\n\" +\r\n      \" Learn to: think before you click, protect passwords, and avoid risky devices.\\n\\n\" +\r\n      \"When youre done, proceed to the exit to continue your mission.\"\r\n    );\r\n  });\r\n  WA.room.area.onLeave(\"instructions_safeinternetpractices\").subscribe(hide);\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\ntype Goals = {\r\n  poster: boolean;\r\n  usbdrive: boolean;\r\n  stickynote: boolean;\r\n  AmeliaZone: boolean;\r\n};\r\n\r\nconst goals: Goals = {\r\n  poster: false,\r\n  usbdrive: false,\r\n  stickynote: false,\r\n  AmeliaZone: false,\r\n};\r\n\r\nconst EXIT_AREA_NAME = \"to-hall\";                 // the area in Tiled\r\nconst NEXT_ROOM = \"hall.tmj#from-canteen\";        // adjust filename if needed\r\n\r\nexport function initOfficeProgress() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[OfficeProgress] ready\");\r\n\r\n    // --- Easter Eggs ---\r\n    [\"poster\", \"usbdrive\", \"stickynote\"].forEach((egg) => {\r\n      WA.room.area.onEnter(egg).subscribe(() => {\r\n        console.log(`[OfficeProgress] ENTER ${egg}`);\r\n        if (!goals[egg as keyof Goals]) {\r\n          goals[egg as keyof Goals] = true;\r\n          notifyProgress();\r\n        }\r\n      });\r\n    });\r\n\r\n    // --- NPC ---\r\n    WA.room.area.onEnter(\"AmeliaZone\").subscribe(() => {\r\n      console.log(\"[OfficeProgress] ENTER AmeliaZone\");\r\n      if (!goals.AmeliaZone) {\r\n        goals.AmeliaZone = true;\r\n        notifyProgress();\r\n      }\r\n    });\r\n\r\n    // --- Exit ---\r\n    WA.room.area.onEnter(EXIT_AREA_NAME).subscribe(() => {\r\n      console.log(\"[OfficeProgress] ENTER EXIT, allDone =\", allDone());\r\n      if (allDone()) {\r\n        WA.nav.goToRoom(NEXT_ROOM);\r\n      } else {\r\n        WA.ui.openPopup(\r\n          \"safeinternet_gate_popup\",\r\n          ` Hold up!\\n\\nYou still need to complete:\\n ${missingList().join(\"\\n \")}\\n\\nFind all 3 clues and talk to Amelia before leaving.`,\r\n          [{ label: \"OK\", className: \"primary\", callback: (p) => p.close() }]\r\n        );\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n/* ---------- Helpers ---------- */\r\nfunction allDone(): boolean {\r\n  return goals.poster && goals.usbdrive && goals.stickynote && goals.AmeliaZone;\r\n}\r\n\r\nfunction missingList(): string[] {\r\n  const out: string[] = [];\r\n  if (!goals.poster) out.push(\"Old Security Poster\");\r\n  if (!goals.usbdrive) out.push(\"USB Drive\");\r\n  if (!goals.stickynote) out.push(\"Sticky Note\");\r\n  if (!goals.AmeliaZone) out.push(\"Talk to Amelia (NPC)\");\r\n  return out;\r\n}\r\n\r\nfunction notifyProgress() {\r\n  const status = [\r\n    goals.poster ? \" Poster\" : \" Poster\",\r\n    goals.usbdrive ? \" USB\" : \" USB\",\r\n    goals.stickynote ? \" Sticky\" : \" Sticky Note\",\r\n    goals.AmeliaZone ? \" Amelia\" : \" Amelia\",\r\n  ].join(\"   \");\r\n\r\n  WA.ui.displayActionMessage({\r\n    message: `Progress: ${status}`,\r\n    callback: () => {},\r\n  });\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nexport function initMalwareInstructions() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Malware instructions ready\");\r\n\r\n    // Show popup when entering the instructions area\r\n    WA.room.area.onEnter(\"malware_instructions\").subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    // Close popup when leaving the area\r\n    WA.room.area.onLeave(\"malware_instructions\").subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // Prevent duplicates\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"malware_instructionsPopup\",\r\n    \" Congratulations on clearing the first room! But we have a long way to go before were ready to really protect Murdoch... In this room, youll learn more about Malware and the best ways to protect against it. To begin, go through the slides by pressing SPACE.\",\r\n    [\r\n      {\r\n        label: \"Got it!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  if (popupRef) {\r\n    try {\r\n      popupRef.close?.();\r\n    } catch {}\r\n    popupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nconst AREA   = \"malware_discord\";\r\nconst ANCHOR = \"malware_discordPopup\";\r\n\r\nexport function initMalwareDiscord() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Malware Discord popup ready\");\r\n\r\n    WA.room.area.onEnter(AREA).subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    WA.room.area.onLeave(AREA).subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // prevent duplicates\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    ANCHOR,\r\n    \" Your friend DMs you on Discord about a program that unlocks Discord Nitro Premium for life and says its safe because they used it.\\n\\nWhat would you do? Press SPACE to help!\",\r\n    [\r\n      {\r\n        label: \"Got it!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  try { popupRef?.close?.(); } catch {}\r\n  popupRef = undefined;\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nconst AREA   = \"malware_usbdrive\";\r\nconst ANCHOR = \"malware_usbdrivePopup\";\r\n\r\nexport function initMalwareUsbDrive() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Malware USB Drive popup ready\");\r\n\r\n    WA.room.area.onEnter(AREA).subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    WA.room.area.onLeave(AREA).subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // prevent duplicates\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    ANCHOR,\r\n    \" You spot a USB drive on the canteen floor. You are curious about whats inside. What would you do? Press SPACE to help!\",\r\n    [\r\n      {\r\n        label: \"Got it!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  try { popupRef?.close?.(); } catch {}\r\n  popupRef = undefined;\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nconst AREA   = \"malware_trojan\";\r\nconst ANCHOR = \"malware_trojanPopup\";\r\n\r\nexport function initMalwareTrojan() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Malware Trojan popup ready\");\r\n\r\n    WA.room.area.onEnter(AREA).subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    WA.room.area.onLeave(AREA).subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // prevent duplicates\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    ANCHOR,\r\n    \" A system alert appears: Windows Defender Virus Protection found an unwanted app (type: Trojan). What would you do? Press SPACE to help!\",\r\n    [\r\n      {\r\n        label: \"Got it!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  try { popupRef?.close?.(); } catch {}\r\n  popupRef = undefined;\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nexport function initPasswordSecurityInstructions() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Password Security instructions ready\");\r\n\r\n    // Show popup when entering the instructions area\r\n    WA.room.area.onEnter(\"passwordsecurity_instructions\").subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    // Close popup when leaving the area\r\n    WA.room.area.onLeave(\"passwordsecurity_instructions\").subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // Prevent duplicates / stacking\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"passwordsecurity_instructionsPopup\",\r\n    \" Thank goodness youre here! The hackers are after our passwords, and we need your help to secure them!  To begin, go through the slides to learn more about Passsword Security by pressing SPACE. Afterwards, help us defend the school!\",\r\n    [\r\n      {\r\n        label: \"Got it!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  if (popupRef) {\r\n    try { popupRef.close?.(); } catch {}\r\n    popupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nexport function initPasswordSecurityLMSAccount() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Password Security - LMS Account scenario ready\");\r\n\r\n    // Show popup when entering the area\r\n    WA.room.area.onEnter(\"passwordsecurity_lmsaccount\").subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    // Close popup when leaving the area\r\n    WA.room.area.onLeave(\"passwordsecurity_lmsaccount\").subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // Prevent duplicates\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"passwordsecurity_lmsaccountPopup\",\r\n    \" Your classmate Joyce says she forgot her LMS login and asks to borrow your account to check the quiz questions. What would you do? Press SPACE to help!\",\r\n    [\r\n      {\r\n        label: \"Let's decide!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  if (popupRef) {\r\n    try { popupRef.close?.(); } catch {}\r\n    popupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nexport function initPasswordSecurityLMSPasswordExpired() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Password Security - LMS Password Expired scenario ready\");\r\n\r\n    // Show popup when entering the area\r\n    WA.room.area.onEnter(\"passwordsecurity_lmspasswordexpired\").subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    // Close popup when leaving the area\r\n    WA.room.area.onLeave(\"passwordsecurity_lmspasswordexpired\").subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // Prevent duplicates\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"passwordsecurity_lmspasswordexpiredPopup\",\r\n    \" Your LMS password has just expired! The system is asking you to create a new one. How will you choose your new password? Press SPACE to help!\",\r\n    [\r\n      {\r\n        label: \"Let's find out!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  if (popupRef) {\r\n    try { popupRef.close?.(); } catch {}\r\n    popupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nexport function initPasswordSecurityUnlockedPC() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Password Security - Unlocked PC scenario ready\");\r\n\r\n    // Show popup when entering the area\r\n    WA.room.area.onEnter(\"passwordsecurity_unlockedpc\").subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    // Close popup when leaving the area\r\n    WA.room.area.onLeave(\"passwordsecurity_unlockedpc\").subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // Prevent duplicates\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"passwordsecurity_unlockedpcPopup\",\r\n    \" You notice an unlocked PC with a teachers account signed in  an Excel sheet is open showing login details! What should you do? Press SPACE to help!\",\r\n    [\r\n      {\r\n        label: \"I'll check!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  if (popupRef) {\r\n    try { popupRef.close?.(); } catch {}\r\n    popupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\n/** Area: safeinternetpractices_freewifi\r\n *  Anchor/Popup ID: safeinternetpractices_freewifiPopup\r\n */\r\nexport function initSafeInternetPracticesFreeWifi() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Safe Internet Practices  Free Wi-Fi ready\");\r\n\r\n    WA.room.area.onEnter(\"safeinternetpractices_freewifi\").subscribe(() => openPopup());\r\n    WA.room.area.onLeave(\"safeinternetpractices_freewifi\").subscribe(() => closePopup());\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // prevent stacking\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"safeinternetpractices_freewifiPopup\",\r\n    \" In the hall, you spot a wall sign offering **Free Wi-Fi**. Nearby, you see open networks like HallGuest and CampusFree. How would you get online safely? Press SPACE to help!\",\r\n    [\r\n      { label: \"Got it\", className: \"primary\", callback: () => closePopup() }\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  try { popupRef?.close?.(); } catch {}\r\n  popupRef = undefined;\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\n/** Area: safeinternetpractices_fileuploads\r\n *  Anchor/Popup ID: safeinternetpractices_fileuploadsPopup\r\n */\r\nexport function initSafeInternetPracticesFileUploads() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Safe Internet Practices  File Uploads ready\");\r\n\r\n    // Show popup when entering the area\r\n    WA.room.area.onEnter(\"safeinternetpractices_fileuploads\").subscribe(() => openPopup());\r\n    WA.room.area.onLeave(\"safeinternetpractices_fileuploads\").subscribe(() => closePopup());\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // prevent duplicate popups\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"safeinternetpractices_fileuploadsPopup\",\r\n    \" Hey! Can you help me edit this PDF file? I found some free online tools that lets you upload and edit PDFs easily! What would you do? Press SPACE to help!\",\r\n    [\r\n      {\r\n        label: \"Lets see!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  try { popupRef?.close?.(); } catch {}\r\n  popupRef = undefined;\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\n/** Area: safeinternetpractices_outdatedsoftware\r\n *  Anchor/Popup ID: safeinternetpractices_outdatedsoftwarePopup\r\n */\r\nexport function initSafeInternetPracticesOutdatedSoftware() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Safe Internet Practices  Outdated Software ready\");\r\n\r\n    // Show popup when entering the area\r\n    WA.room.area.onEnter(\"safeinternetpractices_outdatedsoftware\").subscribe(() => openPopup());\r\n    WA.room.area.onLeave(\"safeinternetpractices_outdatedsoftware\").subscribe(() => closePopup());\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // Prevent duplicate popups\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"safeinternetpractices_outdatedsoftwarePopup\",\r\n    \" You saw a laptop on the floor, you picked it up and open your browser to check your bank account, but a message appears saying your browser needs an update. What will you do? Press SPACE to help!\",\r\n    [\r\n      {\r\n        label: \"Lets decide!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  try { popupRef?.close?.(); } catch {}\r\n  popupRef = undefined;\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nexport function initSafeInternetPracticesInstructions() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Safe Internet Practices instructions ready\");\r\n\r\n    WA.room.area.onEnter(\"safeinternetpractices_instructions\").subscribe(() => openPopup());\r\n    WA.room.area.onLeave(\"safeinternetpractices_instructions\").subscribe(() => closePopup());\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  closePopup();\r\n  popupRef = WA.ui.openPopup(\r\n    \"safeinternetpractices_instructionsPopup\",\r\n    \" Youve made it through 3 of the topics, well done! But theres more we need to learn before were truly ready to defeat the malicious actors. Please press SPACE to talk to me before you explore the room!\",\r\n    [{ label: \"Got it!\", className: \"primary\", callback: () => closePopup() }]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  try { popupRef?.close?.(); } catch {}\r\n  popupRef = undefined;\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nexport function initIDTheftInstructions() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] ID Theft instructions ready\");\r\n\r\n    // Show popup when entering the instructions area\r\n    WA.room.area.onEnter(\"idtheft_instructions\").subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    // Close popup when leaving the area\r\n    WA.room.area.onLeave(\"idtheft_instructions\").subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // Prevent duplicate popups\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"idtheft_instructionsPopup\",\r\n    \" Its hard to believe it but we seem to be in the last topic! Were almost ready to face the hackers and help defend the school! One of the students recently fell victim to ID Theft via a phishing email, and theyre now being impersonated online! Press SPACE to read the slides on the basics you need to learn first. Afterwards, please check the PC nearby to see if you can help.\",\r\n    [\r\n      {\r\n        label: \"Got it!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  if (popupRef) {\r\n    try { popupRef.close?.(); } catch {}\r\n    popupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nexport function initIDTheftSensitivePapers() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] ID Theft - Sensitive Papers ready\");\r\n\r\n    // Show popup when entering the area\r\n    WA.room.area.onEnter(\"idtheft_sensitivepapers\").subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    // Close popup when leaving the area\r\n    WA.room.area.onLeave(\"idtheft_sensitivepapers\").subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // Prevent duplicate popups\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"idtheft_sensitivepapersPopup\",\r\n    \" While cleaning out some old documents from your locker, you notice a pile of old bank statements. They might contain sensitive information  how you handle them could determine whether your data stays safe! Press SPACE to investigate what happens next.\",\r\n    [\r\n      {\r\n        label: \"Got it!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  if (popupRef) {\r\n    try { popupRef.close?.(); } catch {}\r\n    popupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nexport function initIDTheftCustomerServiceCall() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] ID Theft - Customer Service Call ready\");\r\n\r\n    // Show popup when entering the area\r\n    WA.room.area.onEnter(\"idtheft_customerservicecall\").subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    // Close popup when leaving the area\r\n    WA.room.area.onLeave(\"idtheft_customerservicecall\").subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // Prevent duplicate popups\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"idtheft_customerservicecallPopup\",\r\n    \" You notice a phone lying on the floor and decide to pick it up. As soon as you do, you receive a call  the person on the other end claims to be a bank representative who somehow knows your name and partial account number. Press SPACE to find out what happens next!\",\r\n    [\r\n      {\r\n        label: \"Got it!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  if (popupRef) {\r\n    try { popupRef.close?.(); } catch {}\r\n    popupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nexport function initIDTheftCelebration() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] ID Theft - Celebration ready\");\r\n\r\n    // Show popup when entering the area\r\n    WA.room.area.onEnter(\"idtheft_celebration\").subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    // Close popup when leaving the area\r\n    WA.room.area.onLeave(\"idtheft_celebration\").subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // Prevent duplicate popups\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"idtheft_celebrationPopup\",\r\n    \" Youve just passed your driving test and gotten your new license! Excited, you picked up your phone from the bench and took a selfie with it in hand to celebrate your big achievement. But should you post it online? Press SPACE to see what happens next!\",\r\n    [\r\n      {\r\n        label: \"Got it!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  if (popupRef) {\r\n    try { popupRef.close?.(); } catch {}\r\n    popupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet ref: any | undefined;\r\nlet leaveSub: any | undefined;\r\nlet shownOnce = false; // show only once per visit\r\n\r\nconst AREA = \"from-computerlab\";        //  the AREA in Tiled\r\nconst ANCHOR = \"finalboss_spawnPopup\";  //  the POPUP anchor rectangle\r\n\r\nfunction closeNote() {\r\n  try { ref?.close?.(); } catch {}\r\n  ref = undefined;\r\n  try { leaveSub?.unsubscribe?.(); } catch {}\r\n  leaveSub = undefined;\r\n}\r\n\r\nfunction openNote() {\r\n  if (shownOnce) return;\r\n  shownOnce = true;\r\n\r\n  try { ref?.close?.(); } catch {}\r\n  ref = WA.ui.openPopup(\r\n    ANCHOR,\r\n    \" Youve entered the main office it feels quiet, too quiet. Somethings off  the source of all the attacks must be here. Move forward carefully.\",\r\n    [{ label: \"Got it!\", className: \"primary\", callback: closeNote }]\r\n  );\r\n\r\n  try { leaveSub?.unsubscribe?.(); } catch {}\r\n  leaveSub = WA.room.area.onLeave(AREA).subscribe(closeNote);\r\n\r\n  // Optional auto-close after a few seconds\r\n  setTimeout(() => closeNote(), 6000);\r\n}\r\n\r\nexport function initFinalBossSpawn() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Final Boss spawn ready\");\r\n\r\n    // show when entering the spawn area\r\n    WA.room.area.onEnter(AREA).subscribe(openNote);\r\n\r\n    // safety: if player loads already inside the area, show once\r\n    setTimeout(() => {\r\n      WA.player.getPosition().then(() => openNote());\r\n    }, 250);\r\n  });\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nexport function initFinalBossCipherX() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Final Boss CipherX ready\");\r\n\r\n    // Show popup when entering the area\r\n    WA.room.area.onEnter(\"finalboss_cipherx\").subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    // Close popup when leaving the area\r\n    WA.room.area.onLeave(\"finalboss_cipherx\").subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // Prevent duplicates\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"finalboss_cipherxPopup\",\r\n    \" So... youve made it through every challenge  phishing, malware, weak passwords, stolen identities. Youve been a thorn in my plans for far too long! Press SPACE to face CipherX in the final showdown quiz!\",\r\n    [\r\n      {\r\n        label: \"Im ready!\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  if (popupRef) {\r\n    try { popupRef.close?.(); } catch {}\r\n    popupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet endPopupRef: any | undefined;\r\n\r\nexport function initEndingMessage() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Ending message ready\");\r\n\r\n    WA.room.area.onEnter(\"endingmessage\").subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    WA.room.area.onLeave(\"endingmessage\").subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  closePopup();\r\n\r\n  endPopupRef = WA.ui.openPopup(\r\n    \"endingmessagePopup\",\r\n    \" Congratulations, Cyber Ranger! Youve defeated CipherX and restored peace to Murdoch University. Thanks to your actions, students can now browse, click, and share safely once again. Please move to the right towards the stairs and complete the survey. \",\r\n    [{ label: \"Finish!\", className: \"primary\", callback: () => closePopup() }]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  if (endPopupRef) {\r\n    try { endPopupRef.close?.(); } catch {}\r\n    endPopupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\r\n\r\nlet popupRef: any | undefined;\r\n\r\nexport function initSurvey() {\r\n  WA.onInit().then(() => {\r\n    console.log(\"[WA] Survey area ready\");\r\n\r\n    // Show popup when entering the area\r\n    WA.room.area.onEnter(\"survey\").subscribe(() => {\r\n      openPopup();\r\n    });\r\n\r\n    // Close popup when leaving the area\r\n    WA.room.area.onLeave(\"survey\").subscribe(() => {\r\n      closePopup();\r\n    });\r\n  });\r\n}\r\n\r\nfunction openPopup() {\r\n  // Prevent duplicates\r\n  closePopup();\r\n\r\n  popupRef = WA.ui.openPopup(\r\n    \"surveyPopup\",\r\n    \" Final Step: Please proceed to complete the post-game survey to help us improve Cyber Rangers! Press SPACE to begin.\",\r\n    [\r\n      {\r\n        label: \"Open Survey\",\r\n        className: \"primary\",\r\n        callback: () => closePopup(),\r\n      },\r\n    ]\r\n  );\r\n}\r\n\r\nfunction closePopup() {\r\n  if (popupRef) {\r\n    try { popupRef.close?.(); } catch {}\r\n    popupRef = undefined;\r\n  }\r\n}\r\n","/// <reference types=\"@workadventure/iframe-api-typings\" />\nimport { bootstrapExtra } from \"@workadventure/scripting-api-extra\";\n\n// Always-on (safe anywhere)\nimport { initClock } from \"./clock\";\nimport { initBoard } from \"./board\";\nimport { initMarvie } from \"./marvie\";\n\n// Progress system (auto by mapId; handles gate + toasts)\nimport { initProgressChecker } from \"./progresschecker\";\n\n// phishing - library room\nimport { initphishing_QRcode } from \"./phishing_qrcode\";\nimport { initphishing_MurdochEmail } from \"./phishing_murdochemail\";\nimport { initphishing_SMSphishing } from \"./phishing_smsphishing\";\nimport { initPhishingInstructions } from \"./phishing_instructions\";\nimport { initPhishingLibrarySpawnNote } from \"./phishing_librarySpawnNote\";\n\n// garden / common features\nimport { initBillboard } from \"./billboard\";\nimport { initSpawnIntro } from \"./spawnIntro\";\nimport { initInstructions } from \"./instructions\";\nimport { initPoster } from \"./poster\";\nimport { initUsbDrive } from \"./usbdrive\";\nimport { initStickyNote } from \"./stickynote\";\nimport { initSafeInternetPractices } from \"./instructions_safeinternetpractices\";\nimport { initOfficeProgress } from \"./officeprogress\"; // keep only if you still use it\n\n// canteen - malware room\nimport { initMalwareInstructions } from \"./malware_instructions\";\nimport { initMalwareDiscord } from \"./malware_discord\";\nimport { initMalwareUsbDrive } from \"./malware_usbdrive\";\nimport { initMalwareTrojan } from \"./malware_trojan\";\n\n// classroom - password security room\nimport { initPasswordSecurityInstructions } from \"./passwordsecurity_instructions\";\nimport { initPasswordSecurityLMSAccount } from \"./passwordsecurity_lmsaccount\";\nimport { initPasswordSecurityLMSPasswordExpired } from \"./passwordsecurity_lmspasswordexpired\";\nimport { initPasswordSecurityUnlockedPC } from \"./passwordsecurity_unlockedpc\";\n\n// hall - safe internet practices (hub)\nimport { initSafeInternetPracticesFreeWifi } from \"./safeinternetpractices_freewifi\";\nimport { initSafeInternetPracticesFileUploads } from \"./safeinternetpractices_fileuploads\";\nimport { initSafeInternetPracticesOutdatedSoftware } from \"./safeinternetpractices_outdatedsoftware\";\nimport { initSafeInternetPracticesInstructions } from \"./safeinternetpractices_instructions\";\n\n// computerlab - ID theft room\nimport { initIDTheftInstructions } from \"./idtheft_instructions\";\nimport { initIDTheftSensitivePapers } from \"./idtheft_sensitivepapers\";\nimport { initIDTheftCustomerServiceCall } from \"./idtheft_customerservicecall\";\nimport { initIDTheftCelebration } from \"./idtheft_celebration\";\n\n// office - final room (FINAL BOSS + SURVEY)   NEW\nimport { initFinalBossSpawn } from \"./finalboss_spawn\";\nimport { initFinalBossCipherX } from \"./finalboss_cipherx\";\nimport { initEndingMessage } from \"./endingmessage\";\nimport { initSurvey } from \"./survey\";\n\nconsole.log(\"Script started\");\n\nWA.onInit().then(async () => {\n  console.log(\"Scripting API ready\");\n  await bootstrapExtra();\n\n  // ------------------------------------------\n  // Always-on (safe anywhere)\n  // ------------------------------------------\n  initClock();\n  initBoard();\n  initMarvie();\n\n  //  Progress checker (auto-guards by mapId; handles gate + toasts)\n  initProgressChecker();\n\n  // ------------------------------------------\n  // Map detection (robust)\n  // ------------------------------------------\n  const mapId = await detectMapId();\n  console.log(\"[Router] mapId =\", mapId || \"(unknown)\");\n\n  if (mapId === \"garden\") {\n    console.log(\"[Router] Initializing GARDEN features\");\n    initBillboard();\n    initSpawnIntro();\n    initInstructions();\n    initPoster();\n    initUsbDrive();\n    initStickyNote();\n    initSafeInternetPractices();\n    initOfficeProgress(); // keep here only if garden has the required objects\n  } else if (mapId === \"library\") {\n    console.log(\"[Router] Initializing LIBRARY (Phishing) features\");\n    initphishing_QRcode();\n    initphishing_MurdochEmail();\n    initphishing_SMSphishing();\n    initPhishingInstructions();\n    initPhishingLibrarySpawnNote();\n  } else if (mapId === \"canteen\") {\n    console.log(\"[Router] Initializing CANTEEN (Malware) features\");\n    initMalwareInstructions();\n    initMalwareDiscord();\n    initMalwareUsbDrive();\n    initMalwareTrojan();\n  } else if (mapId === \"classroom\") {\n    console.log(\"[Router] Initializing CLASSROOM (Password Security) features\");\n    initPasswordSecurityInstructions();\n    initPasswordSecurityLMSAccount();\n    initPasswordSecurityLMSPasswordExpired();\n    initPasswordSecurityUnlockedPC();\n  } else if (mapId === \"computerlab\") {\n    console.log(\"[Router] Initializing COMPUTER LAB (ID Theft) features\");\n    initIDTheftInstructions();          // slides intro\n    initIDTheftSensitivePapers();       // scenario 1\n    initIDTheftCustomerServiceCall();   // scenario 2\n    initIDTheftCelebration();           // scenario 3\n  } else if (mapId === \"hall\") {\n    console.log(\"[Router] Initializing HALL (Safe Internet Practices) features\");\n    initSafeInternetPracticesFreeWifi();\n    initSafeInternetPracticesFileUploads();\n    initSafeInternetPracticesOutdatedSoftware();\n    initSafeInternetPracticesInstructions();\n  } else if (mapId === \"office\") {\n    console.log(\"[Router] Initializing OFFICE (Final Boss) features\");\n    initFinalBossSpawn();       // entry flavor text\n    initFinalBossCipherX();     // boss popup  SPACE to quiz (Twine)\n    initEndingMessage();        // post-quiz congrats\n    initSurvey();               // stairs area  survey popup\n  } else {\n    console.warn(\n      \"[Router] Unknown map; only common features started. \" +\n        \"Set a Tiled Map Property `mapId` (string) to enable map-specific inits.\"\n    );\n  }\n});\n\n/**\n * Return the current map id as a lowercase string.\n */\nasync function detectMapId(): Promise<string> {\n  try {\n    const full = decodeURIComponent(window.location.href);\n    const m = full.match(/\\/([^\\/?#]+)\\.tmj/i);\n    if (m?.[1]) return m[1].toLowerCase();\n  } catch {}\n\n  try {\n    const tiled: any = await WA.room.getTiledMap?.();\n    const raw = (tiled?.url ?? tiled?.name ?? \"\").toString();\n    if (raw) {\n      const base = (raw.split(\"/\").pop() || raw).toLowerCase();\n      if (base.endsWith(\".tmj\")) return base.replace(/\\.tmj$/, \"\");\n      return base;\n    }\n    const props = tiled?.properties as Array<{ name: string; value: any }> | undefined;\n    const fromProp = props?.find((p) => p?.name === \"mapId\")?.value;\n    if (typeof fromProp === \"string\" && fromProp.trim()) {\n      return fromProp.trim().toLowerCase();\n    }\n  } catch {}\n\n  return \"\";\n}\nWA.onInit().then(() => {\n  // Turn off the users devices and prevent meetings altogether\n  WA.controls.turnOffWebcam();\n  WA.controls.turnOffMicrophone();\n  WA.controls.disableWebcam();\n  WA.controls.disableMicrophone();\n  WA.controls.disablePlayerProximityMeeting();\n});\n"],"names":["Properties","properties","name","values","property","type","value","types","defaultAssetsUrl","VariableDescriptor","object","readableBy","writableBy","openConfig","variables","parameters","getVariables","layerFilter","variablesFilter","map","getAllVariablesRecursive","layers","layer","layersMapPromise","getLayersMap","getLayersMapWithoutCache","flattenGroupLayersMap","flatLayers","flattenGroupLayers","prefix","getAreaObject","areaArray","findLayerBoundaries","left","top","bottom","right","data","j","findLayersBoundaries","boundaries","objectToString","isArray","isFunction","typeStr","obj","escapeRegExp","string","hasProperty","propName","primitiveHasOwnProperty","primitive","regExpTest","testRegExp","re","nonSpaceRe","isWhitespace","entityMap","escapeHtml","s","whiteRe","spaceRe","equalsRe","curlyRe","tagRe","parseTemplate","template","tags","lineHasNonSpace","sections","tokens","spaces","hasTag","nonSpace","indentation","tagIndex","stripSpace","openingTagRe","closingTagRe","closingCurlyRe","compileTags","tagsToCompile","mustache","scanner","Scanner","start","chr","token","openSection","i","valueLength","nestTokens","squashTokens","squashedTokens","lastToken","numTokens","nestedTokens","collector","section","match","index","Context","view","parentContext","cache","context","intermediateValue","names","lookupHit","Writer","key","cacheKey","isCacheEnabled","partials","config","originalTemplate","buffer","symbol","self","subRender","partial","filteredIndentation","partialByNl","indentedValue","escape","defaultWriter","TemplateValue","state","Mustache","callback","subscriptions","variableName","newValue","subscription","ast","subAst","initPropertiesTemplatesArea","_a","areas","area","setPropertyArea","initPropertiesTemplates","layerName","setProperty","areaName","propertyName","workadventureAssetsHtmlUrl","layersMap","playerX","playerY","updateDoorLayers","variable","playOpenSound","url","radius","volume","distance","getDistance","playCloseSound","getTileLayers","layerNames","xLayer","yLayer","initDoor","initDoorstep","doorstepZone","doorVariable","assetsUrl","actionMessage","keypadWebsite","inZone","tag","allowed","accessRestricted","displayCloseDoorMessage","displayOpenDoorMessage","openKeypad","closeKeypad","onEnter","onLeave","playBellSound","initBell","initBellLayer","bellVariable","bellZone","popup","bellPopupName","objectName","initDoors","doorVariableName","moveEvent","initVariableActionLayer","enterValue","leaveValue","triggerMessage","setupVariableActionLayer","actionMessagePopup","e","initSpecialProperties","initConfiguration","configurationLayer","openConfigVariables","initLocalConfigurationPanel","allowedByTag","displayConfigurationMessage","closeConfigurationPanel","openConfigTriggerValue","bootstrapExtra","currentPopup","initClock","now","hh","mm","boardPopupRef","initBoard","close","text","marviePopupRef","closeMarviePopup","getMessageForZone","_b","props","p","x","initMarvie","message","PHISHING_PROGRESS","MALWARE_PROGRESS","PASSWORDSECURITY_PROGRESS","IDTHEFT_PROGRESS","SAFEINTERNETPRACTICES_PROGRESS","FINALBOSS_PROGRESS","MAP_CONFIG","STORAGE_PREFIX","storageKey","mapId","saveGoals","goals","loadGoals","raw","clearOtherMaps","currentMapId","toDelete","k","currentTasks","toastCooldown","gatePopupRef","gateCooldown","exiting","initializedForMap","initProgressChecker","getMapId","cfg","hardCloseAllUi","restored","t","showProgress","allDone","nextRoom","warnAnchorId","missing","missingList","closeGatePopup","line","_c","m","tiled","fromProp","previewRef","AREA","ANCHOR","initphishing_QRcode","closePopup","initphishing_MurdochEmail","initphishing_SMSphishing","popupRef","initPhishingInstructions","openPopup","ref","leaveSub","closeNote","openNote","initPhishingLibrarySpawnNote","enterSub","initialized","initBillboard","_d","_e","_f","spawnPopupRef","initSpawnIntro","openSpawnIntro","closeSpawnIntro","initInstructions","POPUP_ANCHOR","show","hide","initPoster","initUsbDrive","initStickyNote","initSafeInternetPractices","EXIT_AREA_NAME","NEXT_ROOM","initOfficeProgress","egg","notifyProgress","out","status","initMalwareInstructions","initMalwareDiscord","initMalwareUsbDrive","initMalwareTrojan","initPasswordSecurityInstructions","initPasswordSecurityLMSAccount","initPasswordSecurityLMSPasswordExpired","initPasswordSecurityUnlockedPC","initSafeInternetPracticesFreeWifi","initSafeInternetPracticesFileUploads","initSafeInternetPracticesOutdatedSoftware","initSafeInternetPracticesInstructions","initIDTheftInstructions","initIDTheftSensitivePapers","initIDTheftCustomerServiceCall","initIDTheftCelebration","shownOnce","initFinalBossSpawn","initFinalBossCipherX","endPopupRef","initEndingMessage","initSurvey","detectMapId","base"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]}