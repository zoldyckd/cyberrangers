class C{constructor(e){this.properties=e??[]}get(e){const n=this.properties.filter(o=>o.name===e).map(o=>o.value);if(n.length>1)throw new Error('Expected only one property to be named "'+e+'"');if(n.length!==0)return n[0]}getString(e){return this.getByType(e,"string")}getNumber(e){return this.getByType(e,"number")}getBoolean(e){return this.getByType(e,"boolean")}getByType(e,n){const o=this.get(e);if(o!==void 0){if(n!=="json"&&typeof o!==n)throw new Error('Expected property "'+e+'" to have type "'+n+'"');return o}}mustGetString(e){return this.mustGetByType(e,"string")}mustGetNumber(e){return this.mustGetByType(e,"number")}mustGetBoolean(e){return this.mustGetByType(e,"boolean")}mustGetByType(e,n){const o=this.get(e);if(o===void 0)throw new Error('Property "'+e+'" is missing');if(n!=="json"&&typeof o!==n)throw new Error('Expected property "'+e+'" to have type "'+n+'"');return o}getType(e){const n=this.properties.filter(o=>o.name===e).map(o=>o.type);if(n.length>1)throw new Error('Expected only one property to be named "'+e+'"');if(n.length!==0)return n[0]}}const ge="https://unpkg.com/@workadventure/scripting-api-extra@1.9.10/dist";class Ce{constructor(e){this.name=e.name,this.x=e.x,this.y=e.y,this.properties=new C(e.properties)}get isReadable(){const e=this.properties.getString("readableBy");return e?WA.player.tags.includes(e):!0}get isWritable(){const e=this.properties.getString("writableBy");return e?WA.player.tags.includes(e):!0}}function re(t){const e=t?"#"+t.join():"";WA.nav.openCoWebSite(ge+"/configuration.html"+e,!0)}async function Me(t,e){const n=await WA.room.getTiledMap(),o=new Map;return ye(n.layers,o,t,e),o}function ye(t,e,n,o){for(const r of t)if(r.type==="objectgroup"){for(const a of r.objects)if(a.type==="variable"||a.class==="variable"){if(n&&r.name!==n||o&&!o.includes(a.name))continue;e.set(a.name,new Ce(a))}}else r.type==="group"&&ye(r.layers,e,n,o)}let z;async function I(){return z===void 0&&(z=Le()),z}async function Le(){return Re(await WA.room.getTiledMap())}function Re(t){const e=new Map;return be(t.layers,"",e),e}function be(t,e,n){for(const o of t)o.type==="group"?be(o.layers,e+o.name+"/",n):(o.name=e+o.name,n.set(o.name,o))}async function me(){const t=await I(),e=[];for(const n of t.values())if(n.type==="objectgroup")for(const o of n.objects)(o.type==="area"||o.class==="area")&&e.push(o);return e}function Te(t){let e=1/0,n=1/0,o=0,r=0;const a=t.data;if(typeof a=="string")throw new Error("Unsupported tile layer data stored as string instead of CSV");for(let s=0;s<t.height;s++)for(let i=0;i<t.width;i++)a[i+s*t.width]!==0&&(e=Math.min(e,i),r=Math.max(r,i),n=Math.min(n,s),o=Math.max(o,s));return{top:n,left:e,right:r+1,bottom:o+1}}function ve(t){let e=1/0,n=1/0,o=0,r=0;for(const a of t){const s=Te(a);s.left<e&&(e=s.left),s.top<n&&(n=s.top),s.right>r&&(r=s.right),s.bottom>o&&(o=s.bottom)}return{top:n,left:e,right:r,bottom:o}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var Be=Object.prototype.toString,L=Array.isArray||function(e){return Be.call(e)==="[object Array]"};function ee(t){return typeof t=="function"}function xe(t){return L(t)?"array":typeof t}function X(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function ae(t,e){return t!=null&&typeof t=="object"&&e in t}function Ie(t,e){return t!=null&&typeof t!="object"&&t.hasOwnProperty&&t.hasOwnProperty(e)}var je=RegExp.prototype.test;function Ne(t,e){return je.call(t,e)}var Oe=/\S/;function Qe(t){return!Ne(Oe,t)}var Ve={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function Ge(t){return String(t).replace(/[&<>"'`=\/]/g,function(n){return Ve[n]})}var Ue=/\s*/,De=/\s+/,se=/\s*=/,_e=/\s*\}/,Ke=/#|\^|\/|>|\{|&|=|!/;function He(t,e){if(!t)return[];var n=!1,o=[],r=[],a=[],s=!1,i=!1,c="",u=0;function f(){if(s&&!i)for(;a.length;)delete r[a.pop()];else a=[];s=!1,i=!1}var g,m,O;function R(W){if(typeof W=="string"&&(W=W.split(De,2)),!L(W)||W.length!==2)throw new Error("Invalid tags: "+W);g=new RegExp(X(W[0])+"\\s*"),m=new RegExp("\\s*"+X(W[1])),O=new RegExp("\\s*"+X("}"+W[1]))}R(e||d.tags);for(var p=new j(t),v,l,y,T,Q,k;!p.eos();){if(v=p.pos,y=p.scanUntil(g),y)for(var Y=0,Ee=y.length;Y<Ee;++Y)T=y.charAt(Y),Qe(T)?(a.push(r.length),c+=T):(i=!0,n=!0,c+=" "),r.push(["text",T,v,v+1]),v+=1,T===`
`&&(f(),c="",u=0,n=!1);if(!p.scan(g))break;if(s=!0,l=p.scan(Ke)||"name",p.scan(Ue),l==="="?(y=p.scanUntil(se),p.scan(se),p.scanUntil(m)):l==="{"?(y=p.scanUntil(O),p.scan(_e),p.scanUntil(m),l="&"):y=p.scanUntil(m),!p.scan(m))throw new Error("Unclosed tag at "+p.pos);if(l==">"?Q=[l,y,v,p.pos,c,u,n]:Q=[l,y,v,p.pos],u++,r.push(Q),l==="#"||l==="^")o.push(Q);else if(l==="/"){if(k=o.pop(),!k)throw new Error('Unopened section "'+y+'" at '+v);if(k[1]!==y)throw new Error('Unclosed section "'+k[1]+'" at '+v)}else l==="name"||l==="{"||l==="&"?i=!0:l==="="&&R(y)}if(f(),k=o.pop(),k)throw new Error('Unclosed section "'+k[1]+'" at '+p.pos);return Fe(qe(r))}function qe(t){for(var e=[],n,o,r=0,a=t.length;r<a;++r)n=t[r],n&&(n[0]==="text"&&o&&o[0]==="text"?(o[1]+=n[1],o[3]=n[3]):(e.push(n),o=n));return e}function Fe(t){for(var e=[],n=e,o=[],r,a,s=0,i=t.length;s<i;++s)switch(r=t[s],r[0]){case"#":case"^":n.push(r),o.push(r),n=r[4]=[];break;case"/":a=o.pop(),a[5]=r[2],n=o.length>0?o[o.length-1][4]:e;break;default:n.push(r)}return e}function j(t){this.string=t,this.tail=t,this.pos=0}j.prototype.eos=function(){return this.tail===""};j.prototype.scan=function(e){var n=this.tail.match(e);if(!n||n.index!==0)return"";var o=n[0];return this.tail=this.tail.substring(o.length),this.pos+=o.length,o};j.prototype.scanUntil=function(e){var n=this.tail.search(e),o;switch(n){case-1:o=this.tail,this.tail="";break;case 0:o="";break;default:o=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=o.length,o};function M(t,e){this.view=t,this.cache={".":this.view},this.parent=e}M.prototype.push=function(e){return new M(e,this)};M.prototype.lookup=function(e){var n=this.cache,o;if(n.hasOwnProperty(e))o=n[e];else{for(var r=this,a,s,i,c=!1;r;){if(e.indexOf(".")>0)for(a=r.view,s=e.split("."),i=0;a!=null&&i<s.length;)i===s.length-1&&(c=ae(a,s[i])||Ie(a,s[i])),a=a[s[i++]];else a=r.view[e],c=ae(r.view,e);if(c){o=a;break}r=r.parent}n[e]=o}return ee(o)&&(o=o.call(this.view)),o};function h(){this.templateCache={_cache:{},set:function(e,n){this._cache[e]=n},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}h.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};h.prototype.parse=function(e,n){var o=this.templateCache,r=e+":"+(n||d.tags).join(":"),a=typeof o<"u",s=a?o.get(r):void 0;return s==null&&(s=He(e,n),a&&o.set(r,s)),s};h.prototype.render=function(e,n,o,r){var a=this.getConfigTags(r),s=this.parse(e,a),i=n instanceof M?n:new M(n,void 0);return this.renderTokens(s,i,o,e,r)};h.prototype.renderTokens=function(e,n,o,r,a){for(var s="",i,c,u,f=0,g=e.length;f<g;++f)u=void 0,i=e[f],c=i[0],c==="#"?u=this.renderSection(i,n,o,r,a):c==="^"?u=this.renderInverted(i,n,o,r,a):c===">"?u=this.renderPartial(i,n,o,a):c==="&"?u=this.unescapedValue(i,n):c==="name"?u=this.escapedValue(i,n,a):c==="text"&&(u=this.rawValue(i)),u!==void 0&&(s+=u);return s};h.prototype.renderSection=function(e,n,o,r,a){var s=this,i="",c=n.lookup(e[1]);function u(m){return s.render(m,n,o,a)}if(c){if(L(c))for(var f=0,g=c.length;f<g;++f)i+=this.renderTokens(e[4],n.push(c[f]),o,r,a);else if(typeof c=="object"||typeof c=="string"||typeof c=="number")i+=this.renderTokens(e[4],n.push(c),o,r,a);else if(ee(c)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");c=c.call(n.view,r.slice(e[3],e[5]),u),c!=null&&(i+=c)}else i+=this.renderTokens(e[4],n,o,r,a);return i}};h.prototype.renderInverted=function(e,n,o,r,a){var s=n.lookup(e[1]);if(!s||L(s)&&s.length===0)return this.renderTokens(e[4],n,o,r,a)};h.prototype.indentPartial=function(e,n,o){for(var r=n.replace(/[^ \t]/g,""),a=e.split(`
`),s=0;s<a.length;s++)a[s].length&&(s>0||!o)&&(a[s]=r+a[s]);return a.join(`
`)};h.prototype.renderPartial=function(e,n,o,r){if(o){var a=this.getConfigTags(r),s=ee(o)?o(e[1]):o[e[1]];if(s!=null){var i=e[6],c=e[5],u=e[4],f=s;c==0&&u&&(f=this.indentPartial(s,u,i));var g=this.parse(f,a);return this.renderTokens(g,n,o,f,r)}}};h.prototype.unescapedValue=function(e,n){var o=n.lookup(e[1]);if(o!=null)return o};h.prototype.escapedValue=function(e,n,o){var r=this.getConfigEscape(o)||d.escape,a=n.lookup(e[1]);if(a!=null)return typeof a=="number"&&r===d.escape?String(a):r(a)};h.prototype.rawValue=function(e){return e[1]};h.prototype.getConfigTags=function(e){return L(e)?e:e&&typeof e=="object"?e.tags:void 0};h.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!L(e))return e.escape};var d={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(t){x.templateCache=t},get templateCache(){return x.templateCache}},x=new h;d.clearCache=function(){return x.clearCache()};d.parse=function(e,n){return x.parse(e,n)};d.render=function(e,n,o,r){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+xe(e)+'" was given as the first argument for mustache#render(template, view, partials)');return x.render(e,n,o,r)};d.escape=Ge;d.Scanner=j;d.Context=M;d.Writer=h;class Ae{constructor(e,n){this.template=e,this.state=n,this.ast=d.parse(e)}getValue(){return this.value===void 0&&(this.value=d.render(this.template,this.state)),this.value}onChange(e){const n=[];for(const o of this.getUsedVariables().values())n.push(this.state.onVariableChange(o).subscribe(()=>{const r=d.render(this.template,this.state);r!==this.value&&(this.value=r,e(this.value))}));return{unsubscribe:()=>{for(const o of n)o.unsubscribe()}}}isPureString(){return this.ast.length===0||this.ast.length===1&&this.ast[0][0]==="text"}getUsedVariables(){const e=new Set;return this.recursiveGetUsedVariables(this.ast,e),e}recursiveGetUsedVariables(e,n){for(const o of e){const r=o[0],a=o[1],s=o[4];["name","&","#","^"].includes(r)&&n.add(a),s!==void 0&&typeof s!="string"&&this.recursiveGetUsedVariables(s,n)}}}async function $e(){var t;const e=await me();for(const n of e){const o=(t=n.properties)!==null&&t!==void 0?t:[];for(const r of o){if(r.type==="int"||r.type==="bool"||r.type==="object"||typeof r.value!="string")continue;const a=new Ae(r.value,WA.state);if(a.isPureString())continue;const s=a.getValue();await ie(n.name,r.name,s),a.onChange(async i=>{await ie(n.name,r.name,i)})}}}async function Ye(){var t;const e=await I();for(const[n,o]of e.entries())if(o.type!=="objectgroup"){const r=(t=o.properties)!==null&&t!==void 0?t:[];for(const a of r){if(a.type==="int"||a.type==="bool"||a.type==="object"||typeof a.value!="string")continue;const s=new Ae(a.value,WA.state);if(s.isPureString())continue;const i=s.getValue();ce(n,a.name,i),s.onChange(c=>{ce(n,a.name,c)})}}}async function ie(t,e,n){console.log(t),(await WA.room.area.get(t)).setProperty(e,n)}function ce(t,e,n){WA.room.setProperty(t,e,n),e==="visible"&&(n?WA.room.showLayer(t):WA.room.hideLayer(t))}const ze="https://admin.workadventu.re/html";let Z,te=0,ne=0;function le(t){if(WA.state[t.name]){let e=t.properties.mustGetString("openLayer");for(const n of e.split(`
`))WA.room.showLayer(n);e=t.properties.mustGetString("closeLayer");for(const n of e.split(`
`))WA.room.hideLayer(n)}else{let e=t.properties.mustGetString("openLayer");for(const n of e.split(`
`))WA.room.hideLayer(n);e=t.properties.mustGetString("closeLayer");for(const n of e.split(`
`))WA.room.showLayer(n)}}function Xe(t){const e=t.properties.getString("openSound"),n=t.properties.getNumber("soundRadius");let o=1;if(n){const r=We(t.properties.mustGetString("openLayer").split(`
`));if(r>n)return;o=1-r/n}e&&WA.sound.loadSound(e).play({volume:o})}function Je(t){const e=t.properties.getString("closeSound"),n=t.properties.getNumber("soundRadius");let o=1;if(n){const r=We(t.properties.mustGetString("closeLayer").split(`
`));if(r>n)return;o=1-r/n}e&&WA.sound.loadSound(e).play({volume:o})}function we(t){return t.map(e=>Z.get(e)).filter(e=>(e==null?void 0:e.type)==="tilelayer")}function We(t){const e=we(t),n=ve(e),o=((n.right-n.left)/2+n.left)*32,r=((n.bottom-n.top)/2+n.top)*32;return Math.sqrt(Math.pow(te-o,2)+Math.pow(ne-r,2))}function Ze(t){WA.state.onVariableChange(t.name).subscribe(()=>{WA.state[t.name]?Xe(t):Je(t),le(t)}),le(t)}function ue(t,e,n,o){const r=t.name;let a,s,i=!1;const c=n.getString("tag");let u=!0;c&&!WA.player.tags.includes(c)&&(u=!1);const f=!!c;function g(){var l;a&&a.remove(),a=WA.ui.displayActionMessage({message:(l=n.getString("closeTriggerMessage"))!==null&&l!==void 0?l:"Press SPACE to close the door",callback:()=>{WA.state[e.name]=!1,m()}})}function m(){var l;a&&a.remove(),a=WA.ui.displayActionMessage({message:(l=n.getString("openTriggerMessage"))!==null&&l!==void 0?l:"Press SPACE to open the door",callback:()=>{WA.state[e.name]=!0,g()}})}function O(){let l;if(t.type==="tilelayer")l=ve(we(e.properties.mustGetString("closeLayer").split(`
`)));else{if(t.x===void 0||t.y===void 0||t.width===void 0||t.height===void 0)throw new Error(`Doorstep zone "${t.name}" is missing x, y, width or height`);l={top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}s=WA.room.website.create({name:"doorKeypad"+r,url:o+"/keypad.html#"+encodeURIComponent(r),position:{x:l.right*32,y:l.top*32,width:32*3,height:32*4},allowApi:!0})}function R(){s&&(WA.room.website.delete(s.name),s=void 0)}function p(){if(i=!0,n.getBoolean("autoOpen")&&u){WA.state[e.name]=!0;return}if(!WA.state[e.name]&&(f&&!u||!f)&&(n.getString("code")||n.getString("codeVariable"))){O();return}u&&(WA.state[e.name]?g():m())}function v(){i=!1,n.getBoolean("autoClose")&&(WA.state[e.name]=!1),a&&a.remove(),R()}t.type==="tilelayer"?(WA.room.onEnterLayer(r).subscribe(p),WA.room.onLeaveLayer(r).subscribe(v)):(WA.room.area.onEnter(r).subscribe(p),WA.room.area.onLeave(r).subscribe(v)),WA.state.onVariableChange(e.name).subscribe(()=>{i&&(!n.getBoolean("autoClose")&&WA.state[e.name]===!0&&g(),s&&WA.state[e.name]===!0&&R(),!n.getBoolean("autoOpen")&&WA.state[e.name]===!1&&m())})}function et(t){const e=t.properties.mustGetString("bellSound"),n=t.properties.getNumber("soundRadius");let o=1;if(n){const r=Math.sqrt(Math.pow(t.x-te,2)+Math.pow(t.y-ne,2));if(r>n)return;o=1-r/n}WA.sound.loadSound(e).play({volume:o})}function tt(t){WA.state[t.name]===void 0&&(WA.state[t.name]=0),WA.state.onVariableChange(t.name).subscribe(()=>{WA.state[t.name]&&et(t)})}function pe(t,e,n){let o;const r=e.getString("bellPopup");if(n.type==="tilelayer"){const a=n.name;WA.room.onEnterLayer(a).subscribe(()=>{var s;r?o=WA.ui.openPopup(r,"",[{label:(s=e.getString("bellButtonText"))!==null&&s!==void 0?s:"Ring",callback:()=>{WA.state[t]=WA.state[t]+1}}]):WA.state[t]=WA.state[t]+1}),WA.room.onLeaveLayer(a).subscribe(()=>{o&&(o.close(),o=void 0)})}else{const a=n.name;WA.room.area.onEnter(a).subscribe(()=>{var s;r?o=WA.ui.openPopup(r,"",[{label:(s=e.getString("bellButtonText"))!==null&&s!==void 0?s:"Ring",callback:()=>{WA.state[t]=WA.state[t]+1}}]):WA.state[t]=WA.state[t]+1}),WA.room.area.onLeave(a).subscribe(()=>{o&&(o.close(),o=void 0)})}}async function nt(t){t=t??ze;const e=await Me();Z=await I();for(const n of e.values())n.properties.get("door")&&Ze(n),n.properties.get("bell")&&tt(n);for(const n of Z.values()){const o=new C(n.properties),r=o.getString("doorVariable");if(r&&n.type==="tilelayer"){const s=e.get(r);if(s===void 0)throw new Error('Cannot find variable "'+r+'" referred in the "doorVariable" property of layer "'+n.name+'"');ue(n,s,o,t)}const a=o.getString("bellVariable");a&&n.type==="tilelayer"&&pe(a,o,n)}for(const n of await me()){const o=new C(n.properties),r=o.getString("doorVariable");if(r){const s=e.get(r);if(s===void 0)throw new Error('Cannot find variable "'+r+'" referred in the "doorVariable" property of object "'+n.name+'"');ue(n,s,o,t)}const a=o.getString("bellVariable");a&&pe(a,o,n)}WA.player.onPlayerMove(n=>{te=n.x,ne=n.y})}function ot(t,e){const n=t.getString("bindVariable");if(n){const o=t.get("enterValue"),r=t.get("leaveValue"),a=t.getString("triggerMessage"),s=t.getString("tag");rt(n,e,o,r,a,s)}}let V;function rt(t,e,n,o,r,a){a&&!WA.player.tags.includes(a)||(n!==void 0&&WA.room.onEnterLayer(e).subscribe(()=>{r?V=WA.ui.displayActionMessage({type:"message",message:r,callback:()=>{WA.state[t]=n}}):WA.state[t]=n}),o!==void 0&&WA.room.onLeaveLayer(e).subscribe(()=>{WA.state[t]=o,V&&(V.remove().catch(s=>{console.error(s)}),V=void 0)}))}async function at(){const t=await I();for(const e of t.values()){const n=new C(e.properties);ot(n,e.name)}}let fe;async function st(t){const e=await WA.room.getTiledMap();t=t??ge,fe=await I();const n=e.layers.find(o=>o.name==="configuration");if(n){const r=new C(n.properties).getString("tag");(!r||WA.player.tags.includes(r))&&WA.ui.registerMenuCommand("Configure the room",()=>{WA.nav.openCoWebSite(t+"/configuration.html",!0)});for(const a of fe.values()){const s=new C(a.properties),i=s.getString("openConfig");i&&a.type==="tilelayer"&&it(i.split(","),a.name,s)}}}function it(t,e,n){let o;const r=n.getString("openConfigAdminTag");let a=!0;r&&!WA.player.tags.includes(r)&&(a=!1);function s(){var c;o&&o.remove(),o=WA.ui.displayActionMessage({message:(c=n.getString("openConfigTriggerMessage"))!==null&&c!==void 0?c:"Press SPACE or touch here to configure",callback:()=>re(t)})}function i(){WA.nav.closeCoWebSite()}WA.room.onEnterLayer(e).subscribe(()=>{const c=n.getString("openConfigTrigger");a&&(c&&c==="onaction"?s():re(t))}),WA.room.onLeaveLayer(e).subscribe(()=>{o&&o.remove(),i()})}function ct(){return WA.onInit().then(()=>{nt().catch(t=>console.error(t)),at().catch(t=>console.error(t)),st().catch(t=>console.error(t)),Ye().catch(t=>console.error(t)),$e().catch(t=>console.error(t))}).catch(t=>console.error(t))}let S;function lt(){WA.room.area.onEnter("clock").subscribe(()=>{const t=new Date,e=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0");S&&S.close(),S=WA.ui.openPopup("clockPopup",`It's ${e}:${n}`,[])}),WA.room.area.onLeave("clock").subscribe(()=>{S&&(S.close(),S=void 0)})}let G;function ut(){const t=()=>{G&&(G.close(),G=void 0)};WA.room.area.onEnter("board").subscribe(()=>{t();const e="The bulletin board hums with strange energy. Five portals shimmer before you—choose your path: 💜 Malware — malicious code that corrupts, spies, and destroys • 🔵 Phishing/Quishing — fake messages or QR Codes that trick you into giving secrets • 🔴 Identity Theft — criminals using your identity • 🟡 xxxxxxxxxxxx • 💚 Password Security — strong, unique passwords and MFA to protect your accounts.";G=WA.ui.openPopup("boardPopup",e,[])}),WA.room.area.onLeave("board").subscribe(t)}let E;function J(){var t;if(E){try{(t=E.close)==null||t.call(E)}catch{}E=void 0}}function pt(){var t,e;try{const n=(e=(t=WA.room.object)==null?void 0:t.get)==null?void 0:e.call(t,"MarvieZone");if(n&&n.properties){const o=n.properties;if(Array.isArray(o)){const r=o.find(a=>a.name==="marvieMessage"||a.name==="marviePopup");if(r!=null&&r.value)return String(r.value)}else if(o.marvieMessage)return String(o.marvieMessage)}}catch{}return["👋 Hi — I'm Marvie.","","Welcome to the Room of Malware.","Do you think you can find the 3 easter eggs around the map?","Tip: Check the walls, the chairs or the floor for suspicious objects."].join(`
`)}function ft(){console.log("[Marvie] init"),WA.room.area.onEnter("MarvieZone").subscribe(()=>{J();const t=pt();E=WA.ui.openPopup("marviePopup",t,[{label:"Got it",callback:()=>J()}])}),WA.room.area.onLeave("MarvieZone").subscribe(()=>{J()})}let A;const P=()=>{var t;try{(t=A==null?void 0:A.close)==null||t.call(A)}catch{}A=void 0};function ht(t,e){P();const n=(e||[]).map(o=>({label:o.label,callback:()=>{P();try{o.callback()}catch{}}}));return A=WA.ui.openPopup("QRcodePopup",t,n),A}const H=typeof globalThis.openNpcPopup=="function"?(t,e)=>(P(),A=globalThis.openNpcPopup(t,e),A):ht;function q(){H("You saw a QR code on the wall. CLAIM YOUR FREE POKEMON PACKS HERE!! Do you scan it?",[{label:"Yes",callback:dt},{label:"No",callback:gt},{label:"What is quishing?",callback:yt}])}function dt(){H(`⚠️ Quishing (QR phishing): Scanning unknown QR codes can send you to fake login pages, trigger malicious downloads, or open payment requests.

Examples:
• Fake "Campus Wi-Fi" login that steals your credentials
• "Free voucher" QR that asks you to install a dodgy app.

Safer habit: Only scan trusted QRs, preview the link, or type the official URL yourself.`,[{label:"Back",callback:q},{label:"OK",callback:P}])}function gt(){H('✅ Correct! Avoid scanning random QR codes. This method of phishing is called "quishing". If a code looks suspicious or is a sticker placed over a poster, don’t scan it—navigate to the site yourself.',[{label:"Back",callback:q},{label:"OK",callback:P}])}function yt(){H(`Quishing = QR + phishing. Attackers plant QR codes in public places or messages to lure you to malicious sites.

Tips:
• Preview the URL before opening
• Check the exact domain (not just the logo)
• Never enter credentials after scanning an unknown QR`,[{label:"Back",callback:q},{label:"Close",callback:P}])}function bt(){WA.onInit().then(()=>{console.log("[qrcode] ready, listening for area 'QRcode'"),WA.room.area.onEnter("QRcode").subscribe(q),WA.room.area.onLeave("QRcode").subscribe(P)})}const mt="MurdochEmailPopup";let b;function F(t,e){var n;try{(n=b==null?void 0:b.close)==null||n.call(b)}catch{}b=WA.ui.openPopup(mt,t,e)}function N(){var t;try{(t=b==null?void 0:b.close)==null||t.call(b)}catch{}b=void 0}function $(){console.log("[MurdochEmail] askEmail()"),F('📧 Email says: "Your university fees are overdue. Click here to pay immediately." What do you do?',[{label:"Click the link and pay",callback:vt},{label:"Verify first (don't click)",callback:oe},{label:"See red flags",callback:ke},{label:"Close",callback:N}])}function vt(){console.log("[MurdochEmail] clicked()"),F(`⚠️ Risky. Classic phishing.

What can happen?
• Fake payment page steals your login or card
• Malware prompts
• "Update details" forms that harvest personal info

Safer: never pay from email links. Open the official portal yourself.`,[{label:"How to verify safely",callback:oe},{label:"Back",callback:$},{label:"OK",callback:N}])}function oe(){console.log("[MurdochEmail] verify()"),F(`✅ Correct.

Verify steps:
• Check the sender domain carefully
• Preview the real link (hover/long-press)
• Type the official portal URL or use your bookmark
• Check balance inside the portal (not via the email link)
• If unsure, contact the uni via the official helpdesk`,[{label:"See red flags",callback:ke},{label:"Back",callback:$},{label:"Close",callback:N}])}function ke(){console.log("[MurdochEmail] flags()"),F(`Common red flags:
• Urgent language / threats ("immediately", "final notice")
• Look-alike sender domains
• Links that don't match the uni's real domain
• Attachments/QRs to "pay faster"
• Requests for card/bank info or passwords via email`,[{label:"Verify safely",callback:oe},{label:"Back",callback:$},{label:"Close",callback:N}])}function At(){WA.onInit().then(()=>{console.log("[MurdochEmail] ready → listening for area 'MurdochEmail'"),WA.room.area.onEnter("MurdochEmail").subscribe(()=>{console.log("[MurdochEmail] onEnter"),$()}),WA.room.area.onLeave("MurdochEmail").subscribe(()=>{console.log("[MurdochEmail] onLeave"),N()})})}let U;function wt(){const t="BrockZonePopup",e=()=>{U&&(U.close(),U=void 0)};WA.room.area.onEnter("BrockZone").subscribe(()=>{e();const n="Brock: Hey there! Please don't go! Are you sure you have all things about phishing understood?";U=WA.ui.openPopup(t,n,[])}),WA.room.area.onLeave("BrockZone").subscribe(e)}let _;function he(){_&&(_.close(),_=void 0)}function Wt(){WA.room.area.onEnter("billboard").subscribe(()=>{he(),_=WA.ui.openPopup("billboardPopup",`📜 The community billboard

➡️ Move towards the ladder on the right and begin your adventure!`,[])}),WA.room.area.onLeave("billboard").subscribe(()=>{he()})}let K;function kt(){WA.onInit().then(()=>{console.log("[WA] Instructions ready"),de(),WA.room.area.onEnter("instructions").subscribe(()=>{de()}),WA.room.area.onLeave("instructions").subscribe(()=>{Pe()})})}function de(){Pe(),K=WA.ui.openPopup("instructionsPopup","👋 Welcome Ranger! Use the Arrow Keys or WASD to move around. Walk close to objects such as signs, boards, or NPCs to interact with them. Sometimes you will need to press SPACE to open a dialogue or a side panel with more details. Explore the garden and see what you can discover!",[{label:"Let’s go!",className:"primary",callback:t=>t.close()}])}function Pe(){K&&(K.close(),K=void 0)}let B;function Pt(t,e,n=[]){return Se(),B=WA.ui.openPopup(t,e,n),B}function Se(){B&&(B.close(),B=void 0)}function St(){WA.onInit().then(()=>{WA.room.area.onEnter("instructions_phishingPopup").subscribe(()=>{Pt("phishingIntro","🔎 This room hides 3 easter eggs. Explore the objects and see what you can find. Speak with the NPC for more in-depth details about phishing before moving on to the next map.",[{label:"Got it!",className:"primary",callback:t=>t.close()}])}),WA.room.area.onLeave("instructions_phishingPopup").subscribe(Se)})}const w={blackbibleppt:!1,MurdochEmail:!1,QRcode:!1,BrockZone:!1};function Et(){WA.onInit().then(()=>{console.log("[WA] Library progression system ready"),WA.room.area.onEnter("blackbibleppt").subscribe(()=>D("blackbibleppt")),WA.room.area.onEnter("MurdochEmail").subscribe(()=>D("MurdochEmail")),WA.room.area.onEnter("QRcode").subscribe(()=>D("QRcode")),WA.room.area.onEnter("BrockZone").subscribe(()=>D("BrockZone")),WA.room.area.onEnter("to-canteen").subscribe(()=>{Ct()?WA.nav.goToRoom("canteen.tmj#from-library"):Lt()})})}function D(t){if(w[t])return;w[t]=!0;const e=WA.ui.openPopup("progressHint",Mt(),[]);setTimeout(()=>e.close(),1200)}function Ct(){return w.blackbibleppt&&w.MurdochEmail&&w.QRcode&&w.BrockZone}function Mt(){return`Progress: ${Number(w.blackbibleppt)+Number(w.MurdochEmail)+Number(w.QRcode)+Number(w.BrockZone)}/4 — Find 3 easter eggs and talk to the NPC before moving on.`}function Lt(){WA.ui.openPopup("stairsBlocked","The stairs are locked. Discover all 3 easter eggs and speak to the NPC before moving on.",[{label:"OK",className:"primary",callback:t=>t.close()}])}console.log("Script started");WA.onInit().then(async()=>{console.log("Scripting API ready"),await ct(),lt(),ut(),ft(),bt(),At(),wt(),Wt(),kt(),St(),Et()});
//# sourceMappingURL=main-b9de3002.js.map
