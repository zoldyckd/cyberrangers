class pe{constructor(t){this.properties=t??[]}get(t){const o=this.properties.filter(n=>n.name===t).map(n=>n.value);if(o.length>1)throw new Error('Expected only one property to be named "'+t+'"');if(o.length!==0)return o[0]}getString(t){return this.getByType(t,"string")}getNumber(t){return this.getByType(t,"number")}getBoolean(t){return this.getByType(t,"boolean")}getByType(t,o){const n=this.get(t);if(n!==void 0){if(o!=="json"&&typeof n!==o)throw new Error('Expected property "'+t+'" to have type "'+o+'"');return n}}mustGetString(t){return this.mustGetByType(t,"string")}mustGetNumber(t){return this.mustGetByType(t,"number")}mustGetBoolean(t){return this.mustGetByType(t,"boolean")}mustGetByType(t,o){const n=this.get(t);if(n===void 0)throw new Error('Property "'+t+'" is missing');if(o!=="json"&&typeof n!==o)throw new Error('Expected property "'+t+'" to have type "'+o+'"');return n}getType(t){const o=this.properties.filter(n=>n.name===t).map(n=>n.type);if(o.length>1)throw new Error('Expected only one property to be named "'+t+'"');if(o.length!==0)return o[0]}}const Gt="https://unpkg.com/@workadventure/scripting-api-extra@1.9.10/dist";class Vt{constructor(t){this.name=t.name,this.x=t.x,this.y=t.y,this.properties=new pe(t.properties)}get isReadable(){const t=this.properties.getString("readableBy");return t?WA.player.tags.includes(t):!0}get isWritable(){const t=this.properties.getString("writableBy");return t?WA.player.tags.includes(t):!0}}function ct(e){const t=e?"#"+e.join():"";WA.nav.openCoWebSite(Gt+"/configuration.html"+t,!0)}async function qt(e,t){const o=await WA.room.getTiledMap(),n=new Map;return Ot(o.layers,n,e,t),n}function Ot(e,t,o,n){for(const r of e)if(r.type==="objectgroup"){for(const s of r.objects)if(s.type==="variable"||s.class==="variable"){if(o&&r.name!==o||n&&!n.includes(s.name))continue;t.set(s.name,new Vt(s))}}else r.type==="group"&&Ot(r.layers,t,o,n)}let Ee;async function be(){return Ee===void 0&&(Ee=zt()),Ee}async function zt(){return Qt(await WA.room.getTiledMap())}function Qt(e){const t=new Map;return Rt(e.layers,"",t),t}function Rt(e,t,o){for(const n of e)n.type==="group"?Rt(n.layers,t+n.name+"/",o):(n.name=t+n.name,o.set(n.name,n))}async function Bt(){const e=await be(),t=[];for(const o of e.values())if(o.type==="objectgroup")for(const n of o.objects)(n.type==="area"||n.class==="area")&&t.push(n);return t}function Xt(e){let t=1/0,o=1/0,n=0,r=0;const s=e.data;if(typeof s=="string")throw new Error("Unsupported tile layer data stored as string instead of CSV");for(let a=0;a<e.height;a++)for(let i=0;i<e.width;i++)s[i+a*e.width]!==0&&(t=Math.min(t,i),r=Math.max(r,i),o=Math.min(o,a),n=Math.max(n,a));return{top:o,left:t,right:r+1,bottom:n+1}}function jt(e){let t=1/0,o=1/0,n=0,r=0;for(const s of e){const a=Xt(s);a.left<t&&(t=a.left),a.top<o&&(o=a.top),a.right>r&&(r=a.right),a.bottom>n&&(n=a.bottom)}return{top:o,left:t,right:r,bottom:n}}/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var Kt=Object.prototype.toString,he=Array.isArray||function(t){return Kt.call(t)==="[object Array]"};function rt(e){return typeof e=="function"}function $t(e){return he(e)?"array":typeof e}function Ce(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function lt(e,t){return e!=null&&typeof e=="object"&&t in e}function Jt(e,t){return e!=null&&typeof e!="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}var Zt=RegExp.prototype.test;function eo(e,t){return Zt.call(e,t)}var to=/\S/;function oo(e){return!eo(to,e)}var no={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function ro(e){return String(e).replace(/[&<>"'`=\/]/g,function(o){return no[o]})}var so=/\s*/,ao=/\s+/,ut=/\s*=/,io=/\s*\}/,co=/#|\^|\/|>|\{|&|=|!/;function lo(e,t){if(!e)return[];var o=!1,n=[],r=[],s=[],a=!1,i=!1,c="",u=0;function f(){if(a&&!i)for(;s.length;)delete r[s.pop()];else s=[];a=!1,i=!1}var g,S,we;function de(E){if(typeof E=="string"&&(E=E.split(ao,2)),!he(E)||E.length!==2)throw new Error("Invalid tags: "+E);g=new RegExp(Ce(E[0])+"\\s*"),S=new RegExp("\\s*"+Ce(E[1])),we=new RegExp("\\s*"+Ce("}"+E[1]))}de(t||y.tags);for(var p=new Ae(e),k,l,m,ye,ve,C;!p.eos();){if(k=p.pos,m=p.scanUntil(g),m)for(var ke=0,Ht=m.length;ke<Ht;++ke)ye=m.charAt(ke),oo(ye)?(s.push(r.length),c+=ye):(i=!0,o=!0,c+=" "),r.push(["text",ye,k,k+1]),k+=1,ye===`
`&&(f(),c="",u=0,o=!1);if(!p.scan(g))break;if(a=!0,l=p.scan(co)||"name",p.scan(so),l==="="?(m=p.scanUntil(ut),p.scan(ut),p.scanUntil(S)):l==="{"?(m=p.scanUntil(we),p.scan(io),p.scanUntil(S),l="&"):m=p.scanUntil(S),!p.scan(S))throw new Error("Unclosed tag at "+p.pos);if(l==">"?ve=[l,m,k,p.pos,c,u,o]:ve=[l,m,k,p.pos],u++,r.push(ve),l==="#"||l==="^")n.push(ve);else if(l==="/"){if(C=n.pop(),!C)throw new Error('Unopened section "'+m+'" at '+k);if(C[1]!==m)throw new Error('Unclosed section "'+C[1]+'" at '+k)}else l==="name"||l==="{"||l==="&"?i=!0:l==="="&&de(m)}if(f(),C=n.pop(),C)throw new Error('Unclosed section "'+C[1]+'" at '+p.pos);return po(uo(r))}function uo(e){for(var t=[],o,n,r=0,s=e.length;r<s;++r)o=e[r],o&&(o[0]==="text"&&n&&n[0]==="text"?(n[1]+=o[1],n[3]=o[3]):(t.push(o),n=o));return t}function po(e){for(var t=[],o=t,n=[],r,s,a=0,i=e.length;a<i;++a)switch(r=e[a],r[0]){case"#":case"^":o.push(r),n.push(r),o=r[4]=[];break;case"/":s=n.pop(),s[5]=r[2],o=n.length>0?n[n.length-1][4]:t;break;default:o.push(r)}return t}function Ae(e){this.string=e,this.tail=e,this.pos=0}Ae.prototype.eos=function(){return this.tail===""};Ae.prototype.scan=function(t){var o=this.tail.match(t);if(!o||o.index!==0)return"";var n=o[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n};Ae.prototype.scanUntil=function(t){var o=this.tail.search(t),n;switch(o){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,o),this.tail=this.tail.substring(o)}return this.pos+=n.length,n};function fe(e,t){this.view=e,this.cache={".":this.view},this.parent=t}fe.prototype.push=function(t){return new fe(t,this)};fe.prototype.lookup=function(t){var o=this.cache,n;if(o.hasOwnProperty(t))n=o[t];else{for(var r=this,s,a,i,c=!1;r;){if(t.indexOf(".")>0)for(s=r.view,a=t.split("."),i=0;s!=null&&i<a.length;)i===a.length-1&&(c=lt(s,a[i])||Jt(s,a[i])),s=s[a[i++]];else s=r.view[t],c=lt(r.view,t);if(c){n=s;break}r=r.parent}o[t]=n}return rt(n)&&(n=n.call(this.view)),n};function d(){this.templateCache={_cache:{},set:function(t,o){this._cache[t]=o},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}d.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};d.prototype.parse=function(t,o){var n=this.templateCache,r=t+":"+(o||y.tags).join(":"),s=typeof n<"u",a=s?n.get(r):void 0;return a==null&&(a=lo(t,o),s&&n.set(r,a)),a};d.prototype.render=function(t,o,n,r){var s=this.getConfigTags(r),a=this.parse(t,s),i=o instanceof fe?o:new fe(o,void 0);return this.renderTokens(a,i,n,t,r)};d.prototype.renderTokens=function(t,o,n,r,s){for(var a="",i,c,u,f=0,g=t.length;f<g;++f)u=void 0,i=t[f],c=i[0],c==="#"?u=this.renderSection(i,o,n,r,s):c==="^"?u=this.renderInverted(i,o,n,r,s):c===">"?u=this.renderPartial(i,o,n,s):c==="&"?u=this.unescapedValue(i,o):c==="name"?u=this.escapedValue(i,o,s):c==="text"&&(u=this.rawValue(i)),u!==void 0&&(a+=u);return a};d.prototype.renderSection=function(t,o,n,r,s){var a=this,i="",c=o.lookup(t[1]);function u(S){return a.render(S,o,n,s)}if(c){if(he(c))for(var f=0,g=c.length;f<g;++f)i+=this.renderTokens(t[4],o.push(c[f]),n,r,s);else if(typeof c=="object"||typeof c=="string"||typeof c=="number")i+=this.renderTokens(t[4],o.push(c),n,r,s);else if(rt(c)){if(typeof r!="string")throw new Error("Cannot use higher-order sections without the original template");c=c.call(o.view,r.slice(t[3],t[5]),u),c!=null&&(i+=c)}else i+=this.renderTokens(t[4],o,n,r,s);return i}};d.prototype.renderInverted=function(t,o,n,r,s){var a=o.lookup(t[1]);if(!a||he(a)&&a.length===0)return this.renderTokens(t[4],o,n,r,s)};d.prototype.indentPartial=function(t,o,n){for(var r=o.replace(/[^ \t]/g,""),s=t.split(`
`),a=0;a<s.length;a++)s[a].length&&(a>0||!n)&&(s[a]=r+s[a]);return s.join(`
`)};d.prototype.renderPartial=function(t,o,n,r){if(n){var s=this.getConfigTags(r),a=rt(n)?n(t[1]):n[t[1]];if(a!=null){var i=t[6],c=t[5],u=t[4],f=a;c==0&&u&&(f=this.indentPartial(a,u,i));var g=this.parse(f,s);return this.renderTokens(g,o,n,f,r)}}};d.prototype.unescapedValue=function(t,o){var n=o.lookup(t[1]);if(n!=null)return n};d.prototype.escapedValue=function(t,o,n){var r=this.getConfigEscape(n)||y.escape,s=o.lookup(t[1]);if(s!=null)return typeof s=="number"&&r===y.escape?String(s):r(s)};d.prototype.rawValue=function(t){return t[1]};d.prototype.getConfigTags=function(t){return he(t)?t:t&&typeof t=="object"?t.tags:void 0};d.prototype.getConfigEscape=function(t){if(t&&typeof t=="object"&&!he(t))return t.escape};var y={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){me.templateCache=e},get templateCache(){return me.templateCache}},me=new d;y.clearCache=function(){return me.clearCache()};y.parse=function(t,o){return me.parse(t,o)};y.render=function(t,o,n,r){if(typeof t!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+$t(t)+'" was given as the first argument for mustache#render(template, view, partials)');return me.render(t,o,n,r)};y.escape=ro;y.Scanner=Ae;y.Context=fe;y.Writer=d;class Dt{constructor(t,o){this.template=t,this.state=o,this.ast=y.parse(t)}getValue(){return this.value===void 0&&(this.value=y.render(this.template,this.state)),this.value}onChange(t){const o=[];for(const n of this.getUsedVariables().values())o.push(this.state.onVariableChange(n).subscribe(()=>{const r=y.render(this.template,this.state);r!==this.value&&(this.value=r,t(this.value))}));return{unsubscribe:()=>{for(const n of o)n.unsubscribe()}}}isPureString(){return this.ast.length===0||this.ast.length===1&&this.ast[0][0]==="text"}getUsedVariables(){const t=new Set;return this.recursiveGetUsedVariables(this.ast,t),t}recursiveGetUsedVariables(t,o){for(const n of t){const r=n[0],s=n[1],a=n[4];["name","&","#","^"].includes(r)&&o.add(s),a!==void 0&&typeof a!="string"&&this.recursiveGetUsedVariables(a,o)}}}async function fo(){var e;const t=await Bt();for(const o of t){const n=(e=o.properties)!==null&&e!==void 0?e:[];for(const r of n){if(r.type==="int"||r.type==="bool"||r.type==="object"||typeof r.value!="string")continue;const s=new Dt(r.value,WA.state);if(s.isPureString())continue;const a=s.getValue();await pt(o.name,r.name,a),s.onChange(async i=>{await pt(o.name,r.name,i)})}}}async function ho(){var e;const t=await be();for(const[o,n]of t.entries())if(n.type!=="objectgroup"){const r=(e=n.properties)!==null&&e!==void 0?e:[];for(const s of r){if(s.type==="int"||s.type==="bool"||s.type==="object"||typeof s.value!="string")continue;const a=new Dt(s.value,WA.state);if(a.isPureString())continue;const i=a.getValue();ft(o,s.name,i),a.onChange(c=>{ft(o,s.name,c)})}}}async function pt(e,t,o){console.log(e),(await WA.room.area.get(e)).setProperty(t,o)}function ft(e,t,o){WA.room.setProperty(e,t,o),t==="visible"&&(o?WA.room.showLayer(e):WA.room.hideLayer(e))}const yo="https://admin.workadventu.re/html";let Oe,st=0,at=0;function ht(e){if(WA.state[e.name]){let t=e.properties.mustGetString("openLayer");for(const o of t.split(`
`))WA.room.showLayer(o);t=e.properties.mustGetString("closeLayer");for(const o of t.split(`
`))WA.room.hideLayer(o)}else{let t=e.properties.mustGetString("openLayer");for(const o of t.split(`
`))WA.room.hideLayer(o);t=e.properties.mustGetString("closeLayer");for(const o of t.split(`
`))WA.room.showLayer(o)}}function go(e){const t=e.properties.getString("openSound"),o=e.properties.getNumber("soundRadius");let n=1;if(o){const r=Ft(e.properties.mustGetString("openLayer").split(`
`));if(r>o)return;n=1-r/o}t&&WA.sound.loadSound(t).play({volume:n})}function mo(e){const t=e.properties.getString("closeSound"),o=e.properties.getNumber("soundRadius");let n=1;if(o){const r=Ft(e.properties.mustGetString("closeLayer").split(`
`));if(r>o)return;n=1-r/o}t&&WA.sound.loadSound(t).play({volume:n})}function Ut(e){return e.map(t=>Oe.get(t)).filter(t=>(t==null?void 0:t.type)==="tilelayer")}function Ft(e){const t=Ut(e),o=jt(t),n=((o.right-o.left)/2+o.left)*32,r=((o.bottom-o.top)/2+o.top)*32;return Math.sqrt(Math.pow(st-n,2)+Math.pow(at-r,2))}function bo(e){WA.state.onVariableChange(e.name).subscribe(()=>{WA.state[e.name]?go(e):mo(e),ht(e)}),ht(e)}function dt(e,t,o,n){const r=e.name;let s,a,i=!1;const c=o.getString("tag");let u=!0;c&&!WA.player.tags.includes(c)&&(u=!1);const f=!!c;function g(){var l;s&&s.remove(),s=WA.ui.displayActionMessage({message:(l=o.getString("closeTriggerMessage"))!==null&&l!==void 0?l:"Press SPACE to close the door",callback:()=>{WA.state[t.name]=!1,S()}})}function S(){var l;s&&s.remove(),s=WA.ui.displayActionMessage({message:(l=o.getString("openTriggerMessage"))!==null&&l!==void 0?l:"Press SPACE to open the door",callback:()=>{WA.state[t.name]=!0,g()}})}function we(){let l;if(e.type==="tilelayer")l=jt(Ut(t.properties.mustGetString("closeLayer").split(`
`)));else{if(e.x===void 0||e.y===void 0||e.width===void 0||e.height===void 0)throw new Error(`Doorstep zone "${e.name}" is missing x, y, width or height`);l={top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}a=WA.room.website.create({name:"doorKeypad"+r,url:n+"/keypad.html#"+encodeURIComponent(r),position:{x:l.right*32,y:l.top*32,width:32*3,height:32*4},allowApi:!0})}function de(){a&&(WA.room.website.delete(a.name),a=void 0)}function p(){if(i=!0,o.getBoolean("autoOpen")&&u){WA.state[t.name]=!0;return}if(!WA.state[t.name]&&(f&&!u||!f)&&(o.getString("code")||o.getString("codeVariable"))){we();return}u&&(WA.state[t.name]?g():S())}function k(){i=!1,o.getBoolean("autoClose")&&(WA.state[t.name]=!1),s&&s.remove(),de()}e.type==="tilelayer"?(WA.room.onEnterLayer(r).subscribe(p),WA.room.onLeaveLayer(r).subscribe(k)):(WA.room.area.onEnter(r).subscribe(p),WA.room.area.onLeave(r).subscribe(k)),WA.state.onVariableChange(t.name).subscribe(()=>{i&&(!o.getBoolean("autoClose")&&WA.state[t.name]===!0&&g(),a&&WA.state[t.name]===!0&&de(),!o.getBoolean("autoOpen")&&WA.state[t.name]===!1&&S())})}function Ao(e){const t=e.properties.mustGetString("bellSound"),o=e.properties.getNumber("soundRadius");let n=1;if(o){const r=Math.sqrt(Math.pow(e.x-st,2)+Math.pow(e.y-at,2));if(r>o)return;n=1-r/o}WA.sound.loadSound(t).play({volume:n})}function wo(e){WA.state[e.name]===void 0&&(WA.state[e.name]=0),WA.state.onVariableChange(e.name).subscribe(()=>{WA.state[e.name]&&Ao(e)})}function yt(e,t,o){let n;const r=t.getString("bellPopup");if(o.type==="tilelayer"){const s=o.name;WA.room.onEnterLayer(s).subscribe(()=>{var a;r?n=WA.ui.openPopup(r,"",[{label:(a=t.getString("bellButtonText"))!==null&&a!==void 0?a:"Ring",callback:()=>{WA.state[e]=WA.state[e]+1}}]):WA.state[e]=WA.state[e]+1}),WA.room.onLeaveLayer(s).subscribe(()=>{n&&(n.close(),n=void 0)})}else{const s=o.name;WA.room.area.onEnter(s).subscribe(()=>{var a;r?n=WA.ui.openPopup(r,"",[{label:(a=t.getString("bellButtonText"))!==null&&a!==void 0?a:"Ring",callback:()=>{WA.state[e]=WA.state[e]+1}}]):WA.state[e]=WA.state[e]+1}),WA.room.area.onLeave(s).subscribe(()=>{n&&(n.close(),n=void 0)})}}async function vo(e){e=e??yo;const t=await qt();Oe=await be();for(const o of t.values())o.properties.get("door")&&bo(o),o.properties.get("bell")&&wo(o);for(const o of Oe.values()){const n=new pe(o.properties),r=n.getString("doorVariable");if(r&&o.type==="tilelayer"){const a=t.get(r);if(a===void 0)throw new Error('Cannot find variable "'+r+'" referred in the "doorVariable" property of layer "'+o.name+'"');dt(o,a,n,e)}const s=n.getString("bellVariable");s&&o.type==="tilelayer"&&yt(s,n,o)}for(const o of await Bt()){const n=new pe(o.properties),r=n.getString("doorVariable");if(r){const a=t.get(r);if(a===void 0)throw new Error('Cannot find variable "'+r+'" referred in the "doorVariable" property of object "'+o.name+'"');dt(o,a,n,e)}const s=n.getString("bellVariable");s&&yt(s,n,o)}WA.player.onPlayerMove(o=>{st=o.x,at=o.y})}function Po(e,t){const o=e.getString("bindVariable");if(o){const n=e.get("enterValue"),r=e.get("leaveValue"),s=e.getString("triggerMessage"),a=e.getString("tag");Wo(o,t,n,r,s,a)}}let Pe;function Wo(e,t,o,n,r,s){s&&!WA.player.tags.includes(s)||(o!==void 0&&WA.room.onEnterLayer(t).subscribe(()=>{r?Pe=WA.ui.displayActionMessage({type:"message",message:r,callback:()=>{WA.state[e]=o}}):WA.state[e]=o}),n!==void 0&&WA.room.onLeaveLayer(t).subscribe(()=>{WA.state[e]=n,Pe&&(Pe.remove().catch(a=>{console.error(a)}),Pe=void 0)}))}async function So(){const e=await be();for(const t of e.values()){const o=new pe(t.properties);Po(o,t.name)}}let gt;async function ko(e){const t=await WA.room.getTiledMap();e=e??Gt,gt=await be();const o=t.layers.find(n=>n.name==="configuration");if(o){const r=new pe(o.properties).getString("tag");(!r||WA.player.tags.includes(r))&&WA.ui.registerMenuCommand("Configure the room",()=>{WA.nav.openCoWebSite(e+"/configuration.html",!0)});for(const s of gt.values()){const a=new pe(s.properties),i=a.getString("openConfig");i&&s.type==="tilelayer"&&Eo(i.split(","),s.name,a)}}}function Eo(e,t,o){let n;const r=o.getString("openConfigAdminTag");let s=!0;r&&!WA.player.tags.includes(r)&&(s=!1);function a(){var c;n&&n.remove(),n=WA.ui.displayActionMessage({message:(c=o.getString("openConfigTriggerMessage"))!==null&&c!==void 0?c:"Press SPACE or touch here to configure",callback:()=>ct(e)})}function i(){WA.nav.closeCoWebSite()}WA.room.onEnterLayer(t).subscribe(()=>{const c=o.getString("openConfigTrigger");s&&(c&&c==="onaction"?a():ct(e))}),WA.room.onLeaveLayer(t).subscribe(()=>{n&&n.remove(),i()})}function Co(){return WA.onInit().then(()=>{vo().catch(e=>console.error(e)),So().catch(e=>console.error(e)),ko().catch(e=>console.error(e)),ho().catch(e=>console.error(e)),fo().catch(e=>console.error(e))}).catch(e=>console.error(e))}let F;function _o(){WA.room.area.onEnter("clock").subscribe(()=>{const e=new Date,t=String(e.getHours()).padStart(2,"0"),o=String(e.getMinutes()).padStart(2,"0");F&&F.close(),F=WA.ui.openPopup("clockPopup",`It's ${t}:${o}`,[])}),WA.room.area.onLeave("clock").subscribe(()=>{F&&(F.close(),F=void 0)})}let We;function Io(){const e=()=>{We&&(We.close(),We=void 0)};WA.room.area.onEnter("board").subscribe(()=>{e();const t="The bulletin board hums with strange energy. Five portals shimmer before you—choose your path: 💜 Malware — malicious code that corrupts, spies, and destroys • 🔵 Phishing/Quishing — fake messages or QR Codes that trick you into giving secrets • 🔴 Identity Theft — criminals using your identity • 🟡 xxxxxxxxxxxx • 💚 Password Security — strong, unique passwords and MFA to protect your accounts.";We=WA.ui.openPopup("boardPopup",t,[])}),WA.room.area.onLeave("board").subscribe(e)}let z;function _e(){var e;if(z){try{(e=z.close)==null||e.call(z)}catch{}z=void 0}}function Mo(){var e,t;try{const o=(t=(e=WA.room.object)==null?void 0:e.get)==null?void 0:t.call(e,"MarvieZone");if(o&&o.properties){const n=o.properties;if(Array.isArray(n)){const r=n.find(s=>s.name==="marvieMessage"||s.name==="marviePopup");if(r!=null&&r.value)return String(r.value)}else if(n.marvieMessage)return String(n.marvieMessage)}}catch{}return["👋 Hi — I'm Marvie.","","Welcome to the Room of Malware.","Do you think you can find the 3 easter eggs around the map?","Tip: Check the walls, the chairs or the floor for suspicious objects."].join(`
`)}function Lo(){console.log("[Marvie] init"),WA.room.area.onEnter("MarvieZone").subscribe(()=>{_e();const e=Mo();z=WA.ui.openPopup("marviePopup",e,[{label:"Got it",callback:()=>_e()}])}),WA.room.area.onLeave("MarvieZone").subscribe(()=>{_e()})}const To={library:{tasks:[{key:"phishing_SMSphishing",label:"SMS",area:"phishing_SMSphishing"},{key:"phishing_MurdochEmail",label:"MurdochEmail",area:"phishing_MurdochEmail"},{key:"phishing_QRcode",label:"QRcode",area:"phishing_QRcode"},{key:"phishing_instructions",label:"PPT Slides",area:"phishing_instructions"}],exitGate:{area:"to-canteen",nextRoom:"canteen.tmj#from-library",warnAnchorId:"phishing_gate_popup"}}},No={canteen:{tasks:[{key:"malware_instructions",label:"Slides",area:"malware_instructions"},{key:"malware_discord",label:"Discord",area:"malware_discord"},{key:"malware_usbdrive",label:"USB",area:"malware_usbdrive"},{key:"malware_trojan",label:"Trojan",area:"malware_trojan"}],exitGate:{area:"to-classroom",nextRoom:"classroom.tmj#from-canteen",warnAnchorId:"malware_gate_popup"}}},xo={classroom:{tasks:[{key:"passwordsecurity_instructions",label:"Slides",area:"passwordsecurity_instructions"},{key:"passwordsecurity_lmsaccount",label:"LMS Account",area:"passwordsecurity_lmsaccount"},{key:"passwordsecurity_lmspasswordexpired",label:"Password Expired",area:"passwordsecurity_lmspasswordexpired"},{key:"passwordsecurity_unlockedpc",label:"Unlocked PC",area:"passwordsecurity_unlockedpc"}],exitGate:{area:"to-hall",nextRoom:"hall.tmj#from-classroom",warnAnchorId:"passwordsecurity_gate_popup"}}},Go={computerlab:{tasks:[{key:"idtheft_instructions",label:"Slides",area:"idtheft_instructions"},{key:"idtheft_sensitivepapers",label:"Sensitive Papers",area:"idtheft_sensitivepapers"},{key:"idtheft_customerservicecall",label:"Customer Service Call",area:"idtheft_customerservicecall"},{key:"idtheft_celebration",label:"Celebration",area:"idtheft_celebration"}],exitGate:{area:"to-office",nextRoom:"office.tmj#from-computerlab",warnAnchorId:"idtheft_gate_popup"}}},Oo={hall:{tasks:[{key:"safeinternetpractices_instructions",label:"Slides",area:"safeinternetpractices_instructions"},{key:"safeinternetpractices_freewifi",label:"Free Wi-Fi",area:"safeinternetpractices_freewifi"},{key:"safeinternetpractices_fileuploads",label:"File Uploads",area:"safeinternetpractices_fileuploads"},{key:"safeinternetpractices_outdatedsoftware",label:"Outdated Software",area:"safeinternetpractices_outdatedsoftware"}],exitGate:{area:"to-computerlab",nextRoom:"computerlab.tmj#from-hall",warnAnchorId:"safeinternetpractices_gate_popup"}}},Ro={office:{tasks:[{key:"finalboss",label:"Face CipherX",area:"finalboss_cipherx"},{key:"ending",label:"Ending Message",area:"endingmessage"},{key:"survey",label:"Survey",area:"survey"}]}},Bo={...To,...No,...xo,...Go,...Oo,...Ro},Yt="cr:goals:",it=e=>`${Yt}${e}`;function jo(e,t){try{localStorage.setItem(it(e),JSON.stringify(t))}catch{}}function Do(e){try{const t=localStorage.getItem(it(e));return t?JSON.parse(t):null}catch{return null}}function Uo(e){try{const t=[];for(let o=0;o<localStorage.length;o++){const n=localStorage.key(o);n&&n.startsWith(Yt)&&!n.endsWith(e)&&t.push(n)}t.forEach(o=>localStorage.removeItem(o))}catch{}}let U={},ue=[],mt=0,_,Ie=0,Q=!1,bt="";function Fo(){WA.onInit().then(async()=>{const e=await Ho()||"";if(!e){console.log("[ProgressChecker] No mapId resolved.");return}if(bt===e)return;bt=e;const t=Bo[e];if(Me(),Uo(e),!t){console.log("[ProgressChecker] No config for map:",e);return}console.log("[ProgressChecker] Init for map:",e),ue=t.tasks;const o=Do(e);if(U={...Object.fromEntries(ue.map(r=>[r.key,!1])),...o??{}},window.addEventListener("beforeunload",()=>Me(),{passive:!0}),ue.forEach(r=>{try{WA.room.area.onEnter(r.area).subscribe(()=>{Q||U[r.key]||(U[r.key]=!0,jo(e,U),wt(),At()&&WA.ui.displayActionMessage({message:"✅ All tasks done! You may proceed to the exit.",callback:()=>{}}))})}catch(s){console.warn(`[ProgressChecker] area '${r.area}' not found on this map`,s)}}),t.exitGate){const{area:r,nextRoom:s,warnAnchorId:a}=t.exitGate;WA.room.area.onEnter(r).subscribe(()=>{if(Q)return;if(At()){Q=!0,Me();try{WA.controls.disablePlayerControls()}catch{}try{localStorage.removeItem(it(e))}catch{}setTimeout(()=>WA.nav.goToRoom(s),40);return}const i=Date.now();if(i-Ie<500)return;Ie=i;const c=Yo();if(a)try{Se(),_=WA.ui.openPopup(a,`🚧 Hold up!

You still need to complete:
• ${c.join(`
• `)}

Find all tasks in this room before leaving.`,[{label:"Close",className:"primary",callback:()=>Se()}]);return}catch{}WA.ui.displayActionMessage({message:`🚧 Hold up! Missing: ${c.join(", ")}`,callback:()=>{}})}),WA.room.area.onLeave(r).subscribe(()=>{Se(),Q||(Ie=0)})}setTimeout(()=>{Q||wt()},300)})}function At(){return ue.every(e=>U[e.key])}function Yo(){return ue.filter(e=>!U[e.key]).map(e=>e.label)}function wt(){if(Q)return;const e=Date.now();if(e-mt<150)return;mt=e;const t=ue.map(o=>U[o.key]?`✅ ${o.label}`:`⬜ ${o.label}`).join("   ");WA.ui.displayActionMessage({message:`Progress:  ${t}`,callback:()=>{}})}function Se(){var e;try{(e=_==null?void 0:_.close)==null||e.call(_)}catch{}_=void 0}function Me(){Se()}async function Ho(){var e,t,o;try{const n=decodeURIComponent(location.href).match(/\/([^\/?#]+)\.tmj/i);if(n!=null&&n[1])return n[1].toLowerCase()}catch{}try{const n=await((t=(e=WA.room).getTiledMap)==null?void 0:t.call(e)),r=n==null?void 0:n.properties,s=(o=r==null?void 0:r.find(a=>(a==null?void 0:a.name)==="mapId"))==null?void 0:o.value;if(typeof s=="string"&&s.trim())return s.trim().toLowerCase()}catch{}return""}let I;const vt="phishing_QRcode",Vo="phishing_QRcodePopup";function qo(){WA.onInit().then(()=>{WA.room.area.onEnter(vt).subscribe(()=>{Le(),I=WA.ui.openPopup(Vo,"🍗 You spot a poster in the library:“FREE NUGGETS FOR LIFE – Scan Me!” Your friend insists it looks real, but scanning random QR codes can lead to fake websites or data theft. What would you do? Press SPACE to help!",[{label:"Got it",callback:()=>Le()}])}),WA.room.area.onLeave(vt).subscribe(()=>{Le()})})}function Le(){var e;try{I&&((e=I.close)==null||e.call(I),I=void 0)}catch{I=void 0}}let M;const Pt="phishing_MurdochEmail",zo="phishing_MurdochEmailPopup";function Qo(){WA.onInit().then(()=>{WA.room.area.onEnter(Pt).subscribe(()=>{Te(),M=WA.ui.openPopup(zo,`📧 You received an email: “Your university fees are overdue. Click here to pay immediately.”

⚠️ This looks suspicious... What would you do? Press SPACE to help!`,[{label:"Got it",callback:()=>Te()}])}),WA.room.area.onLeave(Pt).subscribe(()=>{Te()})})}function Te(){var e;try{M&&((e=M.close)==null||e.call(M),M=void 0)}catch{M=void 0}}let L;const Wt="phishing_SMSphishing",Xo="phishing_SMSphishingPopup";function Ko(){WA.onInit().then(()=>{WA.room.area.onEnter(Wt).subscribe(()=>{Ne(),L=WA.ui.openPopup(Xo,"🔗 You received a message: “Your Murdoch account needs verification! Click here: https://tinyurl.com/murdoch-reset. Shortened links can hide where they actually lead. Always check the real destination before clicking! What would you do? Press SPACE to help!",[{label:"Got it",callback:()=>Ne()}])}),WA.room.area.onLeave(Wt).subscribe(()=>{Ne()})})}function Ne(){var e;try{L&&((e=L.close)==null||e.call(L),L=void 0)}catch{L=void 0}}let X;function $o(){WA.onInit().then(()=>{console.log("[WA] Phishing sign instructions ready"),WA.room.area.onEnter("phishing_instructions").subscribe(()=>{Jo()}),WA.room.area.onLeave("phishing_instructions").subscribe(()=>{Re()})})}function Jo(){Re(),X=WA.ui.openPopup("phishing_instructionsPopup","🧑‍💻 Quick! We saw one of the hackers going through this room! They are using phishing emails and dodgy QR codes to endanger students on campus! Before you chase after him, you should read these slides to learn how you can defend against Phishing.  ",[{label:"Got it!",className:"primary",callback:()=>Re()}])}function Re(){var e;X&&((e=X.close)==null||e.call(X),X=void 0)}let b,A;function xe(){var e,t;try{(e=b==null?void 0:b.close)==null||e.call(b)}catch{}b=void 0;try{(t=A==null?void 0:A.unsubscribe)==null||t.call(A)}catch{}A=void 0}function St(){var e,t;try{(e=b==null?void 0:b.close)==null||e.call(b)}catch{}b=WA.ui.openPopup("phishing_librarySpawnPopup","📌 Please proceed and talk to Professor Byte.",[{label:"OK",callback:xe}]);try{(t=A==null?void 0:A.unsubscribe)==null||t.call(A)}catch{}A=WA.room.area.onLeave("from-garden").subscribe(xe),setTimeout(()=>{xe()},5e3)}function Zo(){WA.onInit().then(()=>{WA.room.area.onEnter("from-garden").subscribe(St),setTimeout(()=>{WA.player.getPosition().then(()=>St())},250)})}let T,Y,H,kt=!1;const Et="billboard",en="billboardPopup";function ge(){var e;try{(e=T==null?void 0:T.close)==null||e.call(T)}catch{}T=void 0}function tn(){kt||(kt=!0,WA.onInit().then(()=>{var e,t,o,n,r,s;try{(e=Y==null?void 0:Y.unsubscribe)==null||e.call(Y)}catch{}try{(t=H==null?void 0:H.unsubscribe)==null||t.call(H)}catch{}Y=WA.room.area.onEnter(Et).subscribe(()=>{console.log("[billboard] enter"),ge(),T=WA.ui.openPopup(en,`📜 The community billboard

➡️ Move towards the ladder on the right and begin your adventure!`,[{label:"Close",className:"primary",callback:()=>ge()}])}),H=WA.room.area.onLeave(Et).subscribe(()=>{console.log("[billboard] leave"),ge()}),(s=(n=(o=WA.room).onLeaveLayer)==null?void 0:(r=n.call(o,"**")).subscribe)==null||s.call(r,()=>ge()),window.addEventListener("blur",ge)}))}let K;function on(){WA.onInit().then(()=>{setTimeout(nn,50)})}function nn(){Ct(),K=WA.ui.openPopup("spawnIntroPopup","👋 Welcome! Use the Arrow Keys or WASD to move. Explore the map and look for Professor Byte for guidance. Tip: Walk close to objects (signs, boards, NPCs) to interact with them.",[{label:"Got it",className:"primary",callback:e=>{var t;try{(t=e.close)==null||t.call(e)}catch{}Ct()}}])}function Ct(){var e;if(K){try{(e=K.close)==null||e.call(K)}catch{}K=void 0}}let N,V,q,_t=!1;const It="instructions",rn="instructionsPopup";function sn(){_t||(_t=!0,WA.onInit().then(()=>{var e,t;try{(e=V==null?void 0:V.unsubscribe)==null||e.call(V)}catch{}try{(t=q==null?void 0:q.unsubscribe)==null||t.call(q)}catch{}V=WA.room.area.onEnter(It).subscribe(()=>{Ge(),N=WA.ui.openPopup(rn,"🏫 Thank the heavens you're here! Brave student, Murdoch University is under a Cyber Attack! We need your help to protect the school against evildoers who wish us harm. Please proceed through the school and learn about how you can help us!",[{label:"Close",className:"primary",callback:()=>Ge()}])}),q=WA.room.area.onLeave(It).subscribe(()=>{Ge()})}))}function Ge(){var e;try{(e=N==null?void 0:N.close)==null||e.call(N)}catch{}N=void 0}const an="posterPopup";let w;function cn(e){var t;try{(t=w==null?void 0:w.close)==null||t.call(w)}catch{}w=WA.ui.openPopup(an,e,[])}function ln(){var e;try{(e=w==null?void 0:w.close)==null||e.call(w)}catch{}w=void 0}function un(){WA.room.area.onEnter("poster").subscribe(()=>{cn(`🪧 You notice a faded poster: "Think Before You Click! Your Cyber Kingdom Depends On It."

💭 You: (to yourself) 'Think before you click.' That's a good motto.

📢 Narrator: Always pause before clicking unknown links. Your vigilance protects your cyber kingdom!`)}),WA.room.area.onLeave("poster").subscribe(ln)}const pn="usbdrivePopup";let v;function fn(e){var t;try{(t=v==null?void 0:v.close)==null||t.call(v)}catch{}v=WA.ui.openPopup(pn,e,[])}function hn(){var e;try{(e=v==null?void 0:v.close)==null||e.call(v)}catch{}v=void 0}function dn(){WA.room.area.onEnter("usbdrive").subscribe(()=>{fn(`💾 You spot a random USB drive on the floor.

💭 You: Should I plug this into a PC and see what's inside?

📢 Narrator: Never plug in unknown USBs. They can hide malware that runs automatically. If you find one in real life, hand it to IT/Security instead of investigating it yourself.`)}),WA.room.area.onLeave("usbdrive").subscribe(hn)}const yn="stickynotePopup";let P;function gn(e){var t;try{(t=P==null?void 0:P.close)==null||t.call(P)}catch{}P=WA.ui.openPopup(yn,e,[])}function mn(){var e;try{(e=P==null?void 0:P.close)==null||e.call(P)}catch{}P=void 0}function bn(){WA.room.area.onEnter("stickynote").subscribe(()=>{gn(`📝 A sticky note is stuck to the monitor: “Email PW: P@ssw0rd123”.

💭 You: Wah… someone actually wrote their password here.

📢 Narrator: Don’t write passwords on paper or share them. Use a password manager, create unique passphrases, and always enable MFA (multi-factor authentication).`)}),WA.room.area.onLeave("stickynote").subscribe(mn)}const An="instructions_safeinternetpracticesPopup";let W;function wn(e){var t;try{(t=W==null?void 0:W.close)==null||t.call(W)}catch{}W=WA.ui.openPopup(An,e,[])}function vn(){var e;try{(e=W==null?void 0:W.close)==null||e.call(W)}catch{}W=void 0}function Pn(){WA.room.area.onEnter("instructions_safeinternetpractices").subscribe(()=>{wn(`🛡️ Welcome to the Safe Internet Practices office!

• Explore the room and look for hidden clues (poster, USB drive, sticky note).
• Read your character’s thoughts and the narrator’s tips.
• Learn to: think before you click, protect passwords, and avoid risky devices.

When you’re done, proceed to the exit to continue your mission.`)}),WA.room.area.onLeave("instructions_safeinternetpractices").subscribe(vn)}const h={poster:!1,usbdrive:!1,stickynote:!1,AmeliaZone:!1},Wn="to-hall",Sn="hall.tmj#from-canteen";function kn(){WA.onInit().then(()=>{console.log("[OfficeProgress] ready"),["poster","usbdrive","stickynote"].forEach(e=>{WA.room.area.onEnter(e).subscribe(()=>{console.log(`[OfficeProgress] ENTER ${e}`),h[e]||(h[e]=!0,Lt())})}),WA.room.area.onEnter("AmeliaZone").subscribe(()=>{console.log("[OfficeProgress] ENTER AmeliaZone"),h.AmeliaZone||(h.AmeliaZone=!0,Lt())}),WA.room.area.onEnter(Wn).subscribe(()=>{console.log("[OfficeProgress] ENTER EXIT, allDone =",Mt()),Mt()?WA.nav.goToRoom(Sn):WA.ui.openPopup("safeinternet_gate_popup",`🚧 Hold up!

You still need to complete:
• ${En().join(`
• `)}

Find all 3 clues and talk to Amelia before leaving.`,[{label:"OK",className:"primary",callback:e=>e.close()}])})})}function Mt(){return h.poster&&h.usbdrive&&h.stickynote&&h.AmeliaZone}function En(){const e=[];return h.poster||e.push("Old Security Poster"),h.usbdrive||e.push("USB Drive"),h.stickynote||e.push("Sticky Note"),h.AmeliaZone||e.push("Talk to Amelia (NPC)"),e}function Lt(){const e=[h.poster?"✅ Poster":"⬜ Poster",h.usbdrive?"✅ USB":"⬜ USB",h.stickynote?"✅ Sticky":"⬜ Sticky Note",h.AmeliaZone?"✅ Amelia":"⬜ Amelia"].join("   ");WA.ui.displayActionMessage({message:`Progress: ${e}`,callback:()=>{}})}let $;function Cn(){WA.onInit().then(()=>{console.log("[WA] Malware instructions ready"),WA.room.area.onEnter("malware_instructions").subscribe(()=>{_n()}),WA.room.area.onLeave("malware_instructions").subscribe(()=>{Be()})})}function _n(){Be(),$=WA.ui.openPopup("malware_instructionsPopup","🧑‍💻 Congratulations on clearing the first room! But we have a long way to go before we’re ready to really protect Murdoch... In this room, you’ll learn more about Malware and the best ways to protect against it. To begin, go through the slides by pressing SPACE.",[{label:"Got it!",className:"primary",callback:()=>Be()}])}function Be(){var e;if($){try{(e=$.close)==null||e.call($)}catch{}$=void 0}}let x;const Tt="malware_discord",In="malware_discordPopup";function Mn(){WA.onInit().then(()=>{console.log("[WA] Malware Discord popup ready"),WA.room.area.onEnter(Tt).subscribe(()=>{Ln()}),WA.room.area.onLeave(Tt).subscribe(()=>{je()})})}function Ln(){je(),x=WA.ui.openPopup(In,`💬 Friend sent a file

Your friend DMs you on Discord about a program that “unlocks Discord Nitro Premium for life” and says it’s safe because they used it.

What would you do? Press SPACE to help!`,[{label:"Got it!",className:"primary",callback:()=>je()}])}function je(){var e;try{(e=x==null?void 0:x.close)==null||e.call(x)}catch{}x=void 0}let G;const Nt="malware_usbdrive",Tn="malware_usbdrivePopup";function Nn(){WA.onInit().then(()=>{console.log("[WA] Malware USB Drive popup ready"),WA.room.area.onEnter(Nt).subscribe(()=>{xn()}),WA.room.area.onLeave(Nt).subscribe(()=>{De()})})}function xn(){De(),G=WA.ui.openPopup(Tn,`💾 Found USB

You spot a USB drive on the canteen floor. It looks unopened and you’re curious about what’s inside.

What would you do? Press SPACE to help!`,[{label:"Got it!",className:"primary",callback:()=>De()}])}function De(){var e;try{(e=G==null?void 0:G.close)==null||e.call(G)}catch{}G=void 0}let O;const xt="malware_trojan",Gn="malware_trojanPopup";function On(){WA.onInit().then(()=>{console.log("[WA] Malware Trojan popup ready"),WA.room.area.onEnter(xt).subscribe(()=>{Rn()}),WA.room.area.onLeave(xt).subscribe(()=>{Ue()})})}function Rn(){Ue(),O=WA.ui.openPopup(Gn,`🛡️ Malware Detection

A system alert appears: “Windows Defender Virus Protection found an unwanted app (type: Trojan).”

What would you do? Press SPACE to help!`,[{label:"Got it!",className:"primary",callback:()=>Ue()}])}function Ue(){var e;try{(e=O==null?void 0:O.close)==null||e.call(O)}catch{}O=void 0}let J;function Bn(){WA.onInit().then(()=>{console.log("[WA] Password Security instructions ready"),WA.room.area.onEnter("passwordsecurity_instructions").subscribe(()=>{jn()}),WA.room.area.onLeave("passwordsecurity_instructions").subscribe(()=>{Fe()})})}function jn(){Fe(),J=WA.ui.openPopup("passwordsecurity_instructionsPopup","🧑‍🏫 Thank goodness you’re here! The hackers are after our passwords, and we need your help to secure them! ➡️ To begin, go through the slides to learn more about Passsword Security by pressing SPACE. Afterwards, help us defend the school!",[{label:"Got it!",className:"primary",callback:()=>Fe()}])}function Fe(){var e;if(J){try{(e=J.close)==null||e.call(J)}catch{}J=void 0}}let Z;function Dn(){WA.onInit().then(()=>{console.log("[WA] Password Security - LMS Account scenario ready"),WA.room.area.onEnter("passwordsecurity_lmsaccount").subscribe(()=>{Un()}),WA.room.area.onLeave("passwordsecurity_lmsaccount").subscribe(()=>{Ye()})})}function Un(){Ye(),Z=WA.ui.openPopup("passwordsecurity_lmsaccountPopup","👩‍💻 Your classmate Joyce says she forgot her LMS login and asks to borrow your account to check the quiz questions. What would you do? Press SPACE to help!",[{label:"Let's decide!",className:"primary",callback:()=>Ye()}])}function Ye(){var e;if(Z){try{(e=Z.close)==null||e.call(Z)}catch{}Z=void 0}}let ee;function Fn(){WA.onInit().then(()=>{console.log("[WA] Password Security - LMS Password Expired scenario ready"),WA.room.area.onEnter("passwordsecurity_lmspasswordexpired").subscribe(()=>{Yn()}),WA.room.area.onLeave("passwordsecurity_lmspasswordexpired").subscribe(()=>{He()})})}function Yn(){He(),ee=WA.ui.openPopup("passwordsecurity_lmspasswordexpiredPopup","🔑 Your LMS password has just expired! The system is asking you to create a new one. How will you choose your new password? Press SPACE to help!",[{label:"Let's find out!",className:"primary",callback:()=>He()}])}function He(){var e;if(ee){try{(e=ee.close)==null||e.call(ee)}catch{}ee=void 0}}let te;function Hn(){WA.onInit().then(()=>{console.log("[WA] Password Security - Unlocked PC scenario ready"),WA.room.area.onEnter("passwordsecurity_unlockedpc").subscribe(()=>{Vn()}),WA.room.area.onLeave("passwordsecurity_unlockedpc").subscribe(()=>{Ve()})})}function Vn(){Ve(),te=WA.ui.openPopup("passwordsecurity_unlockedpcPopup","💻 You notice an unlocked PC with a teacher’s account signed in — an Excel sheet is open showing login details! What should you do? Press SPACE to help!",[{label:"I'll check!",className:"primary",callback:()=>Ve()}])}function Ve(){var e;if(te){try{(e=te.close)==null||e.call(te)}catch{}te=void 0}}let R;function qn(){WA.onInit().then(()=>{console.log("[WA] Safe Internet Practices – Free Wi-Fi ready"),WA.room.area.onEnter("safeinternetpractices_freewifi").subscribe(()=>zn()),WA.room.area.onLeave("safeinternetpractices_freewifi").subscribe(()=>qe())})}function zn(){qe(),R=WA.ui.openPopup("safeinternetpractices_freewifiPopup","📶 In the hall, you spot a wall sign offering **Free Wi-Fi**. Nearby, you see open networks like “HallGuest” and “CampusFree”. How would you get online safely? Press SPACE to help!",[{label:"Got it",className:"primary",callback:()=>qe()}])}function qe(){var e;try{(e=R==null?void 0:R.close)==null||e.call(R)}catch{}R=void 0}let B;function Qn(){WA.onInit().then(()=>{console.log("[WA] Safe Internet Practices – File Uploads ready"),WA.room.area.onEnter("safeinternetpractices_fileuploads").subscribe(()=>Xn()),WA.room.area.onLeave("safeinternetpractices_fileuploads").subscribe(()=>ze())})}function Xn(){ze(),B=WA.ui.openPopup("safeinternetpractices_fileuploadsPopup","💬 Hey! Can you help me edit this PDF file? I found some free online tools that lets you upload and edit PDFs easily! What would you do? Press SPACE to help!",[{label:"Let’s see!",className:"primary",callback:()=>ze()}])}function ze(){var e;try{(e=B==null?void 0:B.close)==null||e.call(B)}catch{}B=void 0}let j;function Kn(){WA.onInit().then(()=>{console.log("[WA] Safe Internet Practices – Outdated Software ready"),WA.room.area.onEnter("safeinternetpractices_outdatedsoftware").subscribe(()=>$n()),WA.room.area.onLeave("safeinternetpractices_outdatedsoftware").subscribe(()=>Qe())})}function $n(){Qe(),j=WA.ui.openPopup("safeinternetpractices_outdatedsoftwarePopup","🧑‍💻 You saw a laptop on the floor, you picked it up and open your browser to check your bank account, but a message appears saying your browser needs an update. What will you do? Press SPACE to help!",[{label:"Let’s decide!",className:"primary",callback:()=>Qe()}])}function Qe(){var e;try{(e=j==null?void 0:j.close)==null||e.call(j)}catch{}j=void 0}let D;function Jn(){WA.onInit().then(()=>{console.log("[WA] Safe Internet Practices instructions ready"),WA.room.area.onEnter("safeinternetpractices_instructions").subscribe(()=>Zn()),WA.room.area.onLeave("safeinternetpractices_instructions").subscribe(()=>Xe())})}function Zn(){Xe(),D=WA.ui.openPopup("safeinternetpractices_instructionsPopup","🏫 You’ve made it through 3 of the topics, well done! But there’s more we need to learn before we’re truly ready to defeat the malicious actors. Please press SPACE to talk to me before you explore the room!",[{label:"Got it!",className:"primary",callback:()=>Xe()}])}function Xe(){var e;try{(e=D==null?void 0:D.close)==null||e.call(D)}catch{}D=void 0}let oe;function er(){WA.onInit().then(()=>{console.log("[WA] ID Theft instructions ready"),WA.room.area.onEnter("idtheft_instructions").subscribe(()=>{tr()}),WA.room.area.onLeave("idtheft_instructions").subscribe(()=>{Ke()})})}function tr(){Ke(),oe=WA.ui.openPopup("idtheft_instructionsPopup","🧑‍🏫 It’s hard to believe it but we seem to be in the last topic! We’re almost ready to face the hackers and help defend the school! One of the students recently fell victim to ID Theft via a phishing email, and they’re now being impersonated online! Press SPACE to read the slides on the basics you need to learn first. Afterwards, please check the PC nearby to see if you can help.",[{label:"Got it!",className:"primary",callback:()=>Ke()}])}function Ke(){var e;if(oe){try{(e=oe.close)==null||e.call(oe)}catch{}oe=void 0}}let ne;function or(){WA.onInit().then(()=>{console.log("[WA] ID Theft - Sensitive Papers ready"),WA.room.area.onEnter("idtheft_sensitivepapers").subscribe(()=>{nr()}),WA.room.area.onLeave("idtheft_sensitivepapers").subscribe(()=>{$e()})})}function nr(){$e(),ne=WA.ui.openPopup("idtheft_sensitivepapersPopup","📄 While cleaning out some old documents from your locker, you notice a pile of old bank statements. They might contain sensitive information — how you handle them could determine whether your data stays safe! Press SPACE to investigate what happens next.",[{label:"Got it!",className:"primary",callback:()=>$e()}])}function $e(){var e;if(ne){try{(e=ne.close)==null||e.call(ne)}catch{}ne=void 0}}let re;function rr(){WA.onInit().then(()=>{console.log("[WA] ID Theft - Customer Service Call ready"),WA.room.area.onEnter("idtheft_customerservicecall").subscribe(()=>{sr()}),WA.room.area.onLeave("idtheft_customerservicecall").subscribe(()=>{Je()})})}function sr(){Je(),re=WA.ui.openPopup("idtheft_customerservicecallPopup","📞 You notice a phone lying on the floor and decide to pick it up. As soon as you do, you receive a call — the person on the other end claims to be a bank representative who somehow knows your name and partial account number. Press SPACE to find out what happens next!",[{label:"Got it!",className:"primary",callback:()=>Je()}])}function Je(){var e;if(re){try{(e=re.close)==null||e.call(re)}catch{}re=void 0}}let se;function ar(){WA.onInit().then(()=>{console.log("[WA] ID Theft - Celebration ready"),WA.room.area.onEnter("idtheft_celebration").subscribe(()=>{ir()}),WA.room.area.onLeave("idtheft_celebration").subscribe(()=>{Ze()})})}function ir(){Ze(),se=WA.ui.openPopup("idtheft_celebrationPopup","📸 You’ve just passed your driving test and gotten your new license! Excited, you picked up your phone from the bench and took a selfie with it in hand to celebrate your big achievement. But should you post it online? Press SPACE to see what happens next!",[{label:"Got it!",className:"primary",callback:()=>Ze()}])}function Ze(){var e;if(se){try{(e=se.close)==null||e.call(se)}catch{}se=void 0}}let ae;function cr(){WA.onInit().then(()=>{console.log("[WA] Final Boss spawn ready"),WA.room.area.onEnter("finalboss_spawnPopup").subscribe(()=>{lr()}),WA.room.area.onLeave("finalboss_spawnPopup").subscribe(()=>{et()})})}function lr(){et(),ae=WA.ui.openPopup("finalboss_spawnPopup","🏢 You’ve entered the main office… it feels quiet, too quiet. Something’s off — the source of all the attacks must be here. Move forward carefully.",[{label:"Got it!",className:"primary",callback:()=>et()}])}function et(){var e;if(ae){try{(e=ae.close)==null||e.call(ae)}catch{}ae=void 0}}let ie;function ur(){WA.onInit().then(()=>{console.log("[WA] Final Boss CipherX ready"),WA.room.area.onEnter("finalboss_cipherx").subscribe(()=>{pr()}),WA.room.area.onLeave("finalboss_cipherx").subscribe(()=>{tt()})})}function pr(){tt(),ie=WA.ui.openPopup("finalboss_cipherxPopup",`👾 *CipherX appears before you.*

“So... you’ve made it through every challenge — phishing, malware, weak passwords, stolen identities. You’ve been a thorn in my plans for far too long!”

Press SPACE to face CipherX in the final showdown quiz!`,[{label:"I’m ready!",className:"primary",callback:()=>tt()}])}function tt(){var e;if(ie){try{(e=ie.close)==null||e.call(ie)}catch{}ie=void 0}}let ce;function fr(){WA.onInit().then(()=>{console.log("[WA] Ending message ready"),WA.room.area.onEnter("endingmessage").subscribe(()=>{hr()}),WA.room.area.onLeave("endingmessage").subscribe(()=>{ot()})})}function hr(){ot(),ce=WA.ui.openPopup("endingmessagePopup","🏆 Congratulations, Cyber Ranger! You’ve defeated CipherX and restored peace to Murdoch University. Thanks to your actions, students can now browse, click, and share safely once again. Please move to the right towards the stairs and complete the survey. ",[{label:"Finish!",className:"primary",callback:()=>ot()}])}function ot(){var e;if(ce){try{(e=ce.close)==null||e.call(ce)}catch{}ce=void 0}}let le;function dr(){WA.onInit().then(()=>{console.log("[WA] Survey area ready"),WA.room.area.onEnter("survey").subscribe(()=>{yr()}),WA.room.area.onLeave("survey").subscribe(()=>{nt()})})}function yr(){nt(),le=WA.ui.openPopup("surveyPopup","📝 Final Step: Please proceed to complete the post-game survey to help us improve Cyber Rangers! Press SPACE to begin.",[{label:"Open Survey by pressing SPACE",className:"primary",callback:()=>nt()}])}function nt(){var e;if(le){try{(e=le.close)==null||e.call(le)}catch{}le=void 0}}console.log("Script started");WA.onInit().then(async()=>{console.log("Scripting API ready"),await Co(),_o(),Io(),Lo(),Fo();const e=await gr();console.log("[Router] mapId =",e||"(unknown)"),e==="garden"?(console.log("[Router] Initializing GARDEN features…"),tn(),on(),sn(),un(),dn(),bn(),Pn(),kn()):e==="library"?(console.log("[Router] Initializing LIBRARY (Phishing) features…"),qo(),Qo(),Ko(),$o(),Zo()):e==="canteen"?(console.log("[Router] Initializing CANTEEN (Malware) features…"),Cn(),Mn(),Nn(),On()):e==="classroom"?(console.log("[Router] Initializing CLASSROOM (Password Security) features…"),Bn(),Dn(),Fn(),Hn()):e==="computerlab"?(console.log("[Router] Initializing COMPUTER LAB (ID Theft) features…"),er(),or(),rr(),ar()):e==="hall"?(console.log("[Router] Initializing HALL (Safe Internet Practices) features…"),qn(),Qn(),Kn(),Jn()):e==="office"?(console.log("[Router] Initializing OFFICE (Final Boss) features…"),cr(),ur(),fr(),dr()):console.warn("[Router] Unknown map; only common features started. Set a Tiled Map Property `mapId` (string) to enable map-specific inits.")});async function gr(){var e,t,o;try{const r=decodeURIComponent(window.location.href).match(/\/([^\/?#]+)\.tmj/i);if(r!=null&&r[1])return r[1].toLowerCase()}catch{}try{const n=await((t=(e=WA.room).getTiledMap)==null?void 0:t.call(e)),r=((n==null?void 0:n.url)??(n==null?void 0:n.name)??"").toString();if(r){const i=(r.split("/").pop()||r).toLowerCase();return i.endsWith(".tmj")?i.replace(/\.tmj$/,""):i}const s=n==null?void 0:n.properties,a=(o=s==null?void 0:s.find(i=>(i==null?void 0:i.name)==="mapId"))==null?void 0:o.value;if(typeof a=="string"&&a.trim())return a.trim().toLowerCase()}catch{}return""}
//# sourceMappingURL=main-ac448662.js.map
